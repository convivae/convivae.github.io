<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>Hello world</title>
    <url>/posts/hello-world/</url>
    <content><![CDATA[<blockquote>
<p>Today, Begining</p>
</blockquote>
]]></content>
  </entry>
  <entry>
    <title>再探编码</title>
    <url>/posts/zai-tan-bian-ma/</url>
    <content><![CDATA[<h2 id="原文链接"><a href="#原文链接" class="headerlink" title="原文链接"></a>原文链接</h2><p>本文转载自 <a target="_blank" rel="noopener" href="https://ihomura.cn/2018/06/26/%E5%86%8D%E6%8E%A2%E7%BC%96%E7%A0%81/#more">澪同学的博客</a></p>
<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>计算机发展本身就是多元化的，而且标准或者说字符集具有地域性，再加上计算机系统的历史遗留性（没错，那边的 Windows 说的就是你），我觉得编码一直是一个很难的问题。</p>
<a id="more"></a>

<p>在我的博客还是 WordPress 的时候我曾经写过一篇讲编码的文章，但是实际上那时候我也是一知半解，写出来的东西也是浅薄无趣的。</p>
<p>然而学CS，一知半解是最恐怖的，正好最近就在各种踩坑，所以不如一次弄明白算了，也算是解决长久以来的一块心病了。</p>
<p>所以本文会尝试去理清各种字符集以及编码之间的关系，如果有任何错误还请指出。</p>
<h3 id="字符集"><a href="#字符集" class="headerlink" title="字符集"></a>字符集</h3><p>字符集简单来说就是一个映射，通常情况下是一个整数到某个特定的字符的双射，比如在 ASCII 字符集中，’A’ 对应的是 65， 反过来 65 也对应的是 ‘A’。</p>
<p>字符集概念很简单，但是有两个问题。</p>
<ul>
<li>我知道一个字符集中 65 对应 ‘A’，反之亦然，那我可以确定它是 ASCII 吗？</li>
<li>我在 C++ 中写了 <code>char a = &#39;A&#39;</code> 然后发现变量 a 的值真的是 65，那是不是所有字符集中字符都是由它相对应的整数表示？</li>
</ul>
<p>对于第一个问题，答案当然是否。因为字符集一般都是向前兼容的，比如 Unicode 中 ‘A’ 也是 65。</p>
<p>对于第二个问题，答案也是否。因为当字符集太大的时候，如果都这样表示，那么会浪费相当大的空间，我们在后面的 UTF 会看到如何解决这个问题。</p>
<p>简单概括下，字符集就是字符和整数的映射，它不代表计算机内部的实际编码表示。</p>
<h3 id="ASCII"><a href="#ASCII" class="headerlink" title="ASCII"></a>ASCII</h3><p>ASCII 全称 American Standard Code for Information Interchange，它只有 8bit 长，但是实际上编码只用了 7bit，还有一位一般是用来奇偶校验（因为很多电子通信也用 ASCII）。</p>
<p>具体的 ASCII 表这里不再给出，只强调一点就是绝大部分字符集和编码方式都是兼容 ASCII 的。</p>
<h3 id="Extend-ASCII-扩展-ASCII"><a href="#Extend-ASCII-扩展-ASCII" class="headerlink" title="Extend ASCII(扩展 ASCII)"></a>Extend ASCII(扩展 ASCII)</h3><p>当计算机走向世界的时候，人们首先发现的问题就是 ASCII 不够用了。</p>
<p>但是正如我之前说过的，编码具有很强的历史性，改变编码方式很难一次到位，所以扩展 ASCII 就出现了，它的做法很简单：把原来 ASCII 中不参与编码的最高位拿出来用于编码，这样原来 ASCII 范围 0～127 就变成了扩展 ASCII 的0～255。</p>
<p>但是这里有个问题是扩展 ASCII 不像 ASCII 那样只有一个标准，也就是说扩展 ASCII 实际上有很多种，不过最后被采用的是 ISO 8859，由于 Windows 中实现要比最终标准化早一些，所以 Windows 中对应的 Windows-1252 实际上是 ISO 8859 的超集。</p>
<p>到这里问题还不大，但是 Windows 为自己埋下了祸根。</p>
<h3 id="ANSI"><a href="#ANSI" class="headerlink" title="ANSI"></a>ANSI</h3><p>首先这里要纠正一个错误的认知：没有任何一种编码方式/字符集叫做 ANSI。</p>
<p>ANSI 已经很累了，不想再背锅了。</p>
<p>ANSI 全称是 American National Standards Institute，是一个标准化组织，比如上面的 ISO 8859 就是它跟 ISO 一起提出来的。</p>
<p>那么当我们在谈 ANSI 编码的时候，我们在谈什么？</p>
<h3 id="Windows-Code-Page-Windows-代码页"><a href="#Windows-Code-Page-Windows-代码页" class="headerlink" title="Windows Code Page(Windows 代码页)"></a>Windows Code Page(Windows 代码页)</h3><p>实际上，一般说 ANSI 编码实际上想提到的就是 Windows 代码页。</p>
<p>换句话说，我们在说 ANSI 编码的时候，很大可能想表达的是某个国家特定的字符集和它所代表的代码页。</p>
<p>比如中文系统使用的 GBK 在 Windows 中的代码页是 cp936，一般我们在中国说 ANSI 编码可能指的就是 GBK，而上面的 Windows-1252 就是代码页 cp1252，表示的就是相应的扩展 ASCII。</p>
<p>但是代码页可以说是 Windows 中最致命的残留之一，这个问题直到 Windows10 1803 才有了一定程度的解决，但是由于 Windows 高度的向前兼容性，这个问题恐怕在不久的将来还会一直存在，除非 NT 推倒重来。</p>
<p>这里引用 cppreference 的一段话来说明这个问题</p>
<blockquote>
<p><code>wchar_t</code> - type for wide character representation (see wide strings). Required to be large enough to represent any supported character code point (32 bits on systems that support<br>Unicode. A notable exception is Windows, where wchar_t is 16 bits and holds UTF-16 code units) It has the same size, signedness, and alignment as one of the integer types, but is a<br>distinct type.</p>
</blockquote>
<p>这里 <code>wchar_t</code> 在 Windows 上只有 16bit 的根源就在于代码页的设计。</p>
<p>在微软最初的设计里，代码页只有两种 Single-Byte Character Set(SBCS) 和 Double-Byte Character Set(DBCS)，比如上面的 cp1252 就是一个 SBCS，中文系统使用的 cp936 就是一个 DBCS。</p>
<p>当然现在微软也有 UTF-8 编码的代码页，不过那都是后话了。</p>
<h3 id="国标"><a href="#国标" class="headerlink" title="国标"></a>国标</h3><h4 id="GB2312"><a href="#GB2312" class="headerlink" title="GB2312"></a>GB2312</h4><p>扩展 ASCII 还是太少了，比如中文，255 个字怎么可能够用嘛，隔壁同源的日文也是同理。</p>
<p>所以国家这时候就开始着手设计自己的字符集了，第一个国标就是 GB2312。</p>
<p>GB2312 采用两个字节编码，收录了绝大多数常用的汉字。</p>
<h4 id="GBK"><a href="#GBK" class="headerlink" title="GBK"></a>GBK</h4><p>但是 GB2312 只收录了约 7000 个汉字，甚至连朱镕基的“镕”都没有，而且台湾港澳台使用的字体也没有收录，所以就有了 GBK，即 “GB2312扩”。</p>
<p>它仍然采用两个字节编码，兼容 GB2312 的同时收录了日本、台湾和韩国等通用字符集的汉字。</p>
<p>Windows 中的 936 号代码页实际上几乎就是 GBK。</p>
<p>但是随着计算机技术的发展，GBK 仍然无法满足需要，而且 GBK 实际上并不是国家标准，所以后来接盘的是 GB18030，这里我们先停下来，看一看隔壁的 Unicode。</p>
<h3 id="Unicode"><a href="#Unicode" class="headerlink" title="Unicode"></a>Unicode</h3><p>随着 Internet 的发展，编码的问题愈发突出，如何让文本能正确的显示在显示器上成了一个难题，Unicode 就是在这种背景下出现的。</p>
<p>最新的 Unicode 标注一共收录了约 14 万个字符，基本涵盖了世界上绝大数语言。</p>
<p>从 Unicode 起，另外一个问题提了出来：有了字符集，如何编码让它更适合计算机使用或者网络传输呢？</p>
<p>之前的单字节和双字节编码因为占用空间少，所以直接不加任何编码就可以使用，但是 Unicode 可是有 14 万个，如果还采用<strong>定长编码</strong>的话至少需要 18bit 才能保证一一对应，这样的话对于之前 ASCII 中就有的字符来说有 11bit 就被浪费了，显然是不合理的。</p>
<p>所以这里字符集和编码方式就必须分开考虑了，这也是为什么会有 Unicode Transformation Format(UTF) 一说了。</p>
<p>简单来说，Unicode 还是那个 Unicode，但是编码方式会有很多种。</p>
<h3 id="UTF-7"><a href="#UTF-7" class="headerlink" title="UTF-7"></a>UTF-7</h3><p>UTF-7 已经不属于 Unicode 标准了，但是它还属于 RFC 标准。</p>
<p>简单来说，UTF-7 对于 ASCII 不做改变，但是对于非 ASCII 字符采用 base64 编码后在首位加上 + 和 - 用于区分，这样编码出的字符串中所有字符就是标准 ASCII 了。</p>
<p>如果做过 XSS 或者 SQL 注入的应该对 UTF-7 有印象。</p>
<h3 id="UTF-8"><a href="#UTF-8" class="headerlink" title="UTF-8"></a>UTF-8</h3><p>UTF-8 是最常用的编码，也是 Web 中几乎统治性的编码方式。</p>
<p>UTF-8 是一种变长编码方式，它兼容 ASCII 最小可以用 1byte 表示，同时最多可以用 4byte 表示所有的 Unicode 字符。</p>
<p>UTF-8 编码方式其实很好理解，对于某个字符首先取出它的二进制表示：</p>
<ul>
<li>如果小于等于 7 位（ASCII），那么直接表示为 0xxxxxxx</li>
<li>如果小于等于 11 位但是大于 7 位，那么表示为 110 xxxxx 10 xxxxxx</li>
<li>如果小于等于 16 位但是大于 11 位，那么表示为 1110 xxxx 10 xxxxxx 10 xxxxxx</li>
<li>如果小于等于 21 位但是大于 16 位，那么表示为 11110 xxx 10 xxxxxx 10 xxxxxx 10 xxxxxx</li>
</ul>
<p>刚才提到过，最新的 Unicode 标准只要 18bit 就可以全部表示，所以 UTF-8 目前是可以表示 Unicode 全部字符的。</p>
<p>这里举个例子，中文的“中”字，它的 Unicode 为 \u4e2d，也就是 0b100 111000 101101，长度为 15 位，需要三个字节。</p>
<p>所以编码为 UTF-8 后为 0b1110<strong>0100</strong> 10<strong>111000</strong> 10<strong>101101</strong>，也就是 0xe4 0xb8 0xad 即 \xe4\xb8\xad。</p>
<p>下面我们可以用 Python 验证下</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">&gt;&gt; <span class="string">&#x27;\u4e2d&#x27;</span> <span class="comment"># &#x27;中&#x27;</span></span><br><span class="line"><span class="string">&#x27;中&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">&#x27;\u4e2d&#x27;</span>.encode(<span class="string">&#x27;utf-8&#x27;</span>) <span class="comment"># 编码为 UTF-8</span></span><br><span class="line"><span class="string">b&#x27;\xe4\xb8\xad&#x27;</span></span><br></pre></td></tr></table></figure>

<p>那么为什么 UTF-8 能得到这么广泛的应用呢？</p>
<ul>
<li>体积小：相对定长编码来说节省了很多空间。</li>
<li>兼容性：完全兼容 ASCII 的编码方式。</li>
<li>易检测：我们可以看到 UTF-8 四个字节的开头各不相同，而且无论怎么编码都不会冲突，只要根据头部第一个字节就可以知道后面一共有多少字节。</li>
<li>计算快：从 UTF-8 到 Unicode 只用移位就可以完成，这对于计算机来说是相当高效的。</li>
</ul>
<h3 id="GB18030"><a href="#GB18030" class="headerlink" title="GB18030"></a>GB18030</h3><p>好了，到这里我们就要说回 GB 了。</p>
<p>之前提到过接替 GBK 并且真正成为国标的是 GB18030，但是不同的是 GB18030 也采用的变长编码，并且跟 Unicode 完全兼容，也就是说实际上 GB18030 也是一种 UTF。</p>
<p>GB18030 在 2byte 编码的时候跟 GBK 完全一致，但是在 4byte 编码的时候比较复杂，这里偷懒不展开了。<del>（翻译一下：都用 UTF-8 不就完了）</del></p>
<h3 id="UTF-16"><a href="#UTF-16" class="headerlink" title="UTF_16"></a>UTF_16</h3><p>在说 UTF-16 之前，不得不提的是 UCS-2。</p>
<p>UCS-2 是一个定长编码，它用 2byte 直接表示 Unicode —— 这当然是不够的，所以 UTF-16 就是为了补充 UCS-2 出现的。</p>
<p>UTF-16 同样是变长编码，但是它以 2byte 为一个单位。</p>
<ul>
<li>对于小于 2byte 就可以表示的 Unicode 它与 UCS-2 相同。</li>
<li>对于大于 2byte 才能表示的 Unicode，它的编码稍微有些复杂。</li>
</ul>
<p>对于某个要编码的字符，假设它的 Unicode 编码为 U。</p>
<p>首先把 U 减去 0x10000 得到 U’，因为 Unicode 目前最长为 18bit，所以这时候 U’ 一定小于 20bit，分别对高 10bit 和低 10bit 做如下处理：</p>
<ul>
<li>对于高 10bit，把它加上 0xD800 得到 UTF-16 编码的高 2byte，同时注意到一个 Unicode 目前最长为 18bit，所以减去 0x10000 后高 10bit 中最多只有低 8bit 不为 0，这样高 2byte 一定以 0b110110 开头。</li>
<li>对于低 10bit，把它加上 0xDC00 得到 UTF-16 编码的低 2byte，由于 0xC 对应的二进制为 0b1100，所以低 2byte 一定以 0b110111 开头。</li>
</ul>
<p>因此一个 4byte 编码的 UTF-16 中 2byte 的最小值为 0xDC800 而最大值为 0xDFFF，为了避免一个 4byte 编码的 UTF-16 被误认为两个 2byte 的 UTF-16，Unicode 规定 0xD800 - 0xDFFF 不对应任何单个的 Unicode 字符，被称为“代理区”。</p>
<p>比如某个字符的 Unicode 为 U = 0x12345 （哎呀，反正打出来也是个’口’），然后我们可以得到 U’ = U - 0x10000 = 0x02345 = 0b1000 1101000101，低 10bit 为 0x345，高 10bit 为 0x8。</p>
<p>所以可以得到高 2byte 为 0xD800 + 0x8 = 0xD808，低 2byte 为 0xDC00 + 0x2345 = 0xff45，拼在一起就是 0xd808df45，下面就用 Python 验证下</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">&#x27;\U00012345&#x27;</span>.encode(<span class="string">&#x27;utf-16be&#x27;</span>).<span class="built_in">hex</span>()</span><br><span class="line"><span class="string">&#x27;d808df45&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">&#x27;\U00012345&#x27;</span>.encode(<span class="string">&#x27;utf-16&#x27;</span>).<span class="built_in">hex</span>()</span><br><span class="line"><span class="string">&#x27;fffe08d845df&#x27;</span></span><br></pre></td></tr></table></figure>

<p>当然这里还有另一个问题就是大小端问题，虽然 RFC 建议在没有 BOM 的时候默认为大端序，但实际上很多应用（包括系统）默认都是小端序。对于 UTF-16 来说，UTF-16BE 代表大端序，UTF-16LE 代表小端序。</p>
<p>很多操作系统比如 Windows 采用 UTF-16 作为内码，但是 UTF-16 实际上由于 corner case 过多，很多库并没有做很好的测试，因此很可能出现安全性问题。（实际上已经有相应的 CVE 了）</p>
<h3 id="UTF-32"><a href="#UTF-32" class="headerlink" title="UTF-32"></a>UTF-32</h3><p>最后出场的是 UTF-32，从它的名字上我觉得就可以明白它是怎么编码了——没错，4 字节定长编码，简单暴力。</p>
<p>不过正如之前所说，这样会浪费大量的空间，因此 UTF-32 的应用非常少。</p>
<p>做个小验证吧，仍然是之前的“中”</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">&#x27;\u4e2d&#x27;</span></span><br><span class="line"><span class="string">&#x27;中&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">&#x27;\u4e2d&#x27;</span>.encode(<span class="string">&#x27;utf-32be&#x27;</span>).<span class="built_in">hex</span>()</span><br><span class="line"><span class="string">&#x27;00004e2d&#x27;</span></span><br></pre></td></tr></table></figure>

<p>大小端序的问题也不再赘述。</p>
<h3 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h3><p>编码是真的很复杂，不过当你决定把它研究透的时候，一切都清晰明了了起来。</p>
<p>个人觉得最重要还是要理解字符集和编码方式的关系，也就是 Unicode 跟 UTF 的关系，因为这部分可能是最让人迷惑的。</p>
<p>编码问题作为一个困扰我很久的“恶龙”，如今能“斩掉”还是很爽的。</p>
<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><p><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/ASCII">ASCII</a><br><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/701882/what-is-ansi-format">what is ansi format</a><br><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Windows_code_page">Windows Code Page</a><br><a target="_blank" rel="noopener" href="https://docs.microsoft.com/zh-cn/windows/desktop/Intl/code-pages">code pages</a><br><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/American_National_Standards_Institute">American National Standards Institute</a><br><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/International_Organization_for_Standardization">International Organization for Standardization</a><br><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Unicode">Unicode</a><br><a target="_blank" rel="noopener" href="https://en.cppreference.com/w/cpp/language/types">Fundamental types</a><br><a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/GB_2312">GB2312</a><br><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/GB_18030">GB18030</a><br><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/UTF-8">UTF8</a><br><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/UTF-16">UTF16</a></p>
]]></content>
      <categories>
        <category>编码</category>
      </categories>
      <tags>
        <tag>C++</tag>
        <tag>编码</tag>
      </tags>
  </entry>
  <entry>
    <title>自动初始化 Gitalk 和 Gitment 评论</title>
    <url>/posts/zi-dong-chu-shi-hua-gitalk-he-gitment-ping-lun/</url>
    <content><![CDATA[<p>本篇文章是<a target="_blank" rel="noopener" href="https://convivae.github.io/posts/hexo-bo-ke-cai-keng/#toc-heading-11">自动初始化 Gitalk 和 Gitment 评论</a>的解决办法，如果还没配置 Gitalk，建议先看上一篇文章的<a target="_blank" rel="noopener" href="https://convivae.github.io/posts/hexo-bo-ke-cai-keng/#toc-heading-7">添加 Gitalk 的评论插件</a>，再来看这篇文章。</p>
<h2 id="遇到的问题"><a href="#遇到的问题" class="headerlink" title="遇到的问题"></a>遇到的问题</h2><p>Gitalk配置完成后，启动hexo，打开文章页面，需要登陆 github，一篇一篇文章地点过去，完成初始化后才能使用，操作比较麻烦，下面介绍用 Node.js 来自动初始化 Gitalk 的方法</p>
<h2 id="解决问题"><a href="#解决问题" class="headerlink" title="解决问题"></a>解决问题</h2><h3 id="生成-Sitemap-站点地图"><a href="#生成-Sitemap-站点地图" class="headerlink" title="生成 Sitemap 站点地图"></a>生成 Sitemap 站点地图</h3><p>站点地图是一种文件，您可以通过该文件列出您网站上的网页，从而将您网站内容的组织架构告知Google和其他搜索引擎。搜索引擎网页抓取工具会读取此文件，以便更加智能地抓取您的网站。</p>
<ul>
<li>安装插件</li>
</ul>
<p>在你的 hexo 根目录，执行下面两个命令来安装针对 google 和百度的插件</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install hexo-generator-sitemap --save</span><br><span class="line">npm install hexo-generator-baidu-sitemap --save</span><br></pre></td></tr></table></figure>

<ul>
<li>在站点根目录下的_config.yml添加如下代码</li>
</ul>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># sitemap</span></span><br><span class="line"><span class="attr">sitemap:</span></span><br><span class="line">  <span class="attr">path:</span> <span class="string">sitemap.xml</span></span><br><span class="line"></span><br><span class="line"><span class="attr">baidusitemap:</span></span><br><span class="line">  <span class="attr">path:</span> <span class="string">baidusitemap.xml</span></span><br></pre></td></tr></table></figure>

<p>现在再执行 <code>hexo generate</code>  或 <code>hexo g</code> 的时候，在博客根目录下的 <code>public</code> 文件夹下面就会生成<code>sitemap.xml</code> 和 <code>baidusitemap.xml</code>。</p>
<h3 id="获取github接口的调用权限"><a href="#获取github接口的调用权限" class="headerlink" title="获取github接口的调用权限"></a>获取github接口的调用权限</h3><ol>
<li>创建一个access token，<a target="_blank" rel="noopener" href="https://github.com/settings/tokens">点击链接进入</a></li>
<li>点击 <code>Generate new token</code> 按钮</li>
<li>输入一个描述，为 token 添加所有的 repo 权限，然后点击最下方的 <code>Generate token</code> 按钮，就可以生成一个新的 <code>Token</code> 备用</li>
</ol>
<p><img data-src="init_gitalk.png" alt="init_gitalk"></p>
<ol start="4">
<li>生成的 token，在后面使用</li>
</ol>
<p><img data-src="init_gitalk01.png" alt="init_gitalk01"></p>
<h3 id="脚本文件"><a href="#脚本文件" class="headerlink" title="脚本文件"></a>脚本文件</h3><h4 id="安装依赖包"><a href="#安装依赖包" class="headerlink" title="安装依赖包"></a>安装依赖包</h4><p>在你的 hexo 根目录，执行下面的命令</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install request --save</span><br><span class="line">npm install xml-parser --save</span><br><span class="line">npm install yamljs --save</span><br><span class="line">npm install cheerio --save</span><br><span class="line">npm install blueimp-md5 --save</span><br></pre></td></tr></table></figure>

<h4 id="创建脚本文件"><a href="#创建脚本文件" class="headerlink" title="创建脚本文件"></a>创建脚本文件</h4><p>在站点根目录下创建 <code>comment.js</code> 文件，将下面的代码粘贴进文件中，修改下面代码中的 <code>config</code> 配置项，其中 <code>token</code> 就是上一步中获取的值</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> request = <span class="built_in">require</span>(<span class="string">&quot;request&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&quot;path&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> url = <span class="built_in">require</span>(<span class="string">&quot;url&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> xmlParser = <span class="built_in">require</span>(<span class="string">&quot;xml-parser&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> YAML = <span class="built_in">require</span>(<span class="string">&quot;yamljs&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> cheerio = <span class="built_in">require</span>(<span class="string">&quot;cheerio&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//与参考文章不同，新引入了 md5</span></span><br><span class="line"><span class="keyword">const</span> md5 = <span class="built_in">require</span>(<span class="string">&quot;blueimp-md5&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 根据自己的情况进行配置</span></span><br><span class="line"><span class="keyword">const</span> config = &#123;</span><br><span class="line">    username: <span class="string">&quot;GitHub 用户名&quot;</span>, <span class="comment">// GitHub 用户名</span></span><br><span class="line">    token: <span class="string">&quot;GitHub Token&quot;</span>,  <span class="comment">// GitHub Token</span></span><br><span class="line">    repo: <span class="string">&quot;用户名.github.io&quot;</span>,  <span class="comment">// 存放 issues的git仓库</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// sitemap.xml的路径，commit.js放置在根目录下，无需修改，其他情况自行处理</span></span><br><span class="line">    <span class="comment">// 与参考文章不同，这里的路径改为了 baidusitemap.xml</span></span><br><span class="line">    sitemapUrl: path.resolve(__dirname, <span class="string">&quot;./public/baidusitemap.xml&quot;</span>),</span><br><span class="line">    </span><br><span class="line">    kind: <span class="string">&quot;Gitalk&quot;</span>,  <span class="comment">// &quot;Gitalk&quot; or &quot;Gitment&quot;</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">let</span> issuesUrl = <span class="string">`https://api.github.com/repos/<span class="subst">$&#123;config.username&#125;</span>/<span class="subst">$&#123;config.repo&#125;</span>/issues?access_token=<span class="subst">$&#123;config.token&#125;</span>`</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> requestGetOpt = &#123;</span><br><span class="line">    url: <span class="string">`<span class="subst">$&#123;issuesUrl&#125;</span>&amp;page=1&amp;per_page=1000`</span>,</span><br><span class="line">    json: <span class="literal">true</span>,</span><br><span class="line">    headers: &#123;</span><br><span class="line">        <span class="string">&quot;User-Agent&quot;</span>: <span class="string">&quot;github-user&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">let</span> requestPostOpt = &#123;</span><br><span class="line">    ...requestGetOpt,</span><br><span class="line">    url:issuesUrl,</span><br><span class="line">    method: <span class="string">&quot;POST&quot;</span>,</span><br><span class="line">    form: <span class="string">&quot;&quot;</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&quot;开始初始化评论...&quot;</span>);</span><br><span class="line"></span><br><span class="line">(<span class="keyword">async</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;开始检索链接，请稍等...&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> websiteConfig = YAML.parse(fs.readFileSync(path.resolve(__dirname, <span class="string">&quot;./_config.yml&quot;</span>), <span class="string">&quot;utf8&quot;</span>));</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">let</span> urls = sitemapXmlReader(config.sitemapUrl);</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">`共检索到<span class="subst">$&#123;urls.length&#125;</span>个链接`</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&quot;开始获取已经初始化的issues:&quot;</span>);</span><br><span class="line">        <span class="keyword">let</span> issues = <span class="keyword">await</span> send(requestGetOpt);</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">`已经存在<span class="subst">$&#123;issues.length&#125;</span>个issues`</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">let</span> notInitIssueLinks = urls.filter(<span class="function">(<span class="params">link</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> !issues.find(<span class="function">(<span class="params">item</span>) =&gt;</span> &#123;</span><br><span class="line">                link = removeProtocol(link);</span><br><span class="line">                <span class="keyword">return</span> item.body.includes(link);</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">if</span> (notInitIssueLinks.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">`本次有<span class="subst">$&#123;notInitIssueLinks.length&#125;</span>个链接需要初始化issue：`</span>);</span><br><span class="line">            <span class="built_in">console</span>.log(notInitIssueLinks);</span><br><span class="line">            <span class="comment">//console.log(&quot;开始提交初始化请求, 大约需要40秒...&quot;);</span></span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">&quot;开始提交初始化请求...&quot;</span>);</span><br><span class="line">            <span class="comment">/**</span></span><br><span class="line"><span class="comment">             * 部署好网站后，直接执行start，新增文章可能并不会立即生成评论</span></span><br><span class="line"><span class="comment">             * 经参考文章测试，最少需要等待40秒才可以正确生成</span></span><br><span class="line"><span class="comment">             * 但是我本人测试后发现，新增文章是可以立即生成的，</span></span><br><span class="line"><span class="comment">             * 所以我将下面的40s等待时间改成了4ms</span></span><br><span class="line"><span class="comment">             */</span></span><br><span class="line">            <span class="built_in">setTimeout</span>(<span class="keyword">async</span> ()=&gt;&#123;</span><br><span class="line">                <span class="keyword">let</span> initRet = <span class="keyword">await</span> notInitIssueLinks.map(<span class="keyword">async</span> (item) =&gt; &#123;</span><br><span class="line">                    <span class="keyword">let</span> html = <span class="keyword">await</span> send(&#123; ...requestGetOpt, <span class="attr">url</span>: item &#125;);</span><br><span class="line">                    <span class="keyword">let</span> title = cheerio.load(html)(<span class="string">&quot;title&quot;</span>).text();</span><br><span class="line">                    <span class="keyword">let</span> pathLabel = url.parse(item).path;</span><br><span class="line">                    </span><br><span class="line">                    <span class="comment">//与参考文章不同，这里新增一行，将路径名更改为md5值</span></span><br><span class="line">                    pathLabel = md5(pathLabel);</span><br><span class="line">                    </span><br><span class="line">                    <span class="keyword">let</span> body = <span class="string">`<span class="subst">$&#123;item&#125;</span>&lt;br&gt;&lt;br&gt;<span class="subst">$&#123;websiteConfig.description&#125;</span>`</span>;</span><br><span class="line">                    <span class="keyword">let</span> form = <span class="built_in">JSON</span>.stringify(&#123; body, <span class="attr">labels</span>: [config.kind, pathLabel], title &#125;);</span><br><span class="line">                    <span class="keyword">return</span> send(&#123; ...requestPostOpt, form &#125;);</span><br><span class="line">                &#125;);</span><br><span class="line">                <span class="built_in">console</span>.log(<span class="string">`已完成<span class="subst">$&#123;initRet.length&#125;</span>个！`</span>);</span><br><span class="line">                <span class="built_in">console</span>.log(<span class="string">&quot;可以愉快的发表评论了！&quot;</span>);</span><br><span class="line">            &#125;,<span class="number">4</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">&quot;本次发布无新增页面，无需初始化issue!!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">`初始化issue出错，错误如下：`</span>);</span><br><span class="line">        <span class="built_in">console</span>.log(e);</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">    </span><br><span class="line">    &#125;</span><br><span class="line">&#125;)();</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sitemapXmlReader</span>(<span class="params">file</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> data = fs.readFileSync(file, <span class="string">&quot;utf8&quot;</span>);</span><br><span class="line">    <span class="keyword">let</span> sitemap = xmlParser(data);</span><br><span class="line">    <span class="keyword">return</span> sitemap.root.children.map(<span class="function"><span class="keyword">function</span> (<span class="params">url</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">let</span> loc = url.children.filter(<span class="function"><span class="keyword">function</span> (<span class="params">item</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> item.name === <span class="string">&quot;loc&quot;</span>;</span><br><span class="line">        &#125;)[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">return</span> loc.content;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">removeProtocol</span>(<span class="params">url</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> url.substr(url.indexOf(<span class="string">&quot;:&quot;</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">send</span>(<span class="params">options</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">        request(options, <span class="function"><span class="keyword">function</span> (<span class="params">error, response, body</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (!error) &#123;</span><br><span class="line">                resolve(body);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                reject(error);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>上面的脚本在参考文章的基础上稍微做了下修改，与原来的参考文章不同之处已经另起一行单独显示，并在注释中明确标注出来了，下面是这几处不同的地方，需要读者注意一下</p>
<ol>
<li>引入 md5</li>
</ol>
<p>因为我们在<a target="_blank" rel="noopener" href="https://convivae.github.io/posts/hexo-bo-ke-cai-keng/#toc-heading-7">添加 Gittalk 评论插件</a> 时由于考虑到 label 的长度不能超过 50 个字符，对路径做了 md5 的哈希，而初始化评论就是根据你的 label 值来新开一个 issue</p>
<p>所以当你在添加 Gitalk 评论时对路径做了 md5 转换，那么这里也需要做一个相同的转换才能与对应的文章匹配，从而可以成功地创建文章对应的 issue，上面代码中引入的 md5 可以在<a target="_blank" rel="noopener" href="https://github.com/blueimp/JavaScript-MD5">这里</a>找到</p>
<ol>
<li>修改 <code>sitemap.xml</code> 为 <code>baidu-sitemap.xml</code></li>
</ol>
<p>可能是因为我生成的 <code>sitemap.xml</code> 与参考文章作者的并不相同，在 <code>path</code> 为 <code>sitemap.xml</code>，即下面所示的代码：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// sitemap.xml的路径，commit.js放置在根目录下，无需修改，其他情况自行处理</span></span><br><span class="line">sitemapUrl: path.resolve(__dirname, <span class="string">&quot;./public/sitemap.xml&quot;</span>),</span><br></pre></td></tr></table></figure>

<p>时执行后会报错，提示找不到根节点，后来在 debug 过程中发现在  <code>sitemap.xml</code>  中并没有文章的路径，而是主页、关于页、tag 页等页面的路径，后来发现在 <code>baidu-sitemap.xml</code> 中生成了全部文章的路径，并且很好的一点是没有其他页面的路径，这就保证了其他页面不会有对应的 issue，遂改为 <code>baidu-sitemap.xml</code> ，执行成功。</p>
<p>参考文章的作者其实也指出了这一点：</p>
<blockquote>
<p>需要注意的是第一步中的sitemap插件会生成的sitemap.xml会包含<strong>全部的界面</strong>，包括标签页、关于页等，执行上面的代码也会对这些页面生成评论框(也就是issue)</p>
</blockquote>
<ol start="3">
<li>等待时间 40 s</li>
</ol>
<p>由于我自己在测试时并没有发现初始化会特别慢，反倒是代码中强制等待 40 s才能结束进程的设计，让我很是心烦，所以把 40000ms 改为了 4ms，看着代码一行一行畅快地执行完成，心里爽多了。</p>
<ol start="4">
<li>执行脚本可能会遇到的错误</li>
</ol>
<p>我自己执行脚本的时候还发现了其他的错误，也浪费了不少时间，这里拿出来说下</p>
<ul>
<li><p>报错信息：</p>
<p><img data-src="gitalk_error.png" alt="gitalk_error"></p>
</li>
<li><p>分析：<br>这是 <code>_config.yml</code> 的部分代码格式出现了问题，报错的具体部分是下图中箭头指向的位置</p>
<p><img data-src="gitalk_error_fix.png" alt="gitalk_error_fix"></p>
</li>
<li><p>解决<br>只要把多余的空格删掉即可，如下图：</p>
<p><img data-src="gitalk_error_fix01.png" alt="gitalk_error_fix01"></p>
</li>
</ul>
<h4 id="执行脚本"><a href="#执行脚本" class="headerlink" title="执行脚本"></a>执行脚本</h4><p>完成上述操作后，执行下面的命令，就可以部署站点，并初始化所有的评论了。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hexo clean</span><br><span class="line">hexo generate</span><br><span class="line">hexo deploy</span><br><span class="line">node ./comment.js</span><br></pre></td></tr></table></figure>

<p>也可以通过在站点根目录的package.json文件中，新建npm脚本，一个命令搞定清除缓存、生成静态文件、提交git并生成issue的所有操作。</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&quot;scripts&quot;: &#123;</span><br><span class="line">  &quot;build&quot;: &quot;hexo generate&quot;,</span><br><span class="line">  &quot;clean&quot;: &quot;hexo clean&quot;,</span><br><span class="line">  &quot;server&quot;: &quot;hexo server&quot;,</span><br><span class="line">  &quot;test&quot;: &quot;hexo clean &amp;&amp; hexo s&quot;,</span><br><span class="line">  &quot;t&quot;: &quot;hexo clean &amp;&amp; hexo s&quot;,</span><br><span class="line">  &quot;deploy&quot;: &quot;hexo clean &amp;&amp; hexo generate &amp;&amp; hexo deploy &amp;&amp; node ./comment.js&quot;,</span><br><span class="line">  &quot;d&quot;: &quot;hexo clean &amp;&amp; hexo generate &amp;&amp; hexo deploy &amp;&amp; node ./comment.js&quot;,</span><br><span class="line">  &quot;comment&quot;: &quot;node ./comment.js&quot;,</span><br><span class="line">  &quot;c&quot;: &quot;node ./comment.js&quot;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<p>完成文章编写，或者其他的更新操作后，直接执行 deploy 即可。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm run deploy</span><br></pre></td></tr></table></figure>

<p>或：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm run d</span><br></pre></td></tr></table></figure>

<h2 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/daihaoxin/article/details/84958369">nodejs版本的Gitalk/Gitment评论自动初始化</a></p>
]]></content>
      <categories>
        <category>Blog</category>
      </categories>
      <tags>
        <tag>Blog</tag>
        <tag>Gitalk</tag>
      </tags>
  </entry>
  <entry>
    <title>逆波兰表达式</title>
    <url>/posts/ni-bo-lan-biao-da-shi/</url>
    <content><![CDATA[<p>虽然数据结构比较简单，但是有些题遇到之后直接盲敲也并无十足的把握，往往还需要找些资料理清一下思路才敢去写；</p>
<p>有些内容本身就比较复杂，涉及到的知识点也比较多，只看的话不容易记住，只有自己练习一遍印象才会深刻。</p>
<p>所以本专题主要记录这些内容，毕竟好记性不如烂笔头。</p>
<h2 id="从一个简单题目谈起"><a href="#从一个简单题目谈起" class="headerlink" title="从一个简单题目谈起"></a>从一个简单题目谈起</h2><p>【问题描述】</p>
<blockquote>
<p>从标准输入中读入一个整数算术运算表达式，如 <code>24 / ( 1 + 5%3 + 36 / 6 / 2 - 2) * ( 12 / 2 / 2 )=</code>，计算表达式结果，并输出。</p>
</blockquote>
<p>【要求】</p>
<blockquote>
<ol>
<li><p>表达式运算符只有 <code>+</code>,<code>-</code>,<code>*</code>,<code>/</code>,<code>%</code>，表达式末尾的 <code>=</code> 字符表示表达式输入结束，表达式中可能会出现空格</p>
</li>
<li><p>表达式中会出现圆括号，括号可能嵌套，不会出现错误的表达式</p>
</li>
<li><p>出现除号 <code>/</code> 时，以整数相除进行运算，结果仍为整数，例如：<code>5/3</code> 结果应为 <code>1</code></p>
</li>
<li><p>要求采用逆波兰表达式来实现表达式计算</p>
</li>
</ol>
</blockquote>
<p>【输入形式】</p>
<blockquote>
<p>从键盘输入一个以 <code>=</code> 结尾的整数算术运算表达式。操作符和操作数之间可以有空格分隔。</p>
</blockquote>
<p>【输出形式】</p>
<blockquote>
<p>在屏幕上输出计算结果（为整数，即在计算过程中除法为整除）。</p>
</blockquote>
<p>【样例输入】</p>
<blockquote>
<p>24 / ( 1 + 5%3 + 36 / 6 / 2 - 2) * ( 12 / 2 / 2 )     =</p>
</blockquote>
<p>【样例输出】</p>
<blockquote>
<p>18</p>
</blockquote>
<p>【样例说明】</p>
<blockquote>
<p>按照运算符及括号优先级依次计算表达式的值。</p>
</blockquote>
<h2 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h2><p>表达式的三种形式：前缀型、中缀型与后缀型。其中为大家熟知的是中缀形式，如 <code>2 + 3 * (5 - 4)</code>。</p>
<p>前缀型表达式又叫波兰式(Polish Notation)，后缀性表达式又叫逆波兰式(Reverse Polish Notation)。他们最早于1920年波兰数学家Jan Lukasiewicz发明，这两种表示方式的最大特点是不需要括号来表明优先级，他们经常用于计算机科学，特别是编译器设计方面。</p>
<p>所以我们的基本思路是先把中缀表达式转化为后缀表达式，再对后缀表达式进行求值</p>
<h2 id="中缀-–-gt-后缀"><a href="#中缀-–-gt-后缀" class="headerlink" title="中缀 –&gt; 后缀"></a>中缀 –&gt; 后缀</h2><h3 id="使用栈"><a href="#使用栈" class="headerlink" title="使用栈"></a>使用栈</h3><h4 id="规则"><a href="#规则" class="headerlink" title="规则"></a>规则</h4><p>中缀表达式 <code>a + b*c + (d * e + f) * g</code>，其转换成后缀表达式则为<code>a b c * + d e * f  + g * +</code></p>
<p>转换过程需要用到栈，具体过程如下：</p>
<ol>
<li><p>如果遇到操作数，我们就直接将其输出</p>
</li>
<li><p>如果遇到运算符，我们将其放入到栈中，遇到左括号时我们也将其放入栈中</p>
</li>
<li><p>如果遇到一个右括号，则将栈元素弹出并输出直到遇到左括号为止。注意，左括号只弹出并不输出</p>
</li>
<li><p>如果遇到任何其他的操作符，如 <code>&#39;+&#39;</code>,<code>&#39;*&#39;</code>,<code>&#39;(&#39;</code> 等，将栈中比该运算符优先级高的依次弹出并输出，直到遇到更低优先级的元素（或者栈为空）为止。弹出完这些元素后，才将遇到的操作符压入到栈中。有一点需要注意，只有在遇到右括号 <code>&#39;)&#39;</code> 的情况下我们才弹出左括号 <code>&#39;(&#39;</code> ，其他情况我们都不会弹出左括号 <code>&#39;(&#39;</code></p>
</li>
<li><p>如果我们读到了输入的末尾栈不为空，则将栈中所有元素依次弹出</p>
</li>
</ol>
<h4 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h4><p>规则很多，还是用实例比较容易说清楚整个过程。以上面的转换为例，输入为 <code>a + b * c + (d * e + f)*g</code>，处理过程如下：</p>
<ol>
<li><p>首先读到 a，直接输出</p>
</li>
<li><p>读到 <code>&#39;+&#39;</code>，将其放入到栈中</p>
</li>
<li><p>读到 b，直接输出</p>
</li>
</ol>
<p>此时栈和输出的情况如下：</p>
<p><img data-src="1.png" alt="stack01"></p>
<ol start="4">
<li><p>读到 <code>&#39;*&#39;</code>，因为栈顶元素 <code>&#39;+&#39;</code> 优先级比 <code>&#39;*&#39;</code> 低，所以将 <code>&#39;*&#39;</code> 直接压入栈中</p>
</li>
<li><p>读到 c，直接输出</p>
</li>
</ol>
<p>此时栈和输出情况如下：</p>
<p><img data-src="2.png" alt="stack02"></p>
<ol start="6">
<li>读到 <code>&#39;+&#39;</code>，因为栈顶元素 <code>&#39;*&#39;</code> 的优先级比它高，所以弹出 <code>&#39;*&#39;</code> 并输出， 同理，栈中下一个元素 <code>&#39;+&#39;</code> 优先级与读到的操作符 <code>&#39;+&#39;</code> 一样，所以也要弹出并输出。然后再将读到的 <code>&#39;+&#39;</code> 压入栈中。</li>
</ol>
<p>此时栈和输出情况如下：</p>
<p><img data-src="3.png" alt="stack03"></p>
<ol start="7">
<li><p>下一个读到的为 <code>&#39;(&#39;</code>，它优先级最高，所以直接放入到栈中。</p>
</li>
<li><p>读到 d，将其直接输出。</p>
</li>
</ol>
<p>此时栈和输出情况如下：</p>
<p><img data-src="4.png" alt="stack04"></p>
<ol start="9">
<li><p>读到 <code>&#39;*&#39;</code>，由于只有遇到 <code>&#39;)&#39;</code> 的时候左括号 <code>&#39;(&#39;</code> 才会弹出，所以 <code>&#39;*&#39;</code> 直接压入栈中。</p>
</li>
<li><p>读到 e，直接输出。</p>
</li>
</ol>
<p>此时栈和输出情况如下：</p>
<p><img data-src="5.png" alt="stack05"></p>
<ol start="11">
<li><p>读到 <code>&#39;+&#39;</code>，弹出 <code>&#39;*&#39;</code> 并输出，然后将 <code>&#39;+&#39;</code> 压入栈中。</p>
</li>
<li><p>读到 f，直接输出。</p>
</li>
</ol>
<p>此时栈和输出情况：</p>
<p><img data-src="6.png" alt="stack06"></p>
<ol start="13">
<li>接下来读到 <code>&#39;)&#39;</code>，则直接将栈中元素弹出并输出直到遇到 <code>&#39;(&#39;</code> 为止。这里右括号前只有一个操作符 <code>&#39;+&#39;</code> 被弹出并输出。</li>
</ol>
<p><img data-src="7.png" alt="stack07"></p>
<ol start="14">
<li>读到 <code>&#39;*&#39;</code>，压入栈中。读到 g，直接输出。</li>
</ol>
<p><img data-src="8.png" alt="stack08"></p>
<ol start="15">
<li>此时输入数据已经读到末尾，栈中还有两个操作符 <code>&#39;*&#39;</code> 和 <code>&#39;+&#39;</code>，直接弹出并输出。</li>
</ol>
<p><img data-src="9.png" alt="stack09"></p>
<p>至此整个转换过程完成。</p>
<h4 id="参考代码"><a href="#参考代码" class="headerlink" title="参考代码"></a>参考代码</h4><p>代码仅供参考，如有错误，还请指出</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXLEN 10007</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">priority</span><span class="params">(<span class="keyword">char</span> c)</span></span></span><br><span class="line"><span class="function"></span>&#123;<span class="comment">//优先级</span></span><br><span class="line">    <span class="keyword">if</span> (c == <span class="string">&#x27;(&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">if</span> (c == <span class="string">&#x27;*&#x27;</span> || c == <span class="string">&#x27;/&#x27;</span> || c == <span class="string">&#x27;%&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">if</span> (c == <span class="string">&#x27;+&#x27;</span> || c == <span class="string">&#x27;-&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">isop</span><span class="params">(<span class="keyword">char</span> c)</span></span></span><br><span class="line"><span class="function"></span>&#123;<span class="comment">// &#x27;)&#x27; 单独判断，不在此判断</span></span><br><span class="line">    <span class="keyword">return</span> c == <span class="string">&#x27;+&#x27;</span> || c == <span class="string">&#x27;-&#x27;</span> || c == <span class="string">&#x27;*&#x27;</span> || c == <span class="string">&#x27;/&#x27;</span> || c == <span class="string">&#x27;%&#x27;</span> || c == <span class="string">&#x27;(&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> stack_op[MAXLEN];  <span class="comment">//记录运算符的栈</span></span><br><span class="line"><span class="keyword">int</span> top_op = <span class="number">-1</span>;        <span class="comment">//记录运算符栈的栈顶</span></span><br><span class="line"><span class="keyword">char</span> output[MAXLEN];    <span class="comment">//记录最终结果的数组</span></span><br><span class="line"><span class="keyword">int</span> pos = <span class="number">0</span>;            <span class="comment">//记录最终结果的下标</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> c;</span><br><span class="line">    <span class="keyword">while</span> ((c = fgetc(<span class="built_in">stdin</span>)) != EOF) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">isdigit</span>(c)) &#123;</span><br><span class="line">            output[pos++] = c;</span><br><span class="line">            <span class="keyword">while</span> ((c = fgetc(<span class="built_in">stdin</span>)) != EOF &amp;&amp; <span class="built_in">isdigit</span>(c)) &#123;</span><br><span class="line">                output[pos++] = c;</span><br><span class="line">            &#125;</span><br><span class="line">            output[pos++] = <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (isop(c)) &#123;</span><br><span class="line">            <span class="keyword">if</span> (top_op == <span class="number">-1</span> || priority(stack_op[top_op]) &lt; priority(c)) &#123;</span><br><span class="line">                stack_op[++top_op] = c;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">while</span> (top_op &gt; <span class="number">-1</span> &amp;&amp; priority(stack_op[top_op]) &gt;= priority(c) &amp;&amp; stack_op[top_op] != <span class="string">&#x27;(&#x27;</span>) &#123;</span><br><span class="line">                    output[pos++] = stack_op[top_op--];</span><br><span class="line">                    output[pos++] = <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">//该运算符入栈</span></span><br><span class="line">                stack_op[++top_op] = c;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (c == <span class="string">&#x27;)&#x27;</span>) &#123;</span><br><span class="line">            <span class="keyword">while</span> (stack_op[top_op] != <span class="string">&#x27;(&#x27;</span>) &#123;</span><br><span class="line">                <span class="comment">// &#x27;(&#x27; 之前的全部出栈</span></span><br><span class="line">                output[pos++] = stack_op[top_op--];</span><br><span class="line">                output[pos++] = <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// &#x27;(&#x27; 也要出栈</span></span><br><span class="line">            top_op--;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//如果运算符的栈中还有元素，全部出栈</span></span><br><span class="line">    <span class="keyword">while</span> (top_op &gt; <span class="number">-1</span>) &#123;</span><br><span class="line">        output[pos++] = stack_op[top_op--];</span><br><span class="line">        output[pos++] = <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    output[--pos] = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>, output);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="使用表达式树"><a href="#使用表达式树" class="headerlink" title="使用表达式树"></a>使用表达式树</h3><p>本质上是二叉树，不过这棵树的树叶全为操作数(operand)，其他的节点均为运算符。对该树进行先序遍历、中序遍历和后序遍历正好对应前缀表达式、中缀表达和后缀表达式。</p>
<p>对于表达式树的求值操作非常简单，甚至只需要两条语句。因为这里大部分操作都是递归定义，而递归函数本身都是很简洁的。</p>
<h3 id="另一种转换方法"><a href="#另一种转换方法" class="headerlink" title="另一种转换方法"></a>另一种转换方法</h3><p>仅提供一种思路，具体操作起来可能比较麻烦，有兴趣可自行尝试</p>
<ol>
<li><p>先按照运算符的优先级对中缀表达式加括号，变成 <code>( ( a+(b*c) ) + ( ((d*e)+f) *g ) )</code></p>
</li>
<li><p>将运算符移到括号的后面，变成 <code>((a(bc)*)+(((de)*f)+g)*)+</code></p>
</li>
<li><p>去掉括号，得到 <code>abc*+de*f+g*+</code></p>
</li>
</ol>
<h2 id="对后缀表达式求值"><a href="#对后缀表达式求值" class="headerlink" title="对后缀表达式求值"></a>对后缀表达式求值</h2><p>常规的逆波兰表达式求值，比较简单，读取到数字直接入栈，读取到运算符就取出栈顶两个数字做运算，然后将运算结果入栈，最后栈中剩余的数即为计算结果。下面直接给出参考代码</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> stack_num[MAXLEN];  <span class="comment">//记录数字的栈</span></span><br><span class="line"><span class="keyword">int</span> top_num = <span class="number">-1</span>;       <span class="comment">//记录数字栈的栈顶</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">cal</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">char</span> op, <span class="keyword">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">switch</span> (op)</span><br><span class="line">    &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;+&#x27;</span>:<span class="keyword">return</span> a + b;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;-&#x27;</span>:<span class="keyword">return</span> a - b;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;*&#x27;</span>:<span class="keyword">return</span> a * b;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;/&#x27;</span>:<span class="keyword">return</span> a / b;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;%&#x27;</span>:<span class="keyword">return</span> a % b;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">result</span><span class="params">(<span class="keyword">char</span> output[])</span>   <span class="comment">//output[] 中是后缀表达式</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i, a, b, c, tmp_num;</span><br><span class="line">    <span class="keyword">char</span> tmp_op;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; output[i] != <span class="string">&#x27;\0&#x27;</span>; i++) &#123;</span><br><span class="line">        c = output[i];</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">isdigit</span>(c)) &#123;</span><br><span class="line">            tmp_num = c - <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">            <span class="keyword">while</span> ((c = output[++i]) &amp;&amp; <span class="built_in">isdigit</span>(c))</span><br><span class="line">                tmp_num = tmp_num * <span class="number">10</span> + c - <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">            stack_num[++top_num] = tmp_num;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (isop(c)) &#123;</span><br><span class="line">            <span class="comment">//出栈两个数字，计算后将结果入栈</span></span><br><span class="line">            a = stack_num[top_num--];</span><br><span class="line">            b = stack_num[top_num--];</span><br><span class="line">            <span class="comment">//注意 a,b 的顺序，不要反了</span></span><br><span class="line">            stack_num[++top_num] = cal(b, c, a);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> stack_num[top_num];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="代码优化"><a href="#代码优化" class="headerlink" title="代码优化"></a>代码优化</h2><p>由于题目中只要求给出最终结果，并不要求输出后缀表达式，所以我们将计算后缀表达式和计算最终结果的过程合并到一起来写，下面是参考代码：</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXLEN 10007</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">priority</span><span class="params">(<span class="keyword">char</span> c)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (c == <span class="string">&#x27;(&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">if</span> (c == <span class="string">&#x27;*&#x27;</span> || c == <span class="string">&#x27;/&#x27;</span> || c == <span class="string">&#x27;%&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">if</span> (c == <span class="string">&#x27;+&#x27;</span> || c == <span class="string">&#x27;-&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">isop</span><span class="params">(<span class="keyword">char</span> c)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> c == <span class="string">&#x27;+&#x27;</span> || c == <span class="string">&#x27;-&#x27;</span> || c == <span class="string">&#x27;*&#x27;</span> || c == <span class="string">&#x27;/&#x27;</span> || c == <span class="string">&#x27;%&#x27;</span> || c == <span class="string">&#x27;(&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">cal</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">char</span> op, <span class="keyword">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">switch</span> (op)</span><br><span class="line">    &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;+&#x27;</span>:<span class="keyword">return</span> a + b;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;-&#x27;</span>:<span class="keyword">return</span> a - b;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;*&#x27;</span>:<span class="keyword">return</span> a * b;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;/&#x27;</span>:<span class="keyword">return</span> a / b;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;%&#x27;</span>:<span class="keyword">return</span> a % b;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> stack_num[MAXLEN];  <span class="comment">//记录数字的栈</span></span><br><span class="line"><span class="keyword">char</span> stack_op[MAXLEN];  <span class="comment">//记录运算符的栈</span></span><br><span class="line"><span class="keyword">int</span> top_num = <span class="number">-1</span>;       <span class="comment">//记录数字栈的栈顶</span></span><br><span class="line"><span class="keyword">int</span> top_op = <span class="number">-1</span>;        <span class="comment">//记录运算符栈的栈顶</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> c, a, b, tmp_num;</span><br><span class="line">    <span class="keyword">char</span> tmp_op;</span><br><span class="line">    <span class="keyword">while</span> ((c = fgetc(<span class="built_in">stdin</span>)) != EOF) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">isdigit</span>(c)) &#123;</span><br><span class="line">            tmp_num = c - <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">            <span class="keyword">while</span> ((c = fgetc(<span class="built_in">stdin</span>)) != EOF &amp;&amp; <span class="built_in">isdigit</span>(c))</span><br><span class="line">                tmp_num = tmp_num * <span class="number">10</span> + c - <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">            stack_num[++top_num] = tmp_num;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (isop(c)) &#123;</span><br><span class="line">            <span class="keyword">if</span> (top_op == <span class="number">-1</span> || priority(stack_op[top_op]) &lt; priority(c)) &#123;</span><br><span class="line">                stack_op[++top_op] = c;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">while</span> (top_op &gt; <span class="number">-1</span> &amp;&amp; priority(stack_op[top_op]) &gt;= priority(c) &amp;&amp; stack_op[top_op] != <span class="string">&#x27;(&#x27;</span>) &#123;</span><br><span class="line">                    tmp_op = stack_op[top_op--];</span><br><span class="line">                    a = stack_num[top_num--];</span><br><span class="line">                    b = stack_num[top_num--];</span><br><span class="line">                    <span class="comment">//注意 a,b 的顺序，不要反了</span></span><br><span class="line">                    stack_num[++top_num] = cal(b, tmp_op, a);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">//该运算符入栈</span></span><br><span class="line">                stack_op[++top_op] = c;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (c == <span class="string">&#x27;)&#x27;</span>) &#123;</span><br><span class="line">            <span class="keyword">while</span> (stack_op[top_op] != <span class="string">&#x27;(&#x27;</span>) &#123;</span><br><span class="line">                tmp_op = stack_op[top_op--];</span><br><span class="line">                a = stack_num[top_num--];</span><br><span class="line">                b = stack_num[top_num--];</span><br><span class="line">                stack_num[++top_num] = cal(b, tmp_op, a);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// &#x27;(&#x27; 也要出栈</span></span><br><span class="line">            top_op--;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//如果运算符的栈中还有元素，全部出栈</span></span><br><span class="line">    <span class="keyword">while</span> (top_op &gt; <span class="number">-1</span>) &#123;</span><br><span class="line">        tmp_op = stack_op[top_op--];</span><br><span class="line">        a = stack_num[top_num--];</span><br><span class="line">        b = stack_num[top_num--];</span><br><span class="line">        stack_num[++top_num] = cal(b, tmp_op, a);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, stack_num[top_num]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h2><p>将此算法稍作修改，即可拓展到计算浮点数运算式的加减乘除、乘方、取对数、开根号、求阶乘等等复杂的数学运算（大家可以想想如何修改），但是基本的思想是不变的。</p>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/sgbfblog/article/details/8001651">中缀表达式转换为后缀表达式</a><br><a target="_blank" rel="noopener" href="https://blog.csdn.net/buaa_shang/article/details/9124075">表达式树</a><br><a target="_blank" rel="noopener" href="https://www.cnblogs.com/z-sm/p/6807308.html">根据表达式序列（前缀、中缀、后缀）构建表达式树</a></p>
]]></content>
      <categories>
        <category>数据结构</category>
      </categories>
      <tags>
        <tag>栈</tag>
        <tag>表达式求值</tag>
        <tag>逆波兰表达式</tag>
      </tags>
  </entry>
  <entry>
    <title>991数据结构考研复习（七）——文件及查找</title>
    <url>/posts/991-shu-ju-jie-gou-kao-yan-fu-xi-qi-wen-jian-ji-cha-zhao/</url>
    <content><![CDATA[<div id="hexo-blog-encrypt" data-wpm="抱歉, 这个密码看着不太对, 请再试试." data-whm="抱歉, 这个文章不能被校验, 不过您还是能看看解密后的内容."><div class="hbe-input-container"><input type="password" id="hbePass" placeholder="您好, 这里需要密码." /><label>您好, 这里需要密码.</label><div class="bottom-line"></div></div><script id="hbeData" type="hbeData" data-hmacdigest="f65afc8a1e6627d4fbb9baef3e62c5c9a35b957a2a58fc7dc2a1a2362b29bbb5">7afc39081a2acdef7e3eefe602482b97506cb609bb1b624ab16d7a5c0aaed3951d72e60bc404e03edce3c052fe503d09496cc8b72bf9a3eb1148d2c4850b3ecdffe374dd8653bcce7ab7be50fbace3122a488351c767a3b85f50e5eafc959b37980ab0aeccea6f579804a76decde95012f48bda68c3249ed85d68e39435ca8f951d6b7fc4f12444fb8ec1f798160eae334a309e77390378185e01379f0fc91fd21879e245d0ea5d25cd860cfde732b8d6ce713cc5dfca64b521bde35652ddee4ebf54aaf722159232cdd146619ba6f8855ec2e8708ee22199a25f607ba826bc0b950029d4be03c92dc53ffe74d688b9421c749b7736db2418c1bfb2f430c9133af7fa7bcd8dee68460e08055567b5c6144c32a8a0923220505781ebe9ae737fab478020ed2ac9916a0bcf1dce56a4f986dc8e32b854aa5c211b4946e03d1ea24bcab7b6c548b695e637331125a57ebb9f86d211c0df33d6b16ad0883075766e4b5a790a97a10e76566fac8a8564ea59a0bcd06951a7996e3918e6a70deb7c21e7c3e15f0c6b0b666fd4c36519e5ac11fc3406a720295cbeb53bd77ff6fc96435bb558edd2de80784cfbcb94cfb53911f48d48b5c20eb74c2bb228bfce34d979bbcea6f4c0f5919a6db4da61e054e6bc0e4d802d90fa62d6cc0ac383d194e6ad2d4d09800acde4d20c35e95cb7eb459aa5f5dd58d1849cee8f1a5c06b0e02ce2fef197a6a23e6fa6427af6537b989221e8477ef09165de0f4c0f83946359d3d2f970ddaf4441abcaaed25dfa1e12aca43084b7bb741de378821ebfaf3d43c93406a92306877a2f3fc008493cec4acb9edbf9c5aea287ae4c115cfe1dc0a6052015df2b088b8c15e64a2b61a12250b260e34add16e5d7377d2d343be47b81e3c4713e47a0e35f5b95a81222f27dc50d9bdcdb02e1d0513abc9d09b5cb9249228b90ec99567a97f694a5f01ea064c249adba3829d3df8e42cce7751a1ba0a23def6649f888cb0c8ab3b5b31858b3f2f987503027424c98d3eaf574ade6cf77367255bd25fa79600b7880e5301fbee69b8dadc93ed3cdcd4882a3bf93498e6ad0e8446cfe8505670f24a342f765b717a8d0d4e00dd3de8ab2337337fb1ea68cfe650e4a4daa568ddf26dd8568a67801e704afdee881d465285285ea9047e0c7c6295724c3fcecfbba0534d6aa2da9e4fbe8c09065241d81472b89949a7cc2944020db772ad134c63aa9131c5d23fef193c2584070bfb7549cd74b81263aff7867e3eba59a8d43711ebd558f0ff66f657d8c7be96253b4534c2f5815966855a8e47ea94873f69d2d7e5bac08b892c6c5706cd21b28d728ab798b47f9196eea96a4ad39525f6402784529a2499e345e021ce1bbb28f97e28b6c51139aa9a3d4e9f8a1e4f1e433f5042ad70dc4348f0ff78d034f78b145c6518581885c3307392bae690f03271fd4ac4afdfa5f59bc4392f6b369e18228d88a1ed0637fcd75a62af331767504e4818e5829c0560b323e0040c92aaa362ca16e773733d94862cbec11d6948128a0b1a778ba2f4bcd439d85394ab162b2089632ee5086b89cc4f5c3fa0b377067eaba3cfe9716d5ff58c00c29b1141cfab9046a48733b7c26096ed62e5724d30d3753ab8e2b7f8a199c713f8c262ccb5f4f91918dddba9c5d7efc9d12623bed475b0de28065a42c0978ac59bc5e032223b6d5f1bc23d710a6661d0d43bcad888d3b555f8647765398749767a8a4c3e9c95ed26e912c5641e1364b3466d482ccd21a2e446f2171ae44852da77bff6428968e8c710c36a5a1b4ec4beddc3a8fea5820fa577ac2cab5ec78a2005d25ec82c8c27664266b7b3563ea179d9a818532c0f359b8fe6187347e986f95f8d0200dd9a871b28ffc388d8835ec4c2f27f0d36158a52cd1d0b6fdf24a6e7b56f6b732b43872eec0b946ce5fdc2b3d579f42c6d97ff6b3e55e1737344931b8bf39aca05fc49dffb55ee971960df303a26af835825618aeeebde6df92bd52da828266db635ea648808c33e607d906553338042d9ad90805dd7250e76ba3c600096f7a25b918609a6cd59a6eeb27cde35a7d85121c2c238b2b5f1261d5690370903aabe2b69f801b9c9be3519e6a7f9fe42d55f12c5097ba50c6462f7e651caf92fdff4dc9785e76bce61f2816cec7a1c36641ec9da3c1f1426e9c9160ab2a63ba62fd55c0d447417fe4d721e34212a582e9159beae780081165e4cd1822f0229c8f5ba69d654485e68e5075fc05659ee1a0e4850284ad4fc0401d729a8200e8041a6a025d0a104f2f3f60133335db4acfc392d00f84484fe62ad06569f105370c8442d92e9bdce9579d9a6ebf4505b796e07c128461491e18dba4cb818579a3670ff949e75c60add14237585befbd2a234aebd770ad527f23c3a610a9aa62c724eec8e96dfe096e494e0c5724606e753485b2fdc55df3e4eff4e6fc8a01762ccdfe4f39793d9da1b73a839cb5d699064d48ef57a7b8c9100c93c1852e2c016f7b9eeebfd45dc8f234f0f2a4b11264042dc4d601dfa5c34a5df6b25f1241f9dd95f8fb134df303ee6d547dc6e79433737c72b652c407ecbef9758eee519d18d8d3a5d15489ae97a65b5c9acf5361edcbc9c1684745e8d138cd58cc6bb0575e319f58b9332e78178539edd6d68281d4715fa91d1b520861cef186c358482d3debbd5417a5918a7e974f852a510ca35f7b53b7ef7148da6138ed3af17eecdc1bd28baa2d516cebcfc45eae71250d2215354bf3f95929684c7370661b48160578abc67eb84c071f500433e1c57ef43da91b441483904bc743455d7b9b1894b16566e0381b63fcffbc01ff3980d06f72197be3a0814c88e34f0d8773d1e2f0360043926308b6d11ad1b9c6ad37a115e590f208d802f952a630afba69f9759a78a19f838f70a8a1677631043e7dd718abeb1971de897c6ae7d0e6457258be4b2eed8ce328c07e1f12c0e7213c4692ef3ba67ccc788e9326f72b9e85bb67115f92a063000b040e6f53c70ff3caeda3dcc315e243debb6d5f2ee1c643bda79a9a9ba677a52b864290479f7680f2cad5061943bdc7d3b03a902c1a0598c0f119d4754cc3ed412fcc638c747e3f76dca5db76380fd58070ce1d3d6045f2a0a1c0bbb6ad22736be2805c8bd5b8067aad7d3825cf284a186e63802b8fa43b8900ffef5ced74c3fa6ada4361b250649f0e5fac7659f8562908b66c358c40660bab890de803f13a9fed25853fb06a088bbe0ada3c45cf882ebfc9e02a9b228dc56af59a5a8a9a7d4166d0bde437e4c702246b375d85fbb3d8284c5933ddecb40f491578a1fbd4b35e68a844cc3e767b222017313986be6e1c140b3cc929a67bf2c7eadcc3bba600013f7974cd9092c8a683c3ebabbecba5d0217da51812618230542f0d6f86c34c1cc94e8ff2562f3b895a1ec67a70b22837db3f37fd7356a03c71e83aa72ed21102bd5c57cb7e6263a18964fee4dc4960b635c7dfd0e4f6d99874ad4ac3868d973e50dc1c6b8073071f48c1d9bd56dea57d6a92b8dc010bf3977a6b9ce4e7d3946b4b6b0b0ae4c7744b89301c30b64fd37c0a55953b884ea26a749722b2865e35b50d2deaf2de81c2519c3a2b7eb396d1e0c1f87922a2868d8382a922cdada4873a28dff5ddc5964647b6682a20ce715eb30872fe12ae38788097608a325c1a785d59bc56a30e0cdf07b48899eecf7665d320fc691470c717f232138287fd383267846c3108d8f6ea5736cc5e169f01f2f66f9cbf4595205a7b378da0e50ea12ad1879bc3d8e364725d025fa6ef66b83cea21976343e07cdaf69e071ba09f8f543c794bc9f85b417dfec5d0de6e3c39a174a976be316556d74acf77e8164ce3de93c1ce8e41728d49e21255da5154144724b53b484ee554b51252e787ca30bb9920e4c9af4864d683526d6808f32757ebba3ca9ae0f23984d1e1fd218f1ad1e656fb65cfd0a7e2d302fa0d207ffd2bd3d1a935a4cd8cbc14466c6222d2a00f40956ed43e08f08bb248f01bb0340cc883b696ae2eb22b5ced36d335591539854e09a8470a8c24be93578746b800007ed6a63fd1210c693412e19fa005278b81e310aad54481bb7dd7e2e8631117ded87e42d0d4cc7b0f9dfc5aac61361db7201eac7c064ddce9f800d482be16faa339f8cccf849cbbd1b7d412b649c549bb073d36249432d13053040e94c220c66fd5348d041e4c7af6772bc3ef7c9cfc33255442676bcef0283689b48bce135edcc4de054a4b4a5a9274b47ecd4695ac7cdb391877f0a44acdb964321960f9fec5daca0d8293bc167747a9042c08dd77cfe40d111d140f07d6e7fd3787213993bb4f83c0f32be18010bae084d41e48b158d15677aa73fde64b7c77dee09fe864da294e3eb414f6f46adaeeb2e353f434f64200b67712180ad41861b8c76830376c1e9128c3246d313940b631aa9a2dd02d5975e41ba23625698312ffd6ccad456021a540c994f33ad2cd9524b92484a02e60ae6b47452dbee2b0a16faff8d7b07f8637fe6884936fa9722368e7b92923a8ce512abadad92e05c5652f557954b3bfb3fb7fc302987459f6f48bbc9717f047d49909d0f2a6c90b28ff2e1e3884e7e2007441c8fe2b644aa4a3722eb44d0cbf74a7cc4a6346b7182894fbf6bba7d366714c00569969cce5b1cd9f95af27715ba9c77b8faceac79a0518d59a24d12f48830787d92bae2683ee5698d6465d428d0434eff61424facc728ab19571d6aaca4ce098da8662f46f004721e7ddbc629bb3fea33ce08b6103157042e5cab6f5e949f142745cf02a19f12c5ab57a99da8a73e46e750d85111a6b007dcfd6e9fb4150d04f74a3fc65023fd0cf31c2dd6969d533d7fe7d4be6a5b00567ff65296c9e051eef874bc484ea3d35c00d856b642a6387b95e4848d7723e0460abff65e5beb8498ab4c4bc142613e538445cc43ac45fad758a93b74710a0b4aa57cf435d8317daffc5bc7a4c1f6da1b3c7bb54019469da1686bb1b8f31934c3c078c9cd4b0c4d27b21efe0e8044aa9318dc172b81696d67a8657f00a9635df7f6512c2379e79cffd8da461298e9ec630afc675387f9746461425a1d35f5a1248f8055a52b50e4a8f2d9106d24c98033b871584f7033b755a781f90df303bc01505fcbc71483106b086826e6c9642b147add69fef0f2c4a57d4e0b5945c0918d6dda177180ca6ad1e8e5d557098454393114e7c713ac19118df7f1030df4aeed0f284929adf7c796be3e152c2d15f81f1031273da7f13245e73617cf2f0ec93da102f818bd8ce3374d3dd08d31da176a8d6df7fccb49b2e3ad39ed46212f0d206e68d3cb259e92ef6e763808489d0ee96dd19311feb9c972dc1da0eff8ed9a3bdecd1c852d603b0c539ff922f23da3a387fddd64f9fc3cc7c366106fa05779b8ae21ec2eb32a91fcdaeaf6762ee332e7c837d28052e3b4526f9a71eb150f9b8cd09b04d05a944bed1fca4bd10d05221adf2aeb2df318f63b9b263c6526757afc78e557d7480ff0562022215f3c6ad17e9c14dbf7a389aed96cb0736e2335c429e470b3ff09a173987d1f8d9d2cbd580df79d842668b3bd271ec827fe310cc171c0b2f51912de09bdc18ba6c78fabdc329ffe3d352b0b46fafec3d71b94ab04bb66d207ecefc9556b30060ff72d0f606fcfd6503ed973441fd9014324aebab1d78f3912d5471fd70863fce3924df4cdb50bd39e3cfb3354c16beb83b28a24ada41a3af549256a3d8b572841ebdc7d4170e94fe47c72bba0ee58004b5c1723256077afbdc0b62403d45de5b83f176c2d80920908592988cd2246cbb148c146f270a0fd5da204711651426dc43990def4727dfb8010c37cc36f8a07d337996e7087e6c8f81719d091a2af00dfc40ba7839a5e2845a3fa92d7e9a3ba8628e03eb58c7508eae9a4369b3693a594a6090ac2aa0053f94d74e12c7d99dd3db4bef9a8501d62fc658380c17a0e17ffe93947bf9716e63261b103f3dd75a4cfbc4fe681cc93649b6228b23aa6799d002418cac29f214669e9d9b44e1746e9fc59b6b3b226f1f7177916aed8b2efeaabb49bd0156c11dac865131286d82201b3d61d05b689abc100b452f3c6b35fb7112e177d27356f0ea56babdee2d4f9c5840553ad09b7dff61c966910704080beb8167ca162917eee3be08fe8fb1cc91528207edda14c1f4b4b13548cd40fbc332cb88ed31cf458f12622d6f4c4f0ce5d8aeb87424ab151f6de8ed104e14c96fc207838cf2ae85a87d936de78661f0053c113ba11282e56969b703704786712f8878211cefded62ebade1506dc8ba2ecdf9b8363f8498264343831517bffc295b81c2462a2bb14bf3857b336f0e7d86341558499093aea45a4939e59410aae2bc6756fc23a01ddd211a274f432b942c397b27e1f9f0b41d408ad772d7649ea156871811190f9aeec57205da48b23ca4b0244cb16b09b430bd2da1f20e514d19098cc8b5d266da05c4661621683d5eb0db4fe51882a0c92017ccbcfd76c8457cabc42c1e4c22f882e732d978c6c36123e67770b0b638fb800d2c47d70e45899c977f65b764f412094e64423e173356db0896acb68e36e7a4f171fa624fb8580b2edef53e60d2d9a2a685e7e8b8925dd9943fd74f9e9072c9de629cbe4c35b035a01a9964105fc120e0f42512689c0278bab63c5577d5108007165737bd317a64c9bc0a12939a6b022f4bde484bff815ebfea60920f8f7f9aedadefdbdb9ca425e6325a047722e758bb1249a5701a97ecb5ccc73c4696d872309083642549ebb1820d07a750ac3d56e45d3b158b71926d8341d15be891fab08394c3bb924efa5e867e819d6c4bdaa33645a58a4d59ed2fc5b8934b71ad8e778bbe46470af9c2591f0056cd6c01126cfcb4487aac6666637687fe1137910a0af2972f12585c3469fc21030380bb16bb4fff6c0e693c1e1547b9b8482209a14d6721c98e6a67d15713e439d0bc4f0fadc5f2d68e414ec4b9ec70b25960c406a2132003010f94e789653ba8a0767f1c198538c6ee5d32878a3cc05c8647fb8f68f3313c21923249adca4e9aaefe45d42b9942b4181aafc9f817bd4f7ea3de69cb8fb46c7c5d98ddfb0d4384c47b166b6cd6e91e0e9c54ad1cf46c096e7527a2eeeb12aa8ca23a00f84494fe4bc2abcd0f8239e7f5492c8ef9c91d5abb615d3db92cd44f3a6e35c5c37a8f66fad1ffedb96645e086173b5756f68561962b0d46c38a49ce76295554490b0486de05bc645fda10a9ee62546bf0db57c2cd306f4994e075365af4ce298a479ae2bebc0159612c576838b2d6b7ae3fcc95a6ef4f7e48bd575d139b88853ba497744c9b7ffd2eb4ed9d43c0506a92f78d9d65fa4759ef2d5ffb3e8fd254fe294598bb34f221f8f74bba04f9e718888430c9bbda80938cbe639aeeeb34dc3152a74b455d4d05cb08a31337202adb4bcd07f56ae69695c0c25ed2592be00a4f666a5addc642234c4683dd5fcb630e98dd3e1d2eae34c37b9118df91c18249a3571c22acb5ab81ff1f3105237059aaae58c515ca423788ee2d4ba4043cd172c4278db08e40c9f3c0f3bcd412ead9591f5f06f7c5975866079ef85800230c1f4f6a454050af8e88de30b9235ee3932a48c9b6180cd7513bdc2da88ff26d7cff358c6c6b4f8ff4c48bc74142051e0ffeff24c23e87f358e6a95d6257c8cbce563815fdee7ad8d66cc286596facaaf3b9c8f444a9f9cc03b88a660fe5e07224abb88aea335a3580d7045428ab1fb82d7cc7501fdc9794f5b767043ed771a93bd72ab67e315d2685ccd5b1f54518da19e7fbedff1d489dc696d8a8cc43a270ddb7654111829cabdce801a7ca380be9dee2a0229ca2b056a71bf2f498189d1c9fb99a3e9f38b1624cd8be6b7fd41902c68199e96884b407c361bca1690d26068e2e75a09892f1d37ec848f8d670ee2ad499eb8029107d7f777467b185631733efda43c3ca8891dd1a3f15ae53be7edbada3bb4a9c5da342fcf4b2a991879d34270544789e17ec161fdeadf099b95c36436b6eb9acde06b20dad624815494a077692fe38b1f21c6b25df2d946faef53cccb80496a3045daf7feee51a8de2a9d43b8f246ca8b9a50fa8685d7c51866c3862d864332b1c7d745f5cdbdc27978504510fd57fe75044eb9cea28e975b638a0c3fc18744070f61411c5629b4f3e2c8abecdc87bec0997d8d049a794d4b02c87820966ea9bc21652d78dd4a5f644e62f8712b85257b8a83db95890f56877ec3f83270cf5706d9e5197d22bf5309f9f387f4aaea430d74a7dc0c8aa4ebc27ada1d7967009be9d05441fc0f7172f65b1f8cd15c7c9bc1990cb808a3321e48d970200b03f67855bcaa7b0d89840369ddd278cf90e92e396a2aa773b298277e58c89fff1f28b616db85d99659ba30e64b4b8e026ead253ae6c7151feee3e01a36bfa92f4b4750e10e77149906e04daeae8ff790140ace2744195733e045b7117c1ef93fbe0e9f6db9cf0767a86df5bc7111ef861e8de7a8bafc1418f1d48e115b6222c5c99c1ca76b8624093c7aa0266bd62c6c609499d9fa390b176f083119bd06345eb28bab2ea35d9acbbb07ec44e1f94d43f98b5410cf10ffefa18d14d84a5f2499e33c0f7d151ddd3b6856d04ee495c565a6add3fc4056190197fcefd17d77bc0fa5b6f0baf208ebc77d4fdd16e5e05f4136ea56d38e613a7c0d9e4dde4b0962387b3f42692315b1a225b5aeefc3168aca716ef284083305a9682d9aec54b2839d40333c058fcd3a15be5b8e3ec7e2128acfae46dcd61d793e5ea3f78e84fb618fdd73909489eec9786172b36571e94548b7a82e6ffe0a679bb7d7a8f7f956abd4da4790cad7b92f8c52fe0902472b702c94b18a4a851f2e2ecd01f9ba26b838efd4f56f89cb27663a84ef67de6c08199976be25864b8b982e2d3c44fb17ea6771234832df21f757f8d16f0bc8d8d1f7fbf47685733db24df93f961e765af0ccd10e80a073343cf0664839a631d3302f0800814b8552a2ef2e8ab1a01ef791938c51e7003a676a8155c4d8f8fa487505f1568607908b62f149a3b8ced0c864ed7c3850bd3904a278d6b5f2afa878f52edfed4f180af80043b16c67d75a42ab8b0d1113a321e5503ea6c78aaab73ec34f2a67e85dd0a57dcf306ce12cdbaac8a748af2d39201b9f596fccc37f0d2e902a4683d4a7a5dd097e9d55fb667a3d9b62da51f4ce99565e3783364953f980b926a7cd5193161c780186b68d1bba44e41bf03ba9a93d2f59935cb50782bc1f53e3226c987cf2441b3d618d5649f1df4214b5e849e671bf8f1bcf08e5a2959bb6098c3f6a336d2c0d286068ad3f6790fc2c765e2dd136c323dc0cbb10bed663c8536965bdc5f76af418d87c99d27e9ad3daf59cbfb9e57817229d7e903ebb25a74296273c5ae382d64e328f6f11b42fc2c7aa568630e4a78e8b768051da29601ec6236b9e29a97b9114550732d234791db9df70a0bc61e6ce3d31f1fe171c4414878caf4911fb052c7b1d987c3f2dc028fd8548e5f874091c6548c6d02f138dd1e2b723d7567b562c7a2b3b6e9c6857ff2b5d12dcde690549ea4c21d51f07d7263f50b36c61e2a94515167fe8f5004f51938abcb49221ee7029a2affe7c728cc2c5fe4d49f7c2cde3a63385cca2c01439c977e03c208aadf741616e0de027c4bc130722541f5b5b94be259916455e113e3f389e10c4ab73b173788a8cafc02213faaedd9c4529a8313b81c532d124a0f27a6952c8d5a0c9417a1facc9b64871a6aad9b4b523215db9a10b3b5710fb491c8b7a4cd5847f11ff9ef97c24e3650fcf1c609355bb8d0cfed6b631f101430ef40feec89de18759bee73bb6577c605b6344a01cfa13120c888a19ac1489496362ed98ae90c36c99e92ed2bf646b85bf1ce8beb8da564cbdd965af4101cb18471464885adf7e8ad56f124fc0195af45c1945991d5d7981a4d18801b2758ab64a5cd86862f010a75358c614d6d1f06fc39fcdb9410156e22e71a96e014d63bf5f22932ac313b0ea33ce6af1c09b4fbd13f956ef6eeb4946175f5979bc4c9b83e944acd606368be61e06c45ebdc6ba1efecd2710556d5e4b8bb53254d4627afac631dab435efc7bbd61c142fb4e41d153f899a475a6b8e2d56d5c864c34154d8121bc89d213ff70b9cffba7993d19edaec22f6af5c28f8f5d2d4101e1f96923657ca469b8630dc4801ca49aedf2711386ae08ab3687b52bd35599ffa01cc9af7faf3867907486e412b9c38e55456a13b08904d9a48748035c6cb34ee2b953258087020e5c30bad6c1b678b32562dbf134fc33baa51e1081a86789b9a1256cf4b86c6b7c7421b7c6b7e4a0596317b0b06966332378cb91b30b50efb439068157e922046ca9fc010dc7aed369d80b94ba5670c11bf4863b9c21d51f8846b7d3de59aff59ed6d1b03eac93f8b88ee3d917fdb49432cf53ea52a55383a19b32b1562035d4a76b8b2ed47128c57469f4b0a5d9ac8d01d1a5dba97eba3378d2fa5f3287e256940a6b65d0d2c1df33a84bf427fb91378e0f423f81b983a167cc68656bd63871d20900ec3ce1a1b5fc8638588253f519bdc5c7d9782edd9f85cd37b9b621aa07c6093ec96c081e959611d825d1166847bcef1dc961de7ded10dc37b2ee71eb820263bd3f0b8a06552a99b2f34559d7cc49b34a8c09cb9fb3eb0bce367723004836cea701d20ad3f21749234a7d83670f139519d31c938ae41aa030f4a82d458bc7adbe15c08c68d7f109bb15857515027d8f6de1d66935f57209ee4be505c218b10f4918277ef15a492285941c6167901791a87e7a02193134b6b424898aa18f9b5d3befe7feab6da869d75cc019f1a533a87bf9270c2c5835647bd61d6c75987ab40da</script></div><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
      <categories>
        <category>考研</category>
      </categories>
      <tags>
        <tag>考研</tag>
        <tag>数据结构</tag>
      </tags>
  </entry>
  <entry>
    <title>991数据结构考研复习（八）——内排序</title>
    <url>/posts/991-shu-ju-jie-gou-kao-yan-fu-xi-ba-nei-pai-xu/</url>
    <content><![CDATA[<div id="hexo-blog-encrypt" data-wpm="抱歉, 这个密码看着不太对, 请再试试." data-whm="抱歉, 这个文章不能被校验, 不过您还是能看看解密后的内容."><div class="hbe-input-container"><input type="password" id="hbePass" placeholder="您好, 这里需要密码." /><label>您好, 这里需要密码.</label><div class="bottom-line"></div></div><script id="hbeData" type="hbeData" data-hmacdigest="d63fa333d2d30ad11f8b5741fd4234e74dbbcedc4978b1cd82200a17096dfac4">7afc39081a2acdef7e3eefe602482b97506cb609bb1b624ab16d7a5c0aaed395a9e5d1ae641ed5a83c9159cb2fd23a5a89b73cc61f2b83aa745b816c867064bc22b94cec386edf7bf8e89aaa8a2ad616e3eb421453a1cb6a597801e985c641967ff6464c8d522ca08e72e65b7e048aeb28065835dffcebb1a4d40063644217bfbad49fbcd2e62c695aca0ade4920e668b1dd2bf01440f4dcaffc61678b0a7c4e489dc7d13af9bcb6c3662c35c072bb3555805347259c39a39ce373dec526a1b20a638e7ff297b916785bc56b099be3bbd7dfb34682bdcb789a40dcf84f9e1ff54fc4325d0468963aee6f4b09d5b8b57cbc80abff42677628e7d0eb93f0d139777d8676d3219732ac8a2ba88c1d8adfe2f82fee9e9baab022d30ebfdff82881b65edc94ad3e4cf1fbe47319c399fa531d9ee85b3c5cb170f2b3855f54e3185a28416051d516d6009db3f23cbf7f2ba1968217baad78bd2d49cfd1d4945d7d5aadbb9ce6294101245b1d00b36a54381a31e438c39622af8d719c9dfef298438da068678ed021a392c5cadb7254d0321cf37d233155ab20c24aa10ff8655a8428aee1342517004cad93ec0a3b96cc40935b8a14a614dfd13021a2fe7149087f61de4229faca97f0b54ae60427da7da6a973295a392a16392fcef842f3bb7357e20a642a1102d5d144ae5bc9364308ac6221a8233caac9ad9ea209a5617d8fc36b519deaf3f92a4728d8f9190110b14b7c899359cf810cc5c893633aadb4a34a476746e172306b70b838dd0498ffb48cd4d90f33807ad0d4a6ed7a100a192bcb1740c80f6d4b7abf32f20caba5dd9723ab726112fd92c59f4c126e84c4bb3852fb87e44fdc367e21fe0aa954020aa517120be3c1293170cc4b5ec7d6a43fd4958f74eb72e7857c93a36d701f3f7f296b348db34b50e230adc3c9ce68941f98cc42037d808d6e4ff88a042824590a13d21d6800e1d9b4d7c8644444cd61b32fd367e9ab0da03b403baaa72858b73901f55f43a984947954c5e37e608774ea330ded6ee7e5d99ea903e349dcfca8f1d55e45109536d9e6757276aa0b83a31eea603ff8d2a5eac0d4e793b8923335e7936ca7f569f81d88c6bf82e6fd3e3bed37133640683653fd960edf9e3c2c61184593edf4318f169ee280e41859a4dadd5dd45d99fdaafe8c30dc3b87c6b780fd6ff3f27893106ed3c4f54edb94286c9cf98ebc72efe46993e69eb6332a00c0b6cbd000981bf979d6afcccdb53cd01f6bc7d8a7a4d6f3bac5e841076143fe26e815a4fbab81d84b53b6a092798c19fbb2b32f6a07074bc70a13b6912ee01eb33e77e962ff1ad309820273036d37993d2742328f2b3c1c72e672cb62a83426172df5558c39558fc820d34d064c4e2579b081f87832810d7c03e51fbc9a4f8d9346ee7356d2fa1d2a6f73a9a3b7681ce4a7c3c69f59876bc5e0add2804521d17e578edb8a7985d15f319445f2233387602485d13010265ebe0794e17e8bbdc883f65afa35d570bf38e92f45de8e9d6c7379e78b41f7550b9924c75fe686345bd0867baf9166681747db537c2b212d750fb22f86f6210976850ec52a4d2433ffcaedfa378aaa22c23a5cb848579b61682e35e80386095372e631d7179501965d23e0d70d35f265a95129f9d39c161f6d7780fbe3c1b4b0346cafcb472af7e90ef42695efce975be3c88367d5f2f1b4ded2d7b482d77921f7f239f1c07553b88764444126ccdbeb6cb24d8719fa039d42e29fbe8bafdd198c2ea9a9db95adfeab165df236646dc8488366e31746151b8796efa0f034863506d0f5f23d098841c278faf7c5e188eaddc16067647fd940d02c604dc026a6bd2db19ae436ed54bbc2280e7f0058550d3a3f71a5fd692abac3d95690a92be8fdeac8ff120efccf8d44006340e8c8a64ad33ca696c61539a49087ca404acc97316bcad1226c805476b5d34c9a777f20627fa13b5c8c8e5f81fe69416e5b3983c61dc8405dadcdc9ac5f66f013b879077ae5e69dfbc42c2c9aff0b1652fd42a2c4751ca8c1d626d1327b1cfd42cf3ef32f372cc0441ce76c68cac8eef0f3d205a22d4cac01348535032ad7e0d15a4bd64e920a0f5b7c3f20be4a0e7cc8605265b00416414c75d0d643cba2c850620087867e4b1b859e0337d3a3273c0718bdc08655e3ca17b17a364e7b5d0bff1ef1077f005361d6f444718a328eab078241117f2fd89c7ddd421d138f6fc7d242b703017e7b41bc4bbe089781fcb1de13bdf1c985e03af71603d403abfe3d969b6cf4615764e499091ccff22baf8f6df251e5e6adfee9a3888c95455232811350f13741caebd28548e63ac87c4389065e2d2f5103ab88a942a29ad514393507b2d13dfa9052cb502cfbaf0cfd58a4971a36c01624defcbd67c4096a4f9acaad37e0eded387d704bd1677d7cde36e0181fbc959d7998d2c2e290c3501978cf2acab82c1b4584e24d93fa430dd4ca73681be6c0db1d8da44642d59330b7584d4e6513c6b2e879e450da868c471cf5491548f95bbe84f16a9f024d60180f52b1db7ce8090ad7aa75ef698e7dacdcaf71dff5ff2676b4fb5e37ff71706da47f35a3ea728ee87a52dfee7c9e0978d510ff00f8be22c5abdd40833977b9d78a43d36521c1a97e02e305048c7a97cebdde598e5db22ad9e43e845122716463d2bc1f75900d55107ef49faf3594506aba965001d93bbd0f08ef225fd561e31208d2ea461c745fc4dd81e584b6e8e40bb2e6123137353a9e390b5550917475d1173c17ec9a7164b78bb7a40e18bc35c33b6eb5fa2b06dbbab1430b1aa68ff40c7f720b330c0411e5128e2260d59e148ff7946e8f22872a7f6a93a8efad6b15ccc6f43e44de5b56b15f43f8d3e21da35203a421186ec21a6a85f1b290db808810f3b3f8c9fa7331c32cc885d878e740fe1f10938e7867b0d71fbe549c44769001af3b771c82a5b3ec2aab31bfcf9ec6a3f21086fea55cbc6c6b2f0d5d40321d5b4d682d77ce8512a6e9cd3f5620c9d0a0bea941d8dd0c3effd42b425fb54216eff0905b5acae970ff991786300774316d4b449907cb25d1023de1f9fb780d411e9149a20a80128ec79143b7a421ad9332a3acaab290b59e372efa5c2024b11fe2c4d5890bab55688475d0f3a4681bafddb1d850442e1c21ffaaecc109e942565a2ee56fec3333e253c776d5f78963bc37c261ea07bccda355fe4c317d28177d60de2a4101dfad4387e6db488e1784aca2872e668b01426fd408fe0f76c2e361a82d0c240ff7209d856ef637112ef5cce7578835929d7bfed878d1af00d79ad29d5a219097df2a293175a68537cb2a5722f58f0fbac1ede07085d57861c8a05a87b90e77d9bf4ea0de7f336dcefa4580afd4b131ecb53e734862f8603690580d8eb48ea29689e61fa60c29f7d3cfd05520c765be1ba28be4d8699f92fc406f6271f13b72f0d22857c135741eccf80082d7c6b84b988c50cfaf1b107f04ed94d71e7407bb5bf7dcee325d4a2ce45ded08a8bec48da7219adc0939e49bcac5e9b3e79cb639cb411d1b139061b6c4bc1e0c351690b0f6977c62afcfda7e7782b09628ebd7b4d5f2dee01b2d26afcd859494657f2efe5ad6c492bd56fa8de71fbe5bc4dbe5a016fa183e5c1e722882bd2fcd26220794fa917bc53f3daa2030c87f7d78dd8e35cf502abbfd3d76b1efed819787b150e4156d535bbfe52cc658fbe731b32b2f505146b3d273438a84096508d85e0ba68aba2a1dd81f75ee27db1ada519365030fa9c2c4e301360431fda33d999f0722d96d51cd2db6a7f8d13c746ec52ffa5015036e25821c3901dd3b44e2c4888f5c0b72b222cb570fa2aec7669480d57cd3a676d7d52e8aeb1f03ace8325dd5429b8f5a1dc98b6a692d5998d7baa716464e858abfc404861abfef0ec4c9ba0c955c77aad70087aae30d83461c4edc3d0028a13acdf87f67e65a9d667c157b3d62cdc9c6e264c332e4d965d40ff9ea2264bbf1dcfc215731f7a595bc6136d1dea2127fa312e817c345cc1d8538fa08cfbf21097e02da3a3162d008cd393d55b45630dabd4196249814cccbcd2e929fa5c0b2fc249ed3760623b37ef6ea875ae3b83d608ec8d76a3af2d9f2f506a11f68160c1e6b46724ce66341f8538b7dd2ac91c8f4536f1173f58538e02f2899b980a6cf386caeb150f60bcfe4f38c2f53cb7ceb4353db9a2f4b4d0557a60cb80604e21e397fcd6dc8fdc2ad55fc6dc575453ddfc2e1aa716f03746e90a845c52727a8d595a075836964ca49053278da3b350e79d1a2cea7d10284413d95365da875bbaa62c28497c48b1de4aee85b9bfa06a841e4b154dd63e7215e93f731ec5dee5e96e2f69ece3795fc80196a58eb6c9f571623d454c3a120258fcccc8ed7dfc352438cb4b6000a016ba1e261e844e2d5d5135a194f0290544d68c77fcf27088b081974b7f07abe5ea8bf3f50a79f6748df318b7b14fef75d98106dfa471460bfd6e29c1b2734dd847524e6889dbae76e3a472bdc2ed130bea58803150f8c4457cf4b6a6f8e4d85ec47c36a436c07e501c643d557b1b9561ff6c471e4c5387cbabb309a5b1d18e247eb924fcd65dc955d259e1acde339a8ce4a603bf06ea43bad99087822c438f22fd329be12da94171b56edc651504ee7be00606fd71e72494492feb03ae54bebcad292945ccfd9f7b37a982eb45f8ed33c1b5e774af3b4d2c5021bd15c0a1cae7854abf8d8fabf10ca5178c9abf477a0ffa4c6b5df6ae943fc03a107be17b217777e9a4eeac3d959ec739c36acddfc06b8b9d910981a20f81e2f8e2becd5c4447accc59946a7d50dd40e1a521981a40ee199bdcd7b1b9080b5b854a594c6ac54c1cb762ee6df417477e51f7ec04bd502dd0bccef2d04f698e5ea0b2f6c71efb1c795c3b13e1a901563cd6a4900f0290f6ff6f7c114405a637d9b7608a53c533885078dc64a5c2e7ec45da07c169c6a5c7a9328e5a0f8572caa8614758e212d92a34ab30df25a49abd2a4095474d574f5129f4534630af903720aa9435d9c8216ff0cf797a47becaf5a4de8c92a8dc0543c3ef27d59f4c1d089d908a45ceca425296a8deb8b4609cf44f7e5687cdad495cb2926a0cb346b9f62fac4fdb7ac0778a3ea3e18b7c3c83e55854738821b9ef7054f79aec774c3a2f51bcde52a21acc6d4c3f3be166b91dcc8aabf51f3d3b785885a1131898f7f721f36a09d2e1d6fc07f1db8ab1f3bf0189041032d03d1cb95f8b5dae3cf144c9d8203d75404b44f5850e33977141fbb27a9e2e277c73f765c7e37a9e5714a6efec66c94e4f1026c962af60112aad508fe686481fc02e64de8826287c121b5f9766ad02e91dbfebba43973cd248080dad27c55e319de6fe3450c54851ac65ade016beee88a856298b5d0972fdc850a291b87cd8f486f314054de139a52cd0172b23cdefcaca2400b2e955c68c880d1c6e82588497864ded558f717d9f765ec00bc464bf983df3c6c25074ccdfe87a78f26e40899203fa8541a16356fb724ca16168badf97b4fde39c9da85e105f23a48afe467ddf4be3af10d4fda7d25b524b0c2825e94ab646beedf50d58aa12e842824faa74e6e014b5fd3b71ac14c44ce946e08607459bd0d8437201420fa654146dd49c027afee0c5d79abf96c1c0f747639e71405c3a565b6768689bc239d9f10ae38e165c404d39147a701868f0425fefbc0a7faceeee97831e041d647dc0aaf5eb2fb5059de53da5805fe1cfc30b688ae641476aa19d4c5e9c4a90c2d5b90094e9dc0f6ad0f82a24615ee97ff245f5d633b92913b158316063af38babb63afce38bc2557cf1e9e1fa53855f4c20e312788961b465e6181e09c8ed1dea1913e7d89bb3502bca570c8020a45fbcb58579fd1eb8fd44d426b98c011f835783c3a82e0f20c9c95336f6184d4d2c567b19db5cec4a73dddd130664ee29e5445405aebf573a6dfd46148970b4b5871bbdbef5078d130a0d743b6765462a29c7e8f51ba98b256e28c501119a6d8e53fe2fbdea4a6b839405b0a4548b4f498f051655c5f01ed2dbb293aaecb984ac2b86fe5815f7419e3d20208796f5d2cc41dcd79e64a7f3cd5eb8d5cd39d8aa6a53db39e46438c1134c5a49ba64aafe500d9b8f4d27ee10061e4db40babe8f978d0a3c5f351d7c170ae61271727b1be467b352de74d4ad9190aa53709e666404aec19d91a08800207a4dfb6533ed69cc9bc5548174271eb2eb4d407acb415b15fd195a1e3506a16eb707422198411c983de957820d67788dc4a364298ef2000734a005517a21a82e08e4a14abf236ba0ece648f8f13f73333b3cd301b85090a792bfbf05e07a7613b181e50d72b5c1e4ae736195f47c845fdff3eace10e69b231957d8f40e43720f12d2d226e40080f4c72547d234dcd85d2cdd157d73d36e6c73732c0c35d67e15478ed0edbfda01b9ba143e53786a4edf786ba00511a201cae424c8333d839bc7c568f998f6f38b894c4e185842a47d40195453bf81fe5c3790039901a42517f564ffc81fb932c2c7dae6d16c96f1816858318394be94bfbfe47d0253b97f9d6ce351d84c9ffc0888bf7b2b5efa8176e903b12a1f4f5ff3095da2c444ace86dd99862cc8ca232654f4f3f542c2b40f04cdaaf2fefeeb66bf5d35b0d448a0587a3e2769ab3ac8a4fd7394a0dc107d75b880d409912b4b17dcc79d81bff4c01f637d5cd3162334386a6589eafae8ca77c4764480bef24d1887eb3404e6382151f4767063d447aac68b66e11198a809e54cc3c69b2da179fa9c703e5bc5bfd2957b21c3b3c728c618b64d29c54acfaedc88f6b29d7fbb7e62a9596cd7ece982ba138708fbbdf685b70b3c8f215a06ef215cf47609a467f581fb633e9ce01f5a2d1a5c858c69ca86ed04954caa4d144f02af8de453777d8c157f8b8049a5179cc1ab12aba6523c02939aa81cdd25adcd0f8a301b8a407930d912c7ea30c2374523aeff7ee6b5b89a9532f1a90be5c941309a50211c9f052c6c50bf14920f30c225f5a20c619947f03665b46bde173607c8699a9aad447f247186619c6023dc259ac3be26c24fd13ea8f5902aeb237a2dd2c2d736307e176cefe073e17780b8cb8685906b662bd3292141026e879cb91e1a10d2472a34771f3cd532f75710557eb062e5ac9478fcecf78a5528b2781f75132b7bb4b863fd2e020522fb98ab1b9150424b5d6fc01604bacd35e987a96137a5468b16bd2c677dc190496535908d1143f45f3e74e96c4924b58ec49df5c9f6216a93d815ef5bfd2e7c1523ed274471310f984ee7ddc16d66fbb4af87d59f2ef42c2405653fc282d3b181927c7e82a7c39db9a5e500817ecadbe06dad346b669d994a2c37b82ab49dab5a7eb5be555fd554c34cdb6a6ee4d29b128a5b708adc6a59fa2896438207104b272bed31361dc4e174493702b3118e75c13cf026673ca7476bf87e750c40442439e8fbe3c4b033413d210f278d7e1d7024a87eff2c6dc5432112776cc508d192ce785264376025df2f5a02f81398e70c9734a204a51c26d40daf2c3ed4caf697258adc0676838721058e6995ccf4337363e92757ba0c394e93e56c8628c3a17fdb38a4e53942113bf128490c20857f3fb95d687087a6a16a04a93aaa403ba94ce0c7f3656f297d2ba1c70c9e615aa4b024bd8a1d4a63a9cc833fd7ff7a7b5032bd83d026d18b2b40ce5b4e4b935b32c503bd07299a2159687a013eb9cbbf1caf462c66b59219bfe34ca04fe2745e75aac058e87a8d4234218e60045ee7e8fd259c8df01031c498f7a7963c95fe672345a21aa964365b3324314f087b42d7cef105bd59ed45e0618874eabede92e5ef62d80d15e9cd3006f477326ddca71a7971712c1ec21d7fcea7b2e9205f6aae559d9368a80eef9dabc7305e347eb85bbc2423724801d599acf340e1d0ca9d9ace1c5473db74b173d26171add526adca585249cf7da3a5a6876a8ebf81ad949e517ca3a1e2a1511d11b96c323cc4964a8ad92127faffa2a18b05610daaed60ef5ecf54b4bf129c3ac174d21d738f95ce312acc51d3660d63c02c6d3695fc8b62109296b29113f36f76f31f8e5dae87c3199a459e58c57644a0ae67601d05a64e05a6ef87072a095c4d284f7af6bb8eda2632e9f1a5b4c81ab50892277a84198d17af9fbc03133ff42865cf4976f193d17755b0b8c4ae06d7ce3d81be81639ffcfefcff8d57d30c8e16d8dca0c225189ef014e4f8fd14beccf76aa27461dd93615f7db6cb1d56d6f8485ef5c0b568b812c9f3fb1c97c0105a3916ac32d7fc77dff73f27483ae44b59ad02fc5caaa45b590db183bd749b5c00ad476394aef06a6e0341a37a4831e790e963dd1370e4ee9f39a8b365d1c54e2afe90524e2a9b8bc489cbb1d5dd990c4179099e3cadbd7b56b667934249410bb6a63d39675e3ad1f9ce78e9f0f5d7ba658bf2117ea4323e45dfbfe7336006645d9f78f150d385b23878dbeeb9a7cfaa4a8f90dbd4b7e0b03e66b602a67498d3c151c5c2a6b50f7c5de246a9571e46261cfa64b7826c772b3f8bbc8f5f4cc87f312508ede6c47da60402aa14f07ff0a9c4d9c97691f65a2154929179d9c10e18daeca65954ba0420f15a9c2247040245768c2b06f50d1bc5dfa34ec67cb65a13cda70d848cb2570ccdafd35a6aa571ec76c00259e93aba993fe80b8f514d93e355e75dbe734af8d45d42f76364f8421068a7fd151eee67a949654412013d96bec0f0660f1a188dc85c8355919c9f0f816d13ef659e3cc69efdd0752fa56afc7aa4916efce501bf875878d8f93bde8fa018fc1f631afe80a1c691aae028693d6f35e3223718fd82829e233d0b4bb9f86711b49234ab6e68817b5b0ca18bbd747c5ed6886f979276540b84e9d0c0f280f07365e85623095dcf8a9c0c59fdfa2e5b0602e56292be7e6fd68e95095b2d50be95439c6af4b16d941f3a4206a938cd6f2eb898de1f346047d962b002a9eab50a1c2ea1158effa5c18ae2ad11ef50f6f4c86ee06967473ffc4f221d937a1875cfd4d1764f364bb2bd73240195ba042965a1743b65aff5a28289bc8024b5291689e7f669739ea0fdfd04ca8ca605c9cdf110efbb6da7ad47d9fba149d2b77bd04a934e8ee948f75dd2a46ba8ea71a1c6063fde1d691541b09a47d7d83122db920ce39b7a5016baf32d4fca8985d4277035c002e7893176f46727e218e5215886cda674e48b3c47d8c03a10a995c0d0a8c55e038bb28540e3e6d5a0fbb6621bc88415048c859344cdc060ec081ad39aabd11df4d4ddc076c3949624c9a9dd91c06151b61c4ef63e39d9017079f11c168d79c7f4cb6f505a5c54c8e32d86cbd83bb7708b6e4973e4d38923d5e4cbad7e66a05fcc9dfaaee4d40293f4f702796b27db236cf0e96c214564184c5571d8570ede06dc913212510407ed0d0ff94547e59ed91f51d77812fd8342826e99fb1a4769763b02bfd46643350e3c172e83c9db3d9d782ff97d430d9055fe38e6001df1c46c015a93078cc9c6504e700f4f81882c23f4032c8e51498f17f8368627a5b67d7b9116d9b8d2ae7bfea9378249badc294d0be647455a847bcf014d4d45aa00c8ca4cbc1a166cce13cc1f1c20f5c4599cabe1e0fa63decc5e3c6349434d6d6fcff3179f072e6a2b5c1dbb93860845da841513d8b69f91b449b6a53876897f124bce61cc32d76e8d699dd3a2236d7953f51568270bc801380650b3fdab2d8427029565848ee63d6df6de5d6fe516e90d153ab41ae2d0700ddbd7afd3cb501b3ba3bf75fbcbb6c074834e2771f6606131d2d9fedc887e93355fd65898b027823b085158f942d51a4adef998378b973dc75d447157bc7e245b4fbc457a95e0b5fbe9d4cd3c2478f1874a52ca2bfd5f30199052fa10c80e21576d3cfeaadb4f9cf73ebfd672c34f2b48bf570c1535176579d6227c463442722d4ecea34c60606b31430cf6436b07ac3669ecee134f27768c8f2c5199ec0871515411084357c665895ae9c438a49114c63cf43e78e172b8584b896d356e84b91d213f88da236e662bf6a5e97f543263226e18a0f410ede538511f6880c53c2ed646865939c8c5192a6b16a1b04f52917deac891da68c07e3bd2b72586bef7c64d742ee97cc7e545ebdfaa400169cff038695c7f7ae8f24615759f59bb60b6c8bab09a55094cccae5b049c4c6ec6c91d58036efb61ceb17a1b64d13d60b1f340ce0093f27603c2a02c971e0828b6b70722231d9d19f341b59c68f8cc4d9c856b43707d1801a678919498aac9494fbed7bab0dfdebd5853a0d94a018f168e7dab8feeb30d0afc7dbf7b0cd47d98f9121d61fa0b6963920f0b1a25b92e90c8b3981c4c02692e14e99d950875975811d9cd6401772bdd63cb287dd993b599b704197024a00c3cc88e2832448318756afc969863e62440faaf61e196a18fafc20714d4c5f85ecca45bc71ca5dafeb87dc7b9037616d20415ed3a012b75cfac2d222cbc1ac0c73ba441343bdf6b51313d9eea93ea7f334aff9027474adcae8e16c588528a1e5e15cbcd2fd687f997e5fc6108d96993d026f4575c86bec66c51d1422a599a71ee93b776107085330970d72daa2a6c020926c6e10530544a0f7ad1502646ecf41145fb56f3d2e97861d93214e6d610d9313eb08160868e86449d1e7c20da7b498588e76bd636a3b3705683649c69575e2df773b5d077725ab8ad4b559874ec78df73cf90eb50ace4739389d47018260e37e34d51ae0186fd4e2b7f89c7317a6586916aa243c0153edd19107c1042d7591870d2005adb82b2c5c7f4c6e255c2ec7d16486a769ee99cb3172d1fe869bc7497996b970e6097afdd06496949d5b334ffe1da2f97d20d80eb6b977cdf608c40e05a91d21a9b86d704f0977ac40d0f8960d15f41b1d5596380114a336f9c9b8f31c6a7827f02da4950a127ce032e18dbc7d227aeb6c566cca2a1ce8ad63104f40c607d3dce4dc027a7511d8fcd12de65f39c2e5a857412be4d67d776534b5e19b828c4e96aded7aead23b809088df16cc0f35b2ff3f990a6a61d00b953e70d33ad01ab678c42ec93d813d20a87d879b58bd6061a025aa883faf1d69025bfb6ac974bd8734cf1a130b09a8bb008e4ad32fb4bc74838f4add7dbb6b783f5b4be68172c5eba66ace4a451542fd66f4b0c9f49b070bc15d60e3f419278964a6a741f4c498461613fba80cc8ccb6e5ea33ff344dd7c489fc5e1e458e39300d9446336cfc2625f9ae467b8dbdb8c055d5886d50ee04f1828690ba024852d31230f8c5045bc35a690172199c3333857df760b0e6200ea515e025df8df42a4a41b6248a8cd75bf73790ef9af33308dbb1509b9cf2a03c6937f9d0e643e4c7b9dafe221007d161e54271d5bc4687893d0a05f04a396eb9de300826cf7a7b8cdf9b9f1aba1e61804bd6ea7c80dded5a3231c09048f0e88b48e1bf77914f79bb2f0aa54d2d4f1958ea7f96316fe7e638f31d20d5ff4a210e4c136b476cd5fd941205d5c9402fe780fa3d306583bcefc3a6912498bdf7da43d8c46fc5bbf9b5cd272560604801c55414bfe5a7bf45d314037c93df4dc61900cfe77a0e4a93f518c5bbf0a0d620d3c11d201406fa90acaa08c03d1c2cfa9124c7f23ad56ae47f290f66d7a317faa5cc883d3cc65d1a3faea669a1e364437c8b2e3cbf5e2897627a874ad7f1aa6f03be1f563f5da6efc4784ef00e6f3df6507c67655a192f1b896b553455f778f46e3d7b7bb44bf25ad0b566130726b97dedce2cd7b2aaab73135394872d948c3c4cce22570ac507e110933768f4ea57c7df7fea2a4480a091a0554683f5998404ce9fe3bf5aa904e23bdf9b8c52f4718f7d2b3ffc538c1a1455b6a19d4eb62671c7c801536afde555c3c2cd4209a17b2b7dd59cb8d816639077ec88ee2464217977a552c0a92e7c19c8a1a3ce5a99cc5f6d7df13c26cfb1bd66815d87d66791ccf68035819e566a2576604215be739122174114050257ea4179e098d4e7d5d5ab912e9f2671671c2edab31eb868b0041829fa10a8d507a8b9933e6035f9992c82138bdb1d3c2393fa05e38b4946e198d6df200c2c4cb880e20327097dd1820427e139646d370ac24f3a44c34c0836e36460aa77d0152a2664b6aa2959d82d86f613c96e3415b054d317e4ac7c3aec08266673b248b987c161c818d2e3293db0f4fa4a0158e9ccd71d431c94de4435b2cec8255156629188f992ed13d3b36be514b9e24061e41fee27ca51406eade5c7033da320be36b2938b6ed48a35ea33150d15706fb2d3c1f90b36bfd892ae6a441cc137caf6391d626007131e17e9652aedd2a64b26cec7430949f79e5e3edc9debae8f9cb21455a8092c66dda02c8c85488f27b472b624dfca8740105b7468d63b690bf29ff10aa77275e9748592edfe0199ec5f6a061eb182095135934896435e3660e66b42d30c76810654346d511aa7fb19eba43c9528f51f85f05813f95231f30a18c689c6e5f5d2331c7ef85894ef11ec319cf3b199fe5af9d60f8cb3dfca3b4f738efea8fd6a23c9f6e9aa38af9bfaf5ed6cb44fc460cbd35f5b65b75b6554a1d3d4975883a127dac1b820b28fff3b1a881f1c0b3c44f43aa3c9186b7ca793e91eebadeae68bfa62d86f5390b98f5660668c6d933cf67c684a3e6eabb4506cb0f95ddc466a179b29c0883fd49bb261cf9e75af0b3f78fa15866761349b71ac7a56ac5086781f4f8d9e0e6418e3235d121d4a03cee1223bba5259792c497e73408ef797f3983635715e6b654da0ea0a09f3cc01dbba8312e540489097b1fffac8789e60e044977de0b1431db2a75a700de74665f0c9b1f7e8c4576e016a9db702f52c3eb0f71c0da3deeb3fc0469334a742959b494025338aaad97aa212ff6c265e88c87d53c4ff2f82f0180f5b9edf8124e59ebc262f8742c25a8ddc477fd64122864294252e95f479ea99cde995cf2ef796eaf3cecb1708152abfdf139b1ee9f5c3319a7f60f2259970164a2b9cc9bac9b6598fbebff8fc44b3b2f856a75d7f6bb6f8ed9e7e2c06ae9e9201be2f3cf6f2574c2b08f719718b9f1bbb1d51c7108aaa35415d754b0f394ffa9653f3c18709ab57d214308e653362496709bc30195dd3beed71911de0d0494b9d8f6f1e98129223e198e03e459b896422bd7626a2e89b08d1df2949f6b5149f12ff77680753b292334070d9c55169677d41450b740ab0b91652701b4340f201f4a5b21739c29c85795d220ac223a2de4e3fdb791d0968a48b3a668533756c3610e1a7764ceb197abdd658c54a090346248e39fe95be0921253448ba268518cfb7bd0060d212a1c1ff8aa41418fc9e54d3b8dafd9183c81a142fe6ae8328d64d332209fb1eef5631a6dafe5bba8da6487a203734b2686d21788883c26129f364662deb55d98c5b0b9def2e844e5253add9cfa1746ae7d1cfb734d07fabad584fd416a2db6c00111f6cb3dd50120738f699160e6f7ef2b3fb5ef325e02fc40a3b3658bfd7eb408d9bba170dc6641cb62911a520b9fb6e51d32088dc001fed1d59104877e3fa14d896c018e39747e44e4be961f55c61123212ea5e3f6a12cc80207af56cedab93a1e9e80de6d41634c950fdcf87f0bf450b0055c68345b19efa234cf0adb79b11471c55071420c81a22b781055927112d747abfe6f54b990c95e3591e3623789e23fa51f0744e22f0d652d4cd0758ccb1828b59f404fdae0aab0d1735ca7e7ac1b4f7e53a0e47fb4772814b1a538ff73983aca0f93715efa4ace9dced261d8b3e00f06cbe9ce5f3a4b19808bd7e40e9b5d5ea1317c03b76a6a23a50453339366a54551bf690bab692dd44c46fba4bdfaa69a2a6f2d4744a07b50edd58e388450dbd408531189afba96a1a722ebd98957b56738e40ac4f8836948e06be5b9e683831315e9ff84827ff26da1f76f3978caa23887de233ae49fd6dfa35ea5c82c3ebccddb9b7c9603c1a000580f29dc65e5f687f0a31409b821c87358b19d7d82a64ec06ab03f37ae1668eb1ca88270b42a94724d0ce771d57d1202bdf45bf60f6f03cca565307fb72902489a5b24391ef6a9019d6cfb09d04b30c07d27a8e5f98a7c010b0bfe34b931843482bb346dbadbcbe61cc5da4ad644ac9fd51e5a54a085f7848c17b93682a1e49ffb1e968415d84d8e17d0256eb899a6ee02408f9e1105443d0e8b1122fb53397f96bbfa943b9156a7868a31d52b9347d091e632800ff293be9330a3996ea9cc33edd7fc0a93eb5e3312f2663e9a318afcc081e13dfccf4d4f21ed59d4c21b7e2e5650c1aeae341e2dd9dfcfc961efe3f64b8be89a9cc11de42e7fad3be3b1a77ad1f572be0ad5d40eaf3ae2fb881a65a04d1ce548270fb81ed195d6db1f6a67797ae6b75e7d78cd03f0e01115478e8d0bfa11fd31ba9c1838eb3df6a2b3c69b405d2823e0d491a2711e0eba7b7a1269a782803e26ce50720bec33b32b709cef699d8dcf7e78c32eef84b5a88f86814c3169f82cf858811278ddb10f294692b27526d14c21914323928b0dc4649250073809f76492b43610ea8cea7a74d26c1c31f23347253be2956cd6f438582059bee50bec8bff2639262132e476d680d584e6347817949bb6c4021432dfbf7fa9fdc1a8a01af6146c7a164e4109cec4bdaff975390a3748726efe58b75eee5b31ec16194c00302d8bb19033b665531fe58b8796fa56486e05123eec10161b409cfbc2c511e18c5ac152c2ac042e2bafdb609b81f126a7cceab8dd3305c92c98063878dc4548d8d0f142d67536757b185c2152dfea9774f1902a185b2ec4a554818ff58a8216bfe047a4eb9e8f50ac45ed1ce5f9808052936803d92c6b4ceac726f6ccec1b4004ed5b58fef78293b82eef2f8dd897bfc5ddeb8ed06b535fcac66c7bee5198acd65c1d6b603c14a4f8495ca4a2f28342c08cfbf805466129e7dd136100859192d639a371eaf61f840efce2faecd26f8d0e2b0007f1540c90be39a6d47d9c87c5e5a498084b7934c8a134d8f5f64eee5beddafc6f90c021dbb16727e503053713f2d1d741d1c0acb29c1d8085bcbcd0ab66f8609e7aa1c24b1e9ae41477df6ed02868cf14f64d6748351b941e4d45d7384013563e52882ab10c0c29113df7802bd6eed48ef6591f2188d535c22d998f1d286ccadd8bab9897605a8e56de3710d3a4bbaa2b61188aa4ffbca289ebfcf6e27ce59b184e9b4aac3a864245bc2aea55aad975bb70d8dcfb8167707b8b434cc082eb0235aa168d271aaf69cfc05a1d6a043aec37be55fa8b2d3a284a8313cddee9337add8b86a9dfbee5bbc733a892350a1e29f73059ebe79aeefb1288bd908f18656878ca1c426c6fe445f481e3570289e21b5fd9432e3165426c05f687270fd51e76a1dba80736764b50d806510975be0d59511b127056431cb03b8771c5d68dac7b1e9d2672b4b7a22d81b5dd93c0ed3db6a31d32fcbd9b6be43eaaa0be6920e237e143a63a86eab7ddf54b699dfe0353620cd1c70463f649a074cd9122a4f8e27abd8ffde7824e14680adc413ef43217f22425d48d9f4a98e1a9fe9cb9767b9f849e54a36c872894ed73424c41e541f80ba7c26ded6361005f9437e0ecee50666870e9ef6640cc4076420544c91fae23f5428e4f6094b880e43cd35a65fb21156442d42ff19bf50eb7d0052ed0cb8fd56b988e29d38963f62f086147cf143894cc22861211ab5bbf73ea6b1536b8c5e5519efdd725ab4ee4b7bb832e7523361c8b38e8a43575a8089fafc4e7c698f3313facd6691f7e587ac4e9add9854e53fbc6dcc859caf40b3a5e5dd3b74b8243444de7c7e8943cf8e3a891b0e93723794084fde81d48c661c36e27c35cfc05a2fb7f90eddbf5ed97c6d5782b68aa7b4a6f30c8dbaeea258d43c03a047c3af4751c6607205cf3bc1f4d16faad70e9a46b754bb4fc9dd6525f65205dc19b59f38a56b631ea62ca20de048d0cc001ddb2fd54901aef3e5ff41f84ec62a468598f94f9a5426a7edeee9d8d27175b084c6cd30074c589a9fc65f85aa165cc3d433f96aa36a1f6b2cc044f28cc285ebbd0a26bbc50092703c2f5cb4793b94451fcd037ea3c8d8059233c5dcd87fb3a21689f1eb67e83f9025ff06e1fc235a1767cf89785110bde2cbf449f6ac27ec5c9787737245aaecea808265026b8b58aae337cbb140fec6c4596a581210087ea0d2483f02240bf69e889da5847fc2198bbe0cf31649d0e0b68ecea0896fd2bd48ae3de75590dbba31e4f7a71c4e0562421d46dec7c488ed4564789e0751e173ed00bd5294b6981690e5a7c4983ab06b0f916b3288159ceb76bf08348b36b9e7fc2d51a1ccd6c613b77de20c00a8445552bb9950091fbc9ee396101048a9c412e539cf0f26eccc61996fbb4d0104e021bebfc194adb62bcb0833855d2efbacb389ec71ea6515727300c6c60b88c3a61364f3b3413a85161d86d34252e62bc56ef7f848d8329323e7543659ea3199286a5ba5f05d5a540364481534e437adfdb4030128b196b9541c6f7c8dabc1144253a26daaa72dfe06b4cced0348a3c3abb51ad088dc014b75866f578e7ddd5d66dc63a1bba0cfdb4c7da6964e369fb5138d947d09f43ca04bd659d66a2a57f62745d0357338b5bdb496df6b3604f8915cce645d9d470d4b11ec19d9a702b57d63a7ccdedfb661867ef45e26243a9d0eaabda76a5e1c291083e9632c73f412c72aeb0b13e9f8148d64ebfc2564507c91bfeb5b81ac8447b52b12f49b957b407f73cede62359466ca5569d6c5f9acf3384bef703eb4cafd34d258491119bcaa8bfd1944b49ba8ef78b2e4d74b8cc358e8f43a7382f3cec9e429ef109a7141d29003c92d6c7271de7a0c28dd9e08606da5c644be8392a907a09d867c0b0230c4fe989004d3f6dd843cde8b6d8a25bef2e30db5b10bc20f8dea8f9ce187ee0fdf8dc67f098067785f583939d254a2454d7094d3d24b01f48fc7f8aa138fc43a7b3b4a271b3ddcd2f5e0ef0eae7ff8765964094ccc43e4ce518c40d8fec59f683c350220c7f2588b99587bd175dfaa681e4338271135680eaab8cee6558a86a7bf2119e94d5cfeca4a3dbbb0381207eed2ed7d4870e564fc05e81767f16ecb21fcb815b6f8345d5e43724236512e39abbb7e0523c8c49b25009da8574e764100a745bc261ea8276b4f02635614d05ee111d5b47b78ec757f814fbe374134a3b84e4e0e8342e73e4eba89497240405e2a0261c248bde8ddad7cbcb0464d84edceec4923ced9a5701c4493dfa0ec7c1a13c3b54e497a66e98bba896704353f85d01080e4a9e5661722004ace5d0fe7ed9706f7bdb33476d0775bbdbaf439d63936e46e88e1c134988105fbb2c8d0759715c58c675e093101ebbb91f3345144eaa619757b97f56aa87acfed7994c37f4ba0cfd710af25bb09333b13982db5c96f2f7ba966133c7f10d4bd5f7e9b161f4881e6b50846e039a2ed696fc6e7784abef4d3fb6d2c53964be4cdf0959653a3bedc02c2e05760e833fb7731198b9c6f17e1449ac07e4f17df9e2e7aff4feafe3816b7e17e440a3f49f85db62462dfe2cabc9196dae4086869e9d6cba48b3fb12b315cd0b9e09243e1eb4b91456bd11aff1257c846e99f324d05fbd7a208f4ef087447fbb2f5183a138cb091343c0d9f601c101fa0f83131b10d2b0ba52d4c41e3622f01ea15f283e439c490325527536c859383bbf2116489020779127666d9edc75802359c467df91db000bc148ea72e87092884ff1e4468e6aea091d6f55bf0f467539914ff6fba2d749acba532162d440031f4bba90804e28e8d32f8d0c2114c636d2d5558c2dee36632f85c443b6fc79e5f41ffcdb02b368c2a8ffaddd8b989f5155ec471e14ee14e26cd36f855cfcf24786746ee868348ac0a9f5fd91813688e3c8cec91a3ac29f1567b4bd8df0fe9f87865fc5f364902ed0733cf9050a6680c896b26d5b62ca7e69e880e2d8421b16a19f3de8f68af4fc94472f7dbb2a4c0b84c3455082269b7207460a58e667f54a72f3eec6430521e294fa01fcd514b4169336975985a9bbe63896bc7559a8980e5e9e08c139381f9db6144a1b2bb6870566c02587e3b8843d2448fb524bd8c5d36b057b343d5c41a7a4cc5e6cd03ed80aaf6cd3c81d454a55d92ca0d60b308f3f6583fcce3ca29f36950ec1967268852df84c0b2a15feb9911723296d116a468764a53ff712b2bc1aef4bb759c56f57fa5006994f5911b2e82721a0cee63dcca0a925cdce8597fdace7240e9bd1af697666b6c514b9c6ceb7da1396b9982dbf1aa076d70d428715756aed9336f730d7e550c5d2dbb50c0212e3862c4cc6643094d56d92d1bfc6bb775c760b75dcce240fee0e0fb8541c82ee9a13436dc750ec7e33b9464a5795786b04ef435b2f587d9aaa51e8fb266bb6005eb471426842b8c36de7100f2d467d58b925156973a063791233d29173e194f7fb42702ddebedd20da2131f8953d95db32bf6d90c6d307ac64cc443a57e6d242c960f0f9006246fa82452392588a94f804814e3306184c670ae1fab4dd413adceea2c5d93b289df99f96fd6ec9ccf09a2f16cf32c8b180d0b36118db84e47154d0323ae8990e31cdef24546038c65ebb926f8c765ca122b83bc6c7df1331e36acbb34ed07b1e6e608420c4a1622cdb50ac4c1ed4b918839a47a49bc85fc315884cf412aef372e20a62644d1a020628df51f8e4236511d23a39bc417e67ac39b907d32267b5886904d45dd10750fbf5b23255642a0e3091629c80580b05c99a75246cba4f053f412a43ebe3236ffe39fa4e1e46d4ab4c71d0c96edcffc7deeaedf54f8da30dd8f357b4c4fb68bc7c20bd3adf14af6ab16dc575d64e9064f14d8a686272a6389fd6a09165f09296a7d732c00938dd0e713b1a6eddce4ad816e481f676f9441f18eda0b4fd57544e95443f0ea0bfa47e2cded0e063186d5347489f6e5f1be548964369dbb27fb11a33e9778c395272a7a26e9702ffe790a83d9f6d7f494d627e9638b34db10e039212a9f97314356ed2dcdb882424f96376c93b4db1e08af76cbd41546c985b93c0f02616751e5f9070fcd430408dad2a8f8a6b9a6376dd9831870ef7f557efe0355fea95cd5dee1dce4e9617404054fbecedc840793378f8459477df41c22514fa5585c5951e56cf3ed040657213787582a37c399d19143987f7f700dd529af94e356fd859a6d015d7b62176aeb27ae4bdd78d235cd25334f33bd8f892c3c2104b414bfb1947420c5d5b4cd86a1625ecd67f915fa6bc3c95ffac0930abd134805232a6eb8ae5c2a11ac3e1f1fb0736b7f393a1146d8d18c78f0430ef5c7f58cde0d39844e8462cf029576a92d21082ca2ad80c067b0f9f5bedb80846b78dfa9daf0244b8e81c8879b4832d54a44edbe45a4d0b15758c5ce8c9420f6852f6139e9f9c09746acb290da662f0f1c4c352439f8b3823baa07490f68942ea0872e0121dc350916670d8d834205eb9c89576ed6b1c48bafe241d56294dbcf8f7079f8ab21b2c34948400eb3f53aa7bdf52e83b4a5e17e92f18a3696a171b830edf9c86f8b13596557ef5a70fe3cacc1c56aa6ab015f6510ec7dacc77ff642ee4955464f0241a8a75b5bbf16ebddd295110ae57bb63e3e806902baed60e31c649d4928c8e4f6283529330a0071196c2529e77bf2e7ef210357e3ee84e8098915fc509ae2d548fce8e7c81a058523ecfbb0a6c224be9544afd7f8bf32dd160553ed1493fb64b41915ebb2bdc6a1aed6d06a5ff24ca2259c3107912af996e4556954f8b3f9791d4cfb5f6da2cd4657ecfcffbec2c960f548f19f1dbdb954f593f5dcdc5ab9f5c70d9bfe747892deff379e40c91deee5a32e1df22c6bbc5208bb7c5da71f62293343c849057c586a4a39e91916d97249f881718e4ef6ba36b6738c55d53e4cc11f1a03bebfede26d5b2b0c6607e97cbbbf64a3f6b4fe497b8a4146f52c96f661c6b85ba7d084fabafbf201fe475aeaf2f057c0f54dc6ae7482043623199fa20e55704d673eb7c480798ea2034e938185101e2846877673de0c13ccf8de57cf0aded6ba321ef0f6e9aebdaaca6c38ab86d579024fed401e91cf22b05b04807127d8faad00c149ad3d39ad736ba6797d60bd59cf57eed0c3823bdef050d4e058b1da3937d7c7d5491649362544ccd2f85189f4d43fc5c425ab891601494ba42391dcf7e61b84181a02356bda7dfe2599ca48d61c9705537cf3b9faaca448180f8dd5a149548d834356e2c320dd764ca4cf1b8895b484cef96491c230b4416729968b727f34416c272c18109b03a80d462a0cfb0770ed1e829e08ec32ea6af7910afd59fd92c506935e9a8d6638f8cdcfff464a55dc4f22b75ffbefedab7488b6a3fa36744164512bc8ee5660b769a67daa9ce6153c6ac841b665c3ffea83568ec7413fc9b2c6d142e46f9e2343898b362662fa9df06fabbe88194ce909b09253184d9a506940ba77c67c03175ac5958523fb8d2cb4cf66ff5f809dd6c806a0da67e3268c30c250dc449f98d23ea165a7d6992ebd5eb920412e5cd9ee571a2f83ed11a261a44afe888c27bbce8be9a7bae200daf4a5da648f7e07d9c2114f1e0feafe9816b504333bc04c380d4b61b73df8447f7747a8fd07a87e2d8e1f1b643e1e292b09048b27c5f500b28b5ac1dc22786c1b3f4d3ceddbedba67cb905bfd492f5e1dff67088a1b16fabbfdf06c2fa54ef1ec111b5f41be40ee5f749d8122d2d11b54fc17f15b7e22bf78d44a1cf44d6a1293a23b28689beb6a00b571fcb4f5a1b37e1caa1d3d16554cca214b7755cffbf88829c120e7514d08bef507244a5581153a88928cdfca1a6db596fb08b9d19e9411bb561362313afbd8fde6baf7e1dd473d90636f1633cf0c584120cdf86ef0cdac922731137c0f2b739e0d28ce167eac2f55b21212661f88b3df29a63f9ad3de982f007a3e91eb3c7d1a78dfc469af850dca256579855aee4a04c06c6c6a7951d81db0b906c53bfc92f074d156cb62032a32191cf73890f74bb1b2665d437723a5fa161fed8a0637083f9dcb0d5ba552d475de52588fdff1da7a30dc90568c68e7d21d12cc5974e50cadc23365b776ad576631f81344808211ea8258b5333f0191b9747f837a6f8acb9c41701625018f34bed769df73d45f0be83eee7147a0bb98b1701468f7d6afffbcdb826bb61764d267733784e205f91096609b7d61b5d32aacea84d797606d601e98dc8542e9cd611e40f1756a0202d9f2712f77c65abfc42e92af369fbe20b29c80291679dcad25c0ef535c31fa8b9c002523d93594658245224484047b9c35dc8d4ff9a0cfb18714f761ab78e5511bdf8c7f6c0048949bffda809985af10d21540e6c8dfbd25cd1af268e3d67ef7f56379443bcd8a4770f958e5dc93cc719078a88a6c6d88a2ca0b13ce77a379b8d49f3befaa48c0eafebadab3722c0149c3a15223686eb14a63cf56c2944c1080469a298eba0654a00661eff77cd4b1e8a89bb94f2e6d28c4e47f9e1dcadbd4d3e5c18a37302e64f2c7a765455c44fa887f242b5d540309913d21025e6c7f956dca769e0925897e3db6535affdf9fb215179955e66bc11bbee1d46c825a82feac1f66bf19f02a18f2cd4b24b45c36ad9f1f1cee482d5b8ebe7e2104a60e81cb4d417e98e640545c185ca2485dee4c6d0df232b56787baf1fdc48b4b9b7a181b70d530e99ddcb5c76b85775781b444b8c5cf21d6dab3bb930b29a0087544f53d3000c5f4ca8ef121acba4f637b49570a34ecd859494303537fe95eed8fbf0fd33fa5395632455ab2ed31af7505b3dadd23f9392a1457d3a95f826608e3cb30c1d9a1037474f116c82fdf2f40e10d1b6851a1e757e942c4f0a63ed780b4b3cc950bb4e47773a6bd02768345dbc2d8ea9b32f255a1b2148694e01fcc84c544cab394753b05d031600a9a4a9efd89e4807f2d3270c812ec824bcf1925e9108a771879c6f465962620dd3b311600fb9dea7c82129b7011f2a3cccb9c28eac731e9a4f435d95bb828c0dff8039acbf20a33bfd811c2b43ab449ae01e1263841fbe9c4136e4917a6a443d632f4644f12c997fd85bb26a0d263557c3e3e1706ee7ebf484bc4aeb6f997ce4f73914ad1a5dd0ccf88d8cfabafe5b464b6aed2e4c2ff6beb488fdd6fa3a6b31978829d1ea3ec87ea775d83b1de15e62c7b461ddd5657bf78a0470251d12680f4e966d1e196164df423ecabe7fc0d1e3545454de5e498e69e5c38dff2547cd2837d2ff41294e9863595f9353c490664b71c7f4e974ecb54e390cabb716a28e04f2189882b5c5c2d2a76ef7f929ffe2ac59d453be11bdc68c4e92a559ba01370da74e825e25ca9e3381701e630f90e429b23f13e78ba674e0297eaa799da32732c30ab3fda4a5625edfdd1eebcd06aa6b0ddc562760f7dff001f5e35ccf05d814f992aee66f3e449272cef47aa8c51f95efcdba51b5bb33522c103665dfeee6233bee766b0ca8e88a64334ca37d5b183340a081efe586fff5077de48291d8f72806409ae942ca290d3de758feb7a90da07543ff07b75e7e30e6c6a7d4084a3c183934a96eeb8a96f8a68501fd8aa886cb945acad484c74c788a0abfc8b9b79ad3dcdc864b7955c470809118393d1230dea62d5a035957f1e1cc13cf731a4d4dbade3c9d211120145043be4bfffec0ad7c4117e734257891867ee5849fa91de4d3b5421cc0b8d0cdf92a8c2bbd4a306ea8f25e98fa30476bdd8f38ce959c9fc1c925937d47aeb3bc90da2d859af9414f8539a28abcf4308f8615a8afb7395e1e664596dcf60aceaa3ca723b395b7e488331a161a6673ed6d2a78ed0788b740dadd82001e1bd05ad5c6bd6d63a35800f59299b65c3b5465612c0a5715c3fb49f95e6ee79c558fc3d9ab58532b355a51ed201ab47b4ab653b85324ba06f7f776987d3221d88646f2674ab7553fda2c279a93ff1b8e75f8ad4327d3ad14371f8274d1f4d689400352448b67834c22cff53059b878a1df0d9696843f5f28973f5c52646a2bb39e5bf2d5fe0dfad120ac9faabbad23e4eecd64ede2c8d05a690a87c1f0276d1945be9dfd65fa6b3ae894a24460b5b1d4446a3803519dcb8868ca40ca571e14dc89a7c481ab3f1abbef18d1e7772b2a8fb89385e8bd6f7ee89629391804a14dc283fa75ab7698b13a2f8e2ea84e272fcc5accbd42cbce7480936d1f066d02cff39efe735323773c5d94477fd2a223274dd10a29ed1bc61a9df5d628c05177ff18a0b6ed31304c970788763e3612982cd33ac330f2fa25ce843caab6e09119017a3676afe5b6be942bee8bb514f1eb20ca03ddddc9046f1adda685e995ba6db9bba6e228691105e67d8f3e256778188da56fc1edb1f969fd909a4ceae90942637f850e70cb7d9388788ee8e516742ffb494d2d7007d586e63d5757f3a4ffcd7e8651eb6d42f377d6233b42b5b028167762e0a2e4e2d932f6ff94f8219cf5c329ad1f8fa0acdccaa73913ab08ad3e97d7b8aef02d692380987a0705c741aff3b27066995597dba7da451bc5d9f016158a027014cd16d149f42ec255773229780906952e45e669185a1672f9da17307c5820fd7dafc4d7b6313cd676cbb4616279d1b10397607ba84468788d057f909338221d4aaf989ad1600c23fb7b120a976a36b831c88022791ba5b831d1c1611517e34c9d554982da9c571c91ffa69e93062e5beddf439b1c912eb0f4a0d66d28292b8700ab5e76ddff66b5989a0cd428e2f5ce7a1fac219576cf1d29a1fa8748a0038b12591d040632d6060fc5f361bd0f972d3afb1b8c861974d58590634ef1a89482b177374e31a67e96264856bd5e178ceb0c3d573a8c6c00debafb5dea107b49225b21ef21b15f7094bc9d48de8945bd16b13b4a215440fa06e676bf6c8dd2962bcc05280556d94c014ffc280fd49aa896e6ab9acba85694aebceddc3c31a4a8f1a5f1495fe5806d0cbeaf858a1e27ed61d15f697d5cfb8a439a88c0c6be950ce4320c9d7796a6c59533cbe6e649ea187ebd017ee65c35a20316bb0f8a635bb416ca45db894617104c6a6aab912785bff2dab7ce523617705f267b7be5bf66cda05b921eeffa14b8fb1b1c060f0717574dd6dc1c8964cf7e23e170131f16f62bf031451086422e868773dd1fa5bfc445360fc292e374c78ea2709714b58e78310e78e4864ebbb5f1a52a484b1e1e736873422be7718eaa8efc60447a3659b5e10d8bf74b4b664b9ae029e58cc2cc21c73f9980b59cf431ea3b1237c84b9d15c680376f227596eb10217e67b312765415f03ea443bd77ce517160fc22d94a183b0ee68d89795c93e373d13407d67a398759532dfa33c12e8615af4aa7c80c16ab14496d4c8a314430b1144cd12de95152bad2a940f18f43abbbcdcac4aa87df6721cfaa133b46580fcd1310ad906455abe2b9bbc8892fad9cb5599b3644f1b1446c7a0d7594c5204023cc87499f8ab88fb7194a9194a38fa339e16561af34520c76d165330c780124020c9fff967ec0565f12b0fc4c4dd3eedcf9679b34bea58ac947cc8e6abb177c538768758e0c68222f00feb14acd128ba6d4b48505f5ee33803d01bd356949c2b465a061a66e12c7ba30f272efd5130c8ffbc7645bf8017252025bec3234c560becf93efb121625d58369658e9a931a63760a3ed103bfb2e684ac8e57b4ae4e5dcf1a0a4cab07b04e61000bc2ee37f1a14cb0e9b7337329745cd82092f4cc8ae415b723616979fa05483f7e86fe49f382b540ab0369c91395d7e7d63c64abb6052bc0a567f9b1dd02caacbc5059ecff0c481a9db5f51fba558a77619d79f9940303ea00c47383989566061be5594e45b3488527032e0db7bc0a18846e2dda8cd68981c3532e471d1302e0481b8991c8733b641d08a496d07c96839b3e50d30ad3092294e211e04ddc4fdbc74c0260f9436a85d599a92de849f37a0c9a843437f546be5f16e4ef15d704aa9231bda91060c9b2e00f0b295bd54833f257838208f5efbe874148a307601fb3cfa336bafd6549742871df9e2df87e49c61af6a64b2e115f90ca3f6d8f1245aff7df6f684600f9b888a3fae9fe391ee6d95e7cefc4f421578bf6b19d3bc0e16411cea8773f3f4f0abdbd366a88f48a3c00ea17f58422b01e86b59aa532dbd6fb206117eab356b23a3a97437f845dab5ef176ba34f5e1d2a8eea42baad87a83d03322b7c436e1239ea73b9f80ae93f69fe7f4e9223d5ebe22a26cfa4008f39ebeea4bbe2f3f84d16e2721204bd2ef1c0fe86eba46d517755c8a79858671a7b16a456d2e35f482a198089b1d6747fe3aa20f2fb691079412df6c26c7c3502abf600a05ed521402cc809b532f5c677a9c1959fd0ce2eebbdb6b9d53de7d951731e33ee6de390ff61d120215d30c4381c8c48517b6f5d55fbae65deee2447b5a8397fad9011a2c00c9c198f5f118db2b9a8ddc7f64f8dee4123b1f6779f33c13f2351b3e7fdabfcb91d49bc15bc9f09db83b9cdb5850ed632d9ca3ad22ddd661752576b16a74f8e4ef9ba4e53f823b7514bd64e53f22b8b44bfb33ea1249a2bede4fcec04732c15af4dd66196e2441fa162925d31f99919e0725ea0744d8f921af4f1b2cfb0cd4ac29308df7623b64c7cdf5010596725825bcc7243e6bdbf900d8607690318150efdb5bb2aeef1669d676accfc181e5780198b98fc8aec3977f6e243e75bd4612ace10c91ffbf85b0b98999dd4a14b243dafa21e4327c6c4e327d8fa750b7bc2babd4241504d8d3d4404f393c6742f12ab417f7afb100c6b41cecfccbc1102da9431ed62b1cacf6673d1e36fa6d9f2bee5e4300390c5275d21c868caee24ba2879c916d7e72af5b32e42e5d0cc6522eda40eb9f0f42bee62c8b819b634ec0f796d7643d786e4d8f5a9de1b385f562710c2bfb267f6d80a5c92c157171d01cade7bb74151eb06843ea15d236f2e5b1d3ad84d29282d4130157512f96790c61218ffd31d70349f7792a3b299699f109e8984dc9fe3f7275874e1bfb8c9edcaadba41e542b01853f6ff05b11e287deeb17b77b92f349f2b39f41d12a5ff733e452dad3f44f606bbb39233082962cf6774912dd98f44a4e814f7d17ac8714a434e9c056658cb6647579c871e2befced7231e77d2776aae498d331880c1571c519355beb1fbc433b5b1fc25726638fb59e52d403dc65dd1a2b00f1c4356fba88a4f915a627543fdf4ed527f5ef28f8fb2d414250868a32ba385d4bd92aa699d5262d8a81d81c4d72cd23e4cc6b0a0abcd2e1096b03750d54e405f4fba572bb593df349d8129fda192227856bd7357c0d101d8b2404e5476b52f66f0ea18688c0c293daecc054b90a9188016e148b7324686519d0995c5c5e1d60272904cec9853319ade42ee029a40335de7894729244fa532940980350bbfad2dfe64a50aa3704e47eb4886a2ac580d1a9210f834735d333dc3e859227081fef987e4b06b73acff4e2c998956b4334002188050e08713f8460fc9f97f3507fb296cae4344a26e92a71746932915ef1c80cbdd68802ac981fa422656a1a0196d7a1a6012078a467829bb4610ceb87cabe3e55a9414028582bbc2ab80f5e10ef35194bd09e01e712b26e39c23958604fc6048af509b8b6c6954cf81977085a2b79b07e23d46c54e6cab55b5177c1265989132a61bb4e8e9c07a40c52004db49189c0e9df88019ee8f738d0182f891d70acf2421932bf4a2ffe1242c313fc335f075a50c0c26bc153faba4aa9c0ef724787af93ed0e53a2077783165e98d7debfab97b42f74bed716dba237ca9e4d0d21cfa6767c5ef8da682b1a1a70010fb309e42b0bf038858b61264ddc86e20032f037520d6634ef5988232a13cc08afdda7b01785167d29be619d52d7f4cb0b9fd47ecdcfa34ebe129037e63ca841f16140d69d7ef47e35ae63c16047922780908e8da1699b8dd68fa433abf46a6f9fe9a2c764665915047e0a176e2530f48d706ea618daddb70c781acdcb202f63b383e7afab0aa88cdd6e426cf74a9960f02468521ee618ba710501148854b9ebaf18b40aa21e169b0ab2d53c66734d4c9fb37110475a001d91e3f65fd62d6b5f50d55b962f9f30fb0779905bafa1b3e9ab6811c42168f35ba228dcc5d09c1acf510f34f5a974037c7cf1fcc5ad808faf521092c782195d4144e16788a6b6eeba58bdbf636d4e78f21d396e016438b22c24b801053ad56038a78e55c7bcbd6c85d4d6a5ed2d9dd24a58023588b319c644bec882754d022360a4f48d59245eedfa072f0906190e45a7dab51196b383eaf5b4f89fd3a061cfa64bf1a015a1141a3122c519ea836c5db6a039e2fa4a9d6afc5dd9e1aaf72486f976409fd516fe7f08f26adc523991b15b4e86216a5efde6278224dee593f66ad369973e805c610fb14f781ca5dd2a4fee95e80d0e1f91bbac5c1c132f87bc38f0559cad7c866d47a0b1ed0e6f059936db367cbe1f37519f7186f6e73ec9ef2bb236eb205fb9414591573a68f764634ca766f5b21626e4b169f2bc653ca7ebf368cf19b754ba8af2df0db0685aed34b64b950ccb3d8fcc15adaa6746d518fcf2a7c871c3e94207ee710198287dd9af9135ed92034b3fba6ad88df4d3ea308c6d69f18843b13f621ccbdcf655ce7b00ca38275606a71c170bfd779be1bec5a7d4ed6823466ef480dae4d9dfcb9c792b668adcd6e2293312370126f175d98f312ceed7cd6eec07b67c3cb323fb59e158ccc89714b217e7f1b764c4bc2f1e34520f76f554e271d707d991bdf0cc24aaeee2543aecdc1b366788cfa6d1be4b26bf1a23231cacabc156b186d4102fde0ea5ec6c7879109fe30f2a3796a6274488ed41c8df8be66959e6cb9f46fe26442fea71cbf5df650320e8f5b6f28565b0f9cc7cf3adc9b61e19ad8dc2df4f3488c831faf16f3805c98479acbda53b345cf65f6f68ce0c238f0c62bfa45092dfc8c538da38424de2ab6136c0f491684fadfd82c3071dd3f6db7f5d8e759df162fa825c55e275a176fa7e02f5b99f1c6c0680687b5322310cee872c74df41db6c09b8b2b0a2ec46e66b86b7679ccc16e2e58870060217b5dbef698c24ac93dbbbc310f61fae1847bccad2efa466ac2b24a4116c066738a520d09dc7f395f83b8f5b2fdea83d3303b3f5e309985de0dcd7985dcdde5fa952e72e1fa7493b488258f102586fe83af704809606f566c1d9d1d657945e0be6d8c007f317a1d4b4a6150b58aec59652f0726d278e565e779ff9d9d6dde78e274fc18c3f9611a9ec8e47edb679fcc5c7ccff5380fc57fa73628167eecdff461355e92249bf8aea69fe3bd436fedbb7184727c9c03955a93f1568263af469448eee433a9c97d96cb6a791ca4fef10180149ce029f631172b3705b4482f4e819b6ff0af959ed6fd5a4202381b90fee01e3c0727451fa8b59ca140645a2d96c6a47933ce97dfeb596b343a57e52c5024645b8232fbf83907983608a5976e2aae780d5eb9b0baf0068da7555ee0a4862a9aaa12fedc4feac129c45e5c5a8072b36d28ec1a87b6d33e573dc160e5005311e9cbca2388c6ec7a0dc9381f85d818692bf705d267e409f6ee5661d993eb60d5844e555d0941530e696984fbd3846d2a95017382365682af1b7c849e4b57c749898a2f96443f2e61c95eb3d5bdd89dcfa59ff7b1a5b0a0643fa66a93efc4bbbfb533cc946c50f1a47aebd6bd02de3309456a377b2b8214a8b6f038990a10abc478a3a2aafa09a6ca3095d6f81b71a0fd895c01effd24344bfcd4ec80de6fc8550701523e690fac777dba9e285b044c5a6caa5a538e100a9d3b68f4c4dc09b91811b6932e3d711bf1f4c7b4e9111adbe88a17694976098aa52329b152110d04418e4f1ca6019d37877cc414229907f89d7b41b5db2d73a34e5dc1334f0dbdb0100e2266628fe34ef20eaa22867f1f7de14501d4800b5a5a20fa8c8c011aca4100ab5877dfd603e569f550dc652e86809d67a910bc9b1f12ceea27d0283a8cf4532a05ef50094cdc2755f3c6e55f52e666b25de5416b7422f3e58802b73c15711a0ae76a4e93159b9a70b2886bcab6486900f7f1f8bf6334092d72d541e2584eecab2c13715e78eeb8682363d79494e19b35063e93db8dee259a2d74f49b6b12a6bf67e015427161da7f8e749c8447249df38d511168d73f64f808cd7d4c84831506131c688b783aa824138df08aaed7b7e3ffbb70d9173731474df08e94d0a613672a4480368ac56c7ebbf9e5b362389a01f99a6d9fceb455921d847605615a2e5aef3930412d2753a4cd34a147f07db399ed2cc706f306d86e2e3e37f4816c1e79e74d71ca5b4a06db75b7c5ae72ae2e83ae92b8ae4232f0f71f19d69d7eabec563ab7ed48f11e2f040daf35dcacdb5140fe1d49d97d7ca335c35901098400a548bbc07fcd35a1fe7a3018b9c814957aa10c37b6e2325028a704866bf70787b7312c63cb0b5c4aeb7401e73795f23555548b16a76485f83ac7dd1c898bd28317224295326653d694de98e36373039eb6e107d74632cc34bb548a24da2532aa591ee89e8cb30a8a3aa75e75a44cb13609f1e036411ab40eb2f7e96c2b9e715496173552c9139dad9712ffdf8710647e88393afd42f5036a9767775456a22feda604485aaab67091323a816d2005099a7f7c478ae38a257bb7c1f5da10fd2ed8ae44c8fe55ef67bda77d282df52776ae31d2dd5ac37d49317d515878af2f3dc7243bc5117a659ae8ccfbad8568e686909ebf354f5724feb581c53b962238fdbeba72b10d80f2b59d45c5c52d2ab16572c33ba1c6fe46ccc53c0e0177866932a50d728ddf44f4d29a8a3f8ec8902bae66b5be0f8b30971a0cc38a1ffe8e0aada532a8b5659a73a4ed04dade0f4afffbd770f2c52baf5735049f10576ceb5edad9a4475d6f06da0149d8e588ed33873835db86233ecbbda16aab1591ee6c2f63bb0fc9474db6976860b5e89859affc396363f4b1636338cb2434a05362b56e7024d001c9c9549034139473e300ea93a65c1d41c362e53f90feeeee443339b93b502dd3b21063ebfe12e8d5f4ee663e040d07ed7778c5829391885ff0c1003fe7d5826b6f55b23d26054f5b838b96c0f7c41dd7d5f0ac51ee6eb75a6fedffe0475d045a1b599802cbc1c2f39a8503f9f6132e7b0440ea849cbd5d05c6185f59e43ce1405503e78eb1421dd743100dc38ef06234c4826ab26ae2a66601cf6c6f5a0dc0dd275713b52599aedb4cb98cbd4a68e6ccd38c1f0f8e1f52e0b9f0caed2f44a42d53f97ac6b2936d2dfd5bdf669e5bf2f0aa4517bc97505c7d6f82887a7bc194dd92e6114633d821a62801693bd7b0808da15ea9c9b11fe48a99f8f85b6d1bdd8698274706057da22e57e798bcf26e48a20f719c08a6fd1c4fba03d4b59c2a1f311ddd44b459600ad1a47ae28d7649165a1ad59a2b664e9d455cff5a99d62caaab421e6a3444d5f52158495b53aaede0e36870333724d27c5144ca84307896d93617d1aeac0408fca1e48c1bcc3644efea701fb4ad88d7f5c4a004feeed856ec912ccc13b1efd7664d6f71247128e99ba866fbcc8d22c99ee9d4c82d6531921841cec76a5e48a6c73fc9374a0301095eab30c153bf618936158daccccb70e1ea64c3cb2abfac7eb66fd5907653f9c4d8412fe3ee80094e3d3d60a444a9e4dbec8886bc751f9ed2d7b865a405b786499c4e7631e5d526211cf42d3a653fccbba2142f0b4f2067cb03ce1a60bd9fe5486ad64ae26acbcc93f66fff1f684b34d4cdf2cce1243776b40be639449637da151461a72813891fc69662866250ff673d09c2e894021092a995ca21e788fc89cf324dde952f810501a0ad309112ec933f89e0849c41279aca4ce1770da4d6284378e5c8a4875b5b7ef18bcda88acfbf35b066d91c87997f69d553422e303dc610ae5cb2ad9b4c22436e7611828dff6a9d10ab5ad2238583802664be7eb888c473922f5628b657677d83c113ae6cd0a0552efa04380cb171ed3fc7d2aa19917f4f0b75f77290deec91df94ebe590b171e4f8dbd5dacfe9e217b665da12cd0ae3befc19d38aba5a10e2e7276d5abda456d154c54e93d9a2d37feb972d7efa2ae99d17398623d80563d53059b0526964dee1fa200547e5aa6558c5e97635c9fe561c4b610e0f1a99a907faad3be5f2847fbf6b21f04cd7b2a20d8924af950c8879c57d951f6d60fb43e785930c635a75dd8bf1f2225ab84bf51b6c449511014fac30d8b60aa8e23e9cad44cf154d8dca743d37f94c2aafe66e44f1c174b33f790d6f0bdefc4b2c6b6e27ca831e6d7d7d8d1514224255c1c30e4fe287259901b3c14d50abcde2283598f84ab65eb611364803b60b4384e8bcafb75c808aacd1b54bd7caa9aaa517d5d531bac53342b1c4a46abca1b2f8f1eb6c71221c4175befbe77084556d8683fb052b87a1b3ae81faaf5175438dc7c3ebd85479d213b014c0a3dd2d246147bdce85a102242a3c1fcddaa78df52ce82d07af546fe3365795d1e4cfd02557a28b33ec7f68675d2192cfd62a6f0f0d48fb30522c358ce088631fb0227439cdd94b5ad0fa41004c92aa9da7988b4aa5dd29cb991397db60e31aa67f00bcaa80f90900c21c83e658189f1a6e14edb314f6bf0fc9d0a172043195c529f90f92e6ab15ce31a508e10db585656eed7d9688bc1df0a6a344a77337ef5a71f5e297ae8483e1292c9683894e46b19e4e6bcf53a52a7853788b687ea1132a6d22d13f444a4919ab2ac11d0d00ba77ffe37f31e289fb7d41d0d9e586ec788f6f72d6e9556b1246d74d591f5e5216ba3824877af0716d4c59e74f797d565a575a3d97d19503dcd5783336394a1379fa8115ceef003709e923e294c99b40d3feaa5ea6fdfc7e234a0fe6e41404ff9595c1c2bb4a160babc236bc1155a322f2cba5afb93d3971410ea274c6f472f98804fd91e5f694b8d572da6a649a2bf1d39ccbfcc885d8b014c4d1a2406771ecbc788aef8eed3a9fd702b7470b3e301546b25a0a0ca6ef1d6b6b6b4dde24a943201a4215a3862a163c56bd9dede45bd26b23b9a1fbafdc7a30844e6f4a0e67a0e75281ab4cb05e102984fb108326671a5e82a52dd9b6efa5b0d0c1ab9a279c188ae65d4ef67fca5d8452c61fbd40f1be77229ff4f834fe7094d394da64af1b5b38159329f76d96d3459a9786f843ba739036fcbb090911dee91c9b3d2012c0ab1d5edd66536929ec08c7c1528e92bf94fdd79443737456f56db82469813c59f2d05b8772422f16321dd86359d06cbe8180da0199e39876d960d1d1f1f0032f88dd5e1593e9f4f4be452deb136d65274bd761f9904881ca46b0417c3c24ff8c4100f9104e932d0e7d59a73d4b18a3702b102dd82dc56a87ad7778bef242cf04dd7688488330db2fc69cf8da016ee48b8aea745b1244c915187d01fe0d5df31318810c06435f37d9fdb56a89dcc08623e8a44aa6319812a0a6c627915a4a9a9fd8536fa45eaa17440d83b64395d25bfece83fac1a2cc07ce099f34811918e12281bf8f8f85c0167052ba2db6c8acdf0115b12c8b09ea612065f7992760be6cf60266717f563df501dac0e7c52a619f3976ef94eea00d207adc6f561fe1482b45e2cc25eaade555601faad2ef7367579412e3b60ee1951657aad00266ea205db4026e63929b13df719d0932be080ae00624cce9baad12c35ed98ac2b39158695a2904d67745e406ec99ac1988686b442942b73d6b6afacbd229eb1a0292dbde9fbadb21ba001740e44c912051c55fa54cbcdd57b83a0e55ffbff1bad3025481ed07bb064f3cc75f801ad8520ecfbd7cb4d6609849867ef71c86ad4cdf757b8403b1f33a89fed7640f7d690765cea3061145c86e8f6757e8bffa4ba134fccb166497880b8bad9c547630c5cc4155801f8dd055f618cb500acd5bbc1d873ec17b0ad5dc345fc11a6a436a10c3a9f123f453719d12a68e706e02dcd1eeaf32a3e65d60b3c3c5b76cde4d8b4713cc521e9f9197b08e7366b46babdebfdfef2bcad55b10a2b4e68d0bd226b3e55f534c346a5b3c160432cec2e603c480051c807b5a9215e2ff061bb6d9b33e8c7ed150f88979a778446a3c6201e9f5420e28e177d276f1cc6cb725e42079d4860c6fd0d55a676459e4c08d3c754878d749046b7d36fa354a45b6aa9a2b3c2a9d10da4170b0ddf23a280d550d0ac0bc40c27645081ea3109bc9b8657264d1e5033594b562867123b2498b063ced4ebb8aca4b349beba928a92007b8b057cea5dcbc2b3fe20760602f233f9cf75370c319e3210065fd2419405deafab4992eb5b78bcecdddd17b5323b7847469015af8e32494014646c42af34fe06d66e3857f0a9131517cdb34afd74cdba7a7453ce44fb5d7bdaffa50d0df7a505782b91156d98fe982008d7c193179f77c872852546bcf664dc36e7d5f5f73832bb1143b8f29c55a7e9423c5f1c794ae3b14d8eb45292413bafe44668e8033e75485840078dfdbd99dd3190557bf245a0063efb8c2762ab845000a989a630f2fb1b21cfc239c0438fac1d455b17f115f17980b1a9587eaf294f9b368ab193dd74ba2c977643019c0f3e95a3107e082bca4520055beddf1264853d6f9389865c11f3aebc13ac07113643fe4afaba1374057c2454b04353bdbeea4351979f5e7489434f568f1fde74dbd487175df87cd6dec09d0efb5ac995a90f113823195f9b9f6f3b119382870daca839166689b0ec8db3f3a9914783e51831aea930178b626b16362f4cf477d569ea051fd0288995121bf326a8fd2cf8ee2432c439dfc967378c36f0a4050abd18beacdd119e64b69a17416b49997a44d37e13e43faa4063a428e59abcab6ba6026a5c4bca043122d84987f0dc624f7df009235e50251524a63b8de6da20316e97437514543d6f085c64790e3df8bd73ef5b6e50c4151945073fac68f163354349c3fa80e93d37aa598ad010402222fa463cb5b6a4934c1d681317feb239830bfe510f2e8de1b198ee7895a1807ac4718abdfc01a662739e61664711de1a0d725349ac9a6e02200670911fac43a13bdb7a186ea166642393f2c13b4932425a7bb5fcc502b38d8b09f7167cbaa5480e8921fa50636b8c94e28cdbc32595b8dd41d9fcb41e2cff70c08cf984b9ce5bcd68b678e3e24cd5c08c0f0b931e9999fe01082e87128c6e859c21d86067f314e7dfa48769e17390551b1beea339c2ca851a6eeba430f091756f377234ebf9685df9d4a373f9b9203e649735a6928770a434b4caf116698361471951afdbed6ba8c8d96a5f05d5ae98699b22b86038d2c7f047367223122285140d84ce131a98638460d1045f0f8d4b833d05e952362166217849a9a737d84f18dabc197a0a86b43b26810ec77066260ecabda9ebfea2f269d94571ddaf94247df86f2cc1eb40d2e11f56d9bd467d6a3fa2a140100c9d18461c6dd5dc73d9ef8a0d1780af3d8290d355df278c759c788d9195e7f0608720f3f0a5883b9bf2022fd690e06d5993f9ec602e07775164bb537cdc3d093f1894da6a40e76ad1459d426692be85cf5a6f6e343ea42a168ad851c6851a36773348a8e813e9bd3b9f14ba127da7012def93f996e9f4f073a0330294cb40c0bfb09cb5ec0bb7bc2e0526913ba0985464cfc16b5001cd52ddfed044f5a6f60eea5bc30973b726a8ee81d04da96915413c955007f04f58ddbd9ea08abe8c55a6aad569f9644b3a220c5a38e85755ce798adbd63a8501f465dd1074200dd35edc3f8f4636ce8ffbd1f40fb8e2c0ae020bdecd528807d32d78a3f93394f2b407129d58753a4e6c88ecb02dea713097c224884bb92252bb7e6060b187a5adc135917c884d90eae150a4bf9f2f5625a93bf7a11811f725d6479df98e7e74fcbd500cb0b50ee6b7f6268c7c3b7aad73905ccc65d73e4af27589c503731cde6c687c6f4d5859b419390cdba96addb1cd2f7ef54a2f51b1a6304fa8f8fa3f2184ca8a94545f6a0c6436c57dcee3f2d2c5f32b78fb15231614d45dfbf2b1d43257b70cd912cfcc690e4f7fd4ec6b7b2d7e93bce7eb1aefb2e8e2027e482cfad679727f4147bef9440c8d263c2248927617c166c3504e146f51c40b2861fb815181b1ab1ff6b407b4b103c03ceedca45a76361f5dd48507a8a914c77fb57d4bba1c30c86f8ae1e0c86a759b3295073eb88a46be3f8c12ec583aac6dfbbff9595f87cef1c2c348a9824cc2d1a39ca6534a0e8856a43c556f255d1df7b49f3098ca91b235c6d2a91398ed96a8a87dda0ffba01df70d7c8fd5c68509bdbdbed97c935e2c72b3b301f787191a890cc331b8867d24d00719389f25edfe055d4a7051b31349e88243327326d7bc55a63a3ed9c3adba3c779205af1c16fbeecf26d8c521a633f8c71f562158479c1a383a30a1ff1681a495f2deb30139bedc06c73c27054f3850befa9b0180ec1f920912cdaf466d06a93dec0165f39b9ca79f4b0102b975cb77159df4971a224e12be4089bf4675532527cb55af369d39de9c0441d4a00f781fc1e2762ae2dd7a2643ea7045e49236861acdf4099c85091512c15586c29ff1a2e714fe19713f15cdeaa7cc56ee19e65025db74c0fac7f72212ad82e1b7b12272440ec12547ff1cbe7e3b2ffe637f3632730266917fe8220d88a46396b6eb99caeef4449ba925ab31cf96fdfff40ece263ebdc3fd51f4ee66b8f0c2163cc8c555b8e3a92e3658a0afd6f9fd0bc4e0382931c4eebf3e5e5ee77cb241424ebd0f2600f7a80110f9ab01a7dd549d04453ed1cf2c6473954565f7f88290099b21a577342d59304f1bc6c2004715f43e90729c83ccc8e9971b58fe4e66c2177f38e2b1d0ab39301e6752e036ff60ab525c29c44dc845e5a69816ffe2969569815adfdc385db4193fdadcbf247ee4727f8ec0a3daddc0ac49d8096037075f64b6dd89612906f9590b37897a0a81ff2c1f41869c28eb021b78a19f43af8412a19c38008ad37794e9b0997eed6b0fdb229ad6a1b8bf719d759e2c2b761ca5547bbcb26ab41ded5b9946e11c034557d60865b0edb160a3af2b4377579a1151a5882c261e125b126117e1612a73b19b14da541369190f0fc4101785c979d3a8068093d16dc534d0f7c8e8c87f02b5ee587c8f5abb8a41b5d527921d895b2f382167bc3cbbd94302a630bcc36d5c677a362a801f6755e0fbf59315fc97140c965f2ec1f1e25dd6fd9dbe11348a157be46895c8a70a04499567a82fd0dea5b676fb57800a3f40e9f1c6f9bba063ca592c8262e6b42c41162c7ed34da176eface7fcf6e8262269328e37b360d89254ddef71d4ed7987104185b3972e2fc74b50a58f8c86091314e56d87843b800bd87df2ebf91da8d1a3b6ca4dccb02adf2a6e9268f121e7a1622d256114ebd000b91f84320d74d4db18e0627878a82a30e01739ab71d4e89612983efe6fd0b5c620e3d41d255d49c1d32905300383b847ead2726476022de8d91e306306e21ff7dab8dc9ec0c0a570cc525664235182692a1159fd7f837cc146171000d587da29f3d79878135901ede693e5d2ba76283b068b15f33df6bd0f1f09a87a62c66c93215003467e2ba906ce8464ed65eb1dd636dc9d0189d62692963879b6f86edebf5cc5c6da382013ed6fc1e53806305b948b69354ea080a82c017fcd23f1248aac69440cfedc94c3c36cafa8148246471a46c386c55763160adb37e48bf7534527dda5cbbf5524ff8c22fa25f056111f884a222c0d3de454dd24989c294c81d4b85ef56d4a7011e6b6eb9009b1ecfb0c6457fbe55e671da0a1e931de7cc6dd53b91f14efaa5bb9c59c2be7328744399f1723f3db7d8d224ca0803b69fc3b57544d39c61d07ebbbf0dd44794eaaab827fca6020ca878051e136b5e70d3adba8f3f19d0edfa257d14b5c481a13a2482dedcb61b71cb96f060cf4355f4149bed8b87da5f1e4f162a883b3740caec3f671b382ff96d99e0afd4ea93c13204ccba5cd7c7dd2a97c43a17635af57d2b596b7962cd205d122744b74dde71e8305704d68bd807b97ce753cd460d5b69df40c9f8395b54cba95ab1a9620b5c9b0771bff50fd94fe05b79d4f33d39a2123a534fd53a223fbb61b325551fefbe3f21d4e1ed089f1abe9cfd697c0f86fc61b01c7db0f80e681674fa80f2f62aaa97d0da7e5ed01177978f3b757ce9e22e0883195fc6a213509f51f88973f16cc7273196f54a475502fcb785f67d389549dcc171b270e0db4bbecfb53c2aa9f77484652d133c621748726914b2b3b5345f6df0bf69f84d1c227c0c45e0e075dfa10310255cbf5b0ddf674cfd822cf1e08589b8a366cd127accdb42b362cddbcda2f2996311f29a00b1ce8f2629d68f743efcdd10a793f7ff5aa5a23dc2fa59897d0564b058a95b76f4456e4f66dfbbffda3aff39c8d271ae2fdf0e3bb893dae7101c44d381010f6d62ad364a04a87660755e66a4ca28ab27cd2103a6cb840e1048150b013348d9107a318c14cd3c3d74954d98aed5b3c4299c74cb184e8ecd6bf4459c43c59d620b5b1e4911da91f4900d4d0e7493a9eb74622bf1c62c1d1bf9c91f619eab53e27c8cd3db7c93d57dad9848de25af3171b668223865502ef022d34621502fe382eed17af4d27347627cdc2e9bbd2fd727fdfe400413e06d048876b317d198570f517492df94d7cd48ca62622c572369f1bae0467250e1565e9a8dfdf11d734b0b1b032b20b8e282bb37474f58ece2b8f9d8a4f90147f4359aade667a793535ca4a2cbba08e0d09ecf6df48081be5cace130b436b1da0b7d38271b41f7274d8047a3b6d31b2980f7fb4c9a567cb5f01f52f01e734099a196d459733e1e8eb9d8a7e24501471b91b3c944dfd3820f7903e1ae88409e8aff4db26e5d009f9371c2227c44c5fc39fdaef15ce260f0cc4f3363cd99c5403f17302890e7c3b2de7b51bedc6e681b25c2e712d3fe3b9571c8d7e2ed37ba15b119e9a63b3df29943e5598e848ca69e672023ab3b526c90f05af52e0771d5ff133e219fdbe803ec045d234de38dbaac2057c9ab6943b22ad4ed3fd1193d71b690c0b6b43e3b6d780c0ac47a94dc96d73ba2433ed0e8ddad8160c7dd6e7b15be16732ba91bbad525e7daa33a5853bd71c55ada8e6db2053de178f0f97c8d65a83b4f0d461dc1750aec9ed3e4a9a6429aa550e68f544514087698f89ad2b2d4311de44d4934f36f55365091bdd5983b8bfcd298256886e10163cca2feb579a59d44af7fa2a8a8c478cd1f94b7324bb34596ba9d096c3524ce063aa56c592dd318adf4395662da884c9634c6cc7a86dc1922fb4843fd9300b648fcec5fdff1b3c93de34739545b2c09c9785721d731e281aa746905f7c221002d6c0cc8537bae1eec5ca2f28851abe4a9f864a35a68e8ec64f4a62d4d85158d66eac19f2fb110d571d6d6a9bdd1d1c459ba819cf73de9c9e92bc2af65c795c53aeead455684f174e29e30e81c4e6662d34699717e5f8c6fe8554a9a33a9a62da54771a176cd63e179193cf8579fc0dfc208cceea7ec63168782ef03f992d209e9b44dd6d3a09dc858d1ff09238b85db74879c5c2a2edb03a9ad84ea8c8e9587214f5b32d9a491a62d4461e09cbd638495b77c1bc40a86f3410fafe0939f803e7cf402b098e695a9bde05443837524b39d806d5827ee99f74d577fabdabdbe6d4188bf4a13b97449f08da348eb5ff17e6eb72439c538287ddd688bc05360ec723331cd31ed7fc43242bc1b10e8791246963cab009d6ae06314eb5adda5cd722a0f076439fc0d12f1531780fe42066107128617798394bb45e1971b44fcdc8bd4df2d2b87a1c78cab6c9d9f31d85478b72f37e51b627ba16783998e010755f8e9c2edb00dc03f4bf66014eeda5ce6405e4eacd2ed6db27ad4f96b5f0b4d88db85add3c3ec64180b92ea990ea3c9793a91d229402f4e5116a7dfd0dbd975cb7a44423a0e38138602b817d0c3c094c487a7d45786d4f7cb73c302cb6ad8559f302f6942e9dc1d5dab24ea17af494f9059e8f669731d6598060c05d38eb1d547ec3c8bde3d06bf50121f59162994633db038948ae4650afce1cd4283facfa7ab78b4247aa7709c59039775f552d596f9b3027a6b97d1f0a2cfa911e0c3c9c5d454e71bd4e5b8bf0e56ac87e91593fef9dbdc2c39d59aa985c4bb7e08cfea8b61856ea11f990aaf2ca0ac05a3b4f159ccf96910577de32e72e185362497272d32d92bcc10fb71a6ea0e8ed99d2134c4f92ffd2617d7d232e1287d62c1f68ac4198c08b0088c05b54110646e194d6f8fd95ba4d29c8f46663b75e8e8e0e24f3c7bd14ea87d91717a6ee7126748dd57f9fb3195c53b4c559cd8158cc9c00757952c9832b69632643941d7a1ae21a5bf5b8db57d763d79129d735d31eef6a62831cbb66dc9f31b7ef5e2c9fb18c98805f4da26d8fbf2bc3f999c49cb8c9906bea206f81235d85f34c3c5b38819bbc511005af7ca4cec51d593aa28c8af486b61d06b2ca0eb7275596b3a8410be5c26018f078f167731b429e5f9e1a667c2ec5f25dc906beb44da1ddd861ba6f27f162b6e5a6bc8f8f3862464073677566d805ae163bc87be3ff90967230c9d1c3937c9d5f0f56c3ea7f9cbf57a19abf8bc223a7fb9ec8c1e49fff8d8dbd79ea238606865a843cc2a9806b17e2fa0a2bba23530bd9cea1b18a89499f934501360487e8ace167ea1ec825606514f8d9d9597d7b862c569ace3d757a81e28880dff9b74e69cf1876e0d3c4d76667ac3ee16c128bc9f93f3d76881fb9733c56e4a84fffd3aea94f5e63f8995ab0d3939ae146c3942f63948237dc1d37e1238f1fa47d1529d3cbcbd4d5228e875356acbb3b8277a5376c6fc79e974a24e47ab78ac910858d5cfc2c2b73a07f1636015e4fec8ae2b5c25bd4663e676e8daa348ee4680030ab97a69252db3e40c6483d68f204f6e974859602a1a652bd67a1e034b032eb5c098958fe6af75e5515464921677873541df358d2acf2fc79e29f06e241c0642b6c559c97d5ed587497ac65011a3a95144ee75a805b50d69b6efed0a42fc2f9af667d2a73b9c964f047d0e309e4bbdb09adfe9cdc240aa2471b42d10d29f657b464d063bfbbb2959523a20b4e549f1111ded76e75281c2bfaf35bc36daff4865113f17d7d9a09eae04a62e39cab58320771ae594ab723a59584f3485050e2d97d050dba2a9a9f395af7dd6a87fedfe907e9d2452fa1f8fc2ece1e25b5ac9d62a7ac16f68059a3d3de9684f8d2e20f70a332f08a62d28bbf92bb5859ee3ab4f24cc979da3b9717fd374dbefd82c8c1dc538db7961a4741efe30ee6c05b56b5ffa70043a6180deff7c0a6ac15a0d62dc178c7492f0b4092268de2c0211f409d5dd3720ac346dfa7c3be3a2cd68ca298b711bf80373ce09e7cece5ba74d928ff4bc68300f36fbff1b6d53f578aeaa8377b984a086ee49625e298e842cf8cce7ca66a3c6cc652c1d008febc0c944e15178a6b926c44446534b925f40a24182147f8461926eca4065ff5ec282cda7f3761f31e8db0ee6fff13ec0e8bb58df8e903ff9e1c7a09be9ac346a9261f8392c78a7684514840c4b95d64326c26ecb750c6e709259655ec39b2ad6753b9f87040d9c8c541a1ff3f5b607d3b9129030f8909e63ccb7e1d0b050cf76eef5994530bb3ccc1b2597863c2e7f425b3bf79c5175943fb66a0899b7925581df52192d2fd2a400cad9f725bbca4a3c36d0a6da338dab2430ed1e7bc4d5db7e4dd9246e36e9c6bd77e49335ba3972a2a78b4eedad66799a782edbed733f7bf99a3f95a27ef08473a74084f24bcc3ac66eb25902d3954544b539d14c44097494c982c488a3b2ca05f815ec1973ae8051fea3c86801d81ef9661591ee0daa7391c0f72e297ddf5e3ee87243b0d85c60fea85061a0849a812cd3ca68b55e545b83822152a5c6cc1686758fe98fb7c86be10d88ba7087cb9671ae9b142b24206a8aee2b3f85a6e361f3def824a251fe542d63ac57c8e7ef9e894ef010ad686ab1115ae2963c317cdc1ea5eed3d5a154cd55efdcd89d87942e09d9aa9c8654727edffdc54851fb03244f94dc6458e5d2e7e97bbb0616723a0e5323bc1ef5a3fc91880aa5929fc54623ca472e109b2983b9f3908e7ddf65aaf43a13f3cdab7f7102e216afe6804e9a2cabe2f6fb64e430251d8165b6986de388e3fcf7d93fc7b29ef837874cf1213b032d882b3145220f7727450a29dc1097cbdf064917b4c549bd21136e115c51ffa06b7ac34577ad4f728f75a8f256caeb07c1f2ee9a91739d7d0b385890e503316fc29f94fb4e3188d77ef532e7bb09fed26114c387adfbb9475ff41489436d091262f2e21b4cde767a8eb67af1d2162b3bf9a495da671df7516a13989475db7bc6d296e01f73495623ab9ce865f9a59a924b15aaffd3e797555e6d10d6dde5427e25774a2ab9f7e43f67174b374ff06c71d28bdab145c0477594d2c557043acf4184e4df2bd8e32e337c9b82d84825799216df7485d9d0e865a2062851085e86bf49f58de16996b14e9298ff61b37ca8d0a26e68c36a9504c22649eb3df7499f90767980c67940479ffb7645272a57fe2b61fec9c448e5bdb90cc51197cd9883eec3bccdd5f55033d7521c157be1900e0492b4fcfca48e6ee213f1300eaef9582f4ac4f9f1dfee3e2afe9fc29d22655a46e6cf17caa599b6519a684c17459e8ea76ef55c02fbe4240e919d04f84cee42ed641686c910b71e781314635bcacd3b65239b7cbb58750f26a5c7d801f550d073fd7ff434607cbc03dd607403527169d2a341d380dc2f60e0133fbe163f7038a06895074b1b359d45dd6418da36c7f9c56643ffe51d273ed67e6720f6843e832f3535811e0ea3a020d013d4c09476dfa7ed6d7b00977d80c605bde42c754c601ae3ba5033e5cc3cb8f9f3c834d4f9e9a33dfc47e92bb515af9ce4a0b174fa7234bbf72d89e21970ade6b16a7a46a815742aa1676f957bf0d671091017d2c9afe7bb0343c706b46ecfa9861cd9b334ac07b0fdae7229e3de0fe2f51b4431192d70acccab5dc55ad0f54564c921663e1ef3db049262bdb42d9ab839c2e37de66e7699503c6ca1ee20de3e8d5f3c77064e72f6436743c521d6b21dffa57f6acf353ac15f28bb717befa1a7ddcb1d21c92d40fc571c8f603480c3b9f79a79001998b6cdf88171baa4d686619b0e4129d8027b5854b2adcadc74dea95b49b3253ab8f3040e6fef5003c3fa335473708c08157c417541c44bf149a6d321435213a0508c2ff9a5395c932b0a0aa1d8e7dd298fd3e87f6ba7066f40f3969273a5ae61410494d1c00bd1506acb52d4d93878b57958ac0894a7a14e90e2137176bcaccf979c0f11e506d39ea1f1a9e9b749327b0f40f4785911d3ddad393495de17c6fc9f11618c00d3e37bd411b5f4989b687795c4ac9ab0d47156d28c3b443fdede4134c1c4ca3f596ddc12006441ee6221952f9b4a26469d1c79abb05ec6063c92b2697cdd2898a2818f2991bee0fd8855c0cee17f0dd9992a2cfb44eee72b59912e3b3d6c229412521efe8cba13148508b54875226d1a0bb456c05bf07d50ffba5a9ae136f83be3c775afee259f6d54d00bc28f2ca5759c62efb019555193459f4a6c187c49f069b68e5277b53a7b6dc61a071581087137b07096f62fb47f115220e33ab5d290c2d9b061802e91934a3af902cf64858ed9acc906647dc004ccb2ce1f97f18c69d6caa6d77381a84c2bf684e2d971a9628c5eb7a8270ca86589cfd2b001d78f69843bac61ba33effb6772200bb6a56415565cea8865b579c4b585efc6a7ad762d03da56ae02480c78e9324f9754c24cf48a5dd8544e1ae9003fafa14253b644a44168bc246943343fda7ce3fbb7a4604bba9c68aaf2f02e3e55a82058b41004b50b3316f2c913ff8e54387b536eff07279ac82aa1f3feca6a3d9abdf2784eef6cb92a49040d554f1d21f84f53360c6c5fc274fc475ba78b4d0d095f8c39b4b265e03e0d0129b955feb4177d329c7e8ffe7e56d4cdad70ad2e50b8233d4ff032fce202b0870721d2f8bc0ce7bdc4c1badc02931eea8203b1ef3bf34323371f571aa196bfc150e129a049e02d3906bddc7d897cab78f1feb294b4f72417f5c4fac103d123c7f948fd44ca0f5a6328611c1616dac954313859796c1dad656b8c4bcd3454392abc28b8efe480839cd842e51b2567097d0bbf80910dfdf40ffe80b0cea16108af9628645072a1b48931e6ceb6cff81f08b6268ccfea68f768345a4481a41c700b803d45ccfb4ee8d357d1e2cc4ccfce2b1fcf3dbdc903ebcd968b77ade14110b8bf4f5f6da6f3b16b59b1c810798915e22d848343881e9a34aeb99edcb951fad6bca68edb9ed7a6659378f041e82ec12688b569c3cb016778b0ed8fbb2a40f800afd529b263302fd927fb18083f2db8c088549f8c8b9f817f1281b59b567590a2de521a2afa314a3a305d33776e2e0d008b93631ebee67a53543d8b2f37245ebf23378c2957032151a43eb053758c8f43742b36e19265c76f217f0c639822fca467b04b60938bd623a9c51ed891c3811d369300e20df1d440059db535c3a675b3631f73bf2f65d76ec1e7952db24b82c9f6e80f2bce79e505f258c2437d083dd7cbc7be3de4efced3394673aef4de453838d0a223292b3d17d045ec5e60a4fddf830d99acb64c9bb5536955854404b2c2a812730baaf48b667032f038a9f1ccfb531790565e35ff71d578a27908f8dc118926cc8029b9ddc3a9c0ef7eb32e4c4d534a84c19b4f587fabeef910e8ca1d27cc9c374e82821106390a4600966c198fef2f1972e195d604e25e1bc50996cb5e3b6daf673a7561415c8126dabbf593daabe014820b3e29a476d44268ef0ddcba3a71624e7988e7b73961015e97c39f443eb808abe8fc50388e0f340a804a39f32e4302eac24a96529ede5a0a8b528e9bdcaf32ec28d9d575b7def7e1579f13a9d57db7ad5670bd88a18f11bbcb88a3daf467cc1f17d3b80a9e57e21be062cb85b26588f86016dee0049f1eff58ce6739363515da63d6521326d049b87ed17a44a892c5228cade53a64dd5828972196fed1fd318d34ad35d886fe6988de463a8792b06e3c1b7360e0f3397726a2804902b40c516bbc5645aa1a5dde786d288f2036568ed6dd13855998c39062f86efc506a0cb9a29d0b8c6bbc04e40f50162089cd42d7ae66d3a092310577c9adcfddca79c30b646d829612450fba0a6a8351d1423d55fedd18882425083bc9f8c276184140b1d2fe25512afa402c3c44da26ff30caa134723732a2921b434f1c5104140f857f169f88f4fe7010b967de4c2ec5bc29c5a00866639442e2bdf8d3e9c6860cea40b25216c88994f3cf7b216b5218d874856a780fbcce547c6164b7b1881f993e6b557e85f8f487e9ad0414b5fb107ee2a555710226712601646140a848d577aef5c41f64a429990f4583f1d8ebf19099369e17e358ed9b123477251dcbde7b57bdfea11ce62675787d9b6bec45126ab45fa4a3434b981354061adf078b49d4db646ef64d0e06dad32ce96e83c6f8410beb69e89a0d68a5783d0301a9ff3ee486387825a264d134448498985e0ee3359c67c1d446970e183c12c07f7e27bdbd19a26d05c7c3677dd783a4bf370c55537e64bdc8ff1cdf1b907322206a7b9f8832ce82644e12e9d6cd4cc90e273658a32d63876c80bd337fae7cd243e0d2f524de58664a711b2a3e1d5af54ddff3460798848d3a2a822cd6212f144d662948b5d4f7678b32aea353c97c94a027ccdc3363fddd350c8f57231c6c48966c4b03d476f75ce1e57a7805887734024b075082d0eacc5af9dab999ae060d1a86c231c471b406f35ca25d9bf12200024f52ea2b08481e14db6bbd18ac388f758764b8e7511d552542d8b64e0183500d2f64fb57730fc4767bc54798c1e990d90ebc92d36b37b5f1e60aee4eaacbae127ce2c3f9f814607e4e5a777f417eab69cb60d449f7fb5f5292140e9d926048ee8b1f93069af211c371ab73132d1cdbb0b98b080afe64b78ec4d8aabafee5a82af69990e6157ecc0c12bb8a3d5eb8839d7e52ea8fe3fdce3bc76c1a38486a80c512f4a83540dddf7b1c53c277444f6e2d913236bcd0c5f783d4b384abac75dc548792a95d14d8d9754ff4b1392df4460bfcb2a7746d97ceaec369ee4161481685de4939a93bffebacbf575834ca6d765f4e7708d0711bbb43267a9a05c407a8945ec71c87b0a0b61c748cfe2755b6d41f25c58b9a1b5b0347d223eb9c12cdd08bf0b5a7e4eeb94e9846924a8c634f150f71bcdf103199e8b9f92de49c3e3a834d4248e79cb33ef256caf71044c0d21842e2dd98472bc21e90190698dd5af163439ca5a0f8656a4b43afbe4a4fd674fe8e95eabb2f51a56f32e5aaaf979c94e2089afac654889f53d23b3bd64245634a56cdeecc2b0486ee71ea25111d46d06c76c00314fe4e0a495be3908ab9d4b270f73f0e3b3f74f03b3527d7e41a5fcdf30ef764fb1752e4ad5450ffaa47f120c1778a32541939a1b0460b47f265442ab607ae28283d1b140926fc5f89a6eae809340094b981397ad75ad6e8e1010ed5371e8fbb3d79b55f7ef07cd410bcd952a67582d8c5621e75685bb621925eb6e619dd625639ab388d7009dd0d90cee762e4e5db156b0ff63491bdd220d45d417bc4b7c8f2fadab32859f268236d705fe9c40b3f6b5781f53924df71941678c765f6d380996f016ec1d71bc622d68a924a56980bcffc753748284cba7ae2c6ec16a48e54fca07f09eef8dfc2adacb367e413be250a25da9b08718ec17d9917f607841513cc31f38256ba0f262daa9d8c41f0f7636b16d815e8a45c3ff7d363ddd9dbe94328fc68c33f10fd750582700e5ecf96253341eb27b75f9486caad502c35808551d1fe57146823081b312f1c77271f8e2e9e8eb04363d217b3829d98442cd283a184134cc52116264009a5b28544d93ed70109864c07f40855d88e434388ef85ebe5d7741c5bc4b86c151cf89c09eb93440da46f587ef3c225994aaa80f3ed1d1850641f399a1e2306271882ea5791ba6930575095d4cfc0966f00417bf324948aaf12c50cb3da55a6e5c2056cf966cd7088b80bbc33042a6987a8ab947a73ce1d1f68b16e35bb26bd87a136e914af0908f65b424965ae2fa7a796d92a54c5bf1ddc14be7a1c4b33b440067b94f5335c34d70845aab783373658a0c8f5a24ed066236a269df3da77b7d8271bf621f0b41ed05c858d5dd20dc8c7b1b2df3325025aeb1acfe65e65826c6e327f6adb4f032d874abde454f25c470c276b80ff38468cd05e883b37879d8417374bd546f00ebe2436b908de05b562eba5e9fa54771194c08e82e460e4bf4bf20148163769ef4f192438ea70207d17ca80c7ed1f03a59bf30300055635ded882208c5c69eac66614c0a442bf3677493852c46d7d5c36943a513c8d6697c9c76c4f5f83446455d56777143c46f63f83626af4ca8455a0f5a411bc71103dc84c19fc3eeabaf2475f9aacb617f0424fd0e47712cbb3ff7a78d0be0f3f03d1f206e3bfa8ed0ccadf283311c30ec09d6cb6fdd393208f9572d837a20266680253f183f627662144d169066d6f8bfc55483cb59d2abac3bb9b231eb189dd2608006099090a0f54459e522725a20475ba296e8cbcac40118c360645a4ac65c62ec5cbf4deddecdd8af77f190f54ad020e6d0fbb46e04e9851f6ee1e26bc54b8f0fa217b131e7c8dd419427eef13938be38171c190cd49a5adc214a08a7997dfddd717265e18274816a3eb06e91525e1bc1168468f99679147b32975b3808a751577c8d120e3c5c324cbaaf07128dcb7409af28146b7cf627d28a6ee997f2b92e7e68fa282aa244aa85ca6408ca01c34544ab73bd809146bd8a214865294172c6418534f706a7c375f6b721d1f8352c1af2817ef5b374ee1f2ccb39237a4a91787ec003eadb5343115748d7fdd8ee2acc19a01975798e8a478c6c65d48149516bdd02275abd238e602df12268555e91a7998ec96d4a9de0e39886a79da9cfb19ade012b1293b87be96034a7e70d5159c5b9feb317204bb97eecfd494c54fc210299e30ac34f7f85ec46856882ae785f6995f329205d8946718133020900beaa1130f33d67eb9042ddf10901cf8b74be836a8685d9310752ba1a3705cde5977c2d489a3aba49ba3f1cadce45dfae5213ba00252d85032ac802a08aa5be6901734e52f0ab51916944ba22d43fd7dd7d5079412651449ba51ae79286019eeea2c9afbf499d0fab8991eba1f94ceb35b9b46d6d58490fe3ad2500606ec3fbf73d700118e1eaf67d6c61a70cf24a36f7bef41301d49e7dee8cd5ff31e5b1d26682fcc07acee9c563615893d4abe06050efa7661a50cdc97cd845ee8a10461ee7e0be314f8578a09ff4919cd6af590fb44634b7ae9694b7beeb5948a298ba59577d108e161ddb2add25d8769c46a9cb93d933c6e6e00da1004b2d572627f326c4efde63d5993afd63f5e4b8bfc20381761eb060f22d177a775cea33e524c598287262211926ed7bbce88763226d3afcc735169c9c7fd307e29953c948cb0670290999a80cec5bd4552b876666e7060bd1bc84a4c16217757ee18cd2e6c98d9d342080312b428436a2f2e1a53d98ea3d5a26f35eb156f225c6f9d6cb9bb0044fa982d7d249f07336cd959ff63a14b9db9bf10757c3515a977d67a3e7ea900de8385d1103354807e7a3bfb25aaf81f5a6f060156cfcf7f9c79dd2faac27bd29cee2839524eede111f0e2a92833c0a2883072f3e22bba629dba678066b60b750c56d3d3709f9b0bdfd663d49498ab809660acd21b68a3ef3acc8df23f00888a3a95ddad0d35a9fd4a2ed3cf33ddc1d86da29b957909baf29737ebe7d4edfac40c2ff1664c01ca8d84a4b109f21d6a88a173c179c7c73ab79c134f4aacaec92c2d5d4d24cf7f5267d6c00fdca9808c038ba07afadcfe61be8b34a1018a895d49cc1aabcdee88b4488dd65f4e246abeb7cead54654261d0a6356ea7439b45fabb4e74c118c1b535733b2fe2977e71a42f0a2b7a487a5760bd5f470c33cdcf7b0c189a9b5bfcc5ae8f869683754e9df8f9c6aaf71b02558847cf124477927531d7ec746f4ca1da9156c0933ae8046f091cc47776d1d5e1b7faf9af47c73429e8196b42f3af3d5c35614cbf63ce42accadc40c94fe4826734b8bf9eddae31b41d29969c85c51036533f75c2d2aedf13e32fbcb5de8a086cd61b54b70bc2ce15bb8d9f2aa0c025156b93ea41b5daadc529744bdb30435e3c27154d17a2077d5c88c93971f9d09d5a736126a72b262acbe7e97ae944c10034b989e00109b3fb583600742b4ec536cfb68794ad5c34d793c577c3200d8751b5913d47543d2cbf9f993543ec7fcecd99aa7f69be6975d54a62ed485b514763080fc038dee1a7c2f50f440048f78da3571e9b542b92989b2e22ff1b703f2bf66d19aa1ed5f0405e275c7bc91a9477e086151aa2ea672ef264d225f5b91534d56aeb9f35857e026591bc105d80e7fb3b1aaf1d8ade17848725ce602cd76e9bd2e53fcae5c53c64c662490223843401693f16b5b5a645efe935321b9e2d98b8087ba0f5b39b6d7514c13c9d1b530c92ea0f19ef12e32d783712ea374ed3120ce1ecf1ff1f063fbc249c0c979efabbbbe3e12de2abc87f2ba5baceff7863eb1eb934dd7a35c9371ba022e0274999c7d88a179d1f3004b732c1e12f93e2062bc83acfaa45f070864335e58aa0c935497987abd0a8b2ece867b0b4ae74b1fc2d17bd0ddc7cc39737186798d2ef4afb05439bcd38bd68c4700a48044f8b70fcf63b23679033692d1585e86742be45cdbdbf7f1e07ee611e7693f06638945306f3eb2dd0f5152f08f89fa1146a4e87a509ac61a36d3942f13bfe8bb385ac1ba65dd1551e121e6cbfe61e79f1c7c363b06f4818d52372cf8ff3dee612afea711e92df0fa8801057b08ac719ad0b421c13d5df3ff1e541d73b86672fb11b44b1e8c026df8851597ffa52ae8772b5704334b4fd22503c8b96cd85fd924838328893f9e307318b99d667c7cbc211cefd1d4ebeac9b6a7c7ae7e09ae7e1959ee199e98eef51b7b2d1d6a40f8a0a094652ef9eef94d6fb8d4dcaed2714772b863b834dde581abe18a2cbbc8da53ecf42ceae31e5208d1bece5cd0033e5305391da34d78e5d016eb284aad641b6428c6b067b64024170b5db8572da0fd7b2c6c022ddf7862a2c4006770dee535a8151069af10212882501943563bd3226b751e33fac7313c709054198c4f617c83d120f5e31f64086d0409fc27db9fea0339749eddb57a970fd7f3806b798df0942715ed1b57fc8ecdb08c20c86c5da123b225d4858c9519140bf99a9f583d3bc856c4f7949704781bfa4dc6b0dde9a7d6cffecba2c2879d06b1d267ecded04aa16cefb70250ce0c001c91b6772466aec7b1a7876a67161ed2749b1a7d4836bad6f92682c18fa8a3fef6a0476eaf75adfbfa8f5eb95226280d38eb259b3bf879b6c9bb23e6a2b194739d97e70abeffd30f58aec25a02b9874ec1dc1d4c5a074862cac2c2975317710cd3379252a802aea0203fd542ec96ada238f99e28cfa40fee98218cde64caba8d7a8f116ac8c428b239d8b7844fc1a8b4e877f9efa2c0836496a68065db388bf3f7fdc312ba6f650c1f3205bb95fc562370b6503cffcc638e6101e576292be261da47748f9fa927944aae7686cf47fd841a63e97deb8e9f42fee0b8302b1937daddd530c7d48f2369b4ed3d87914065ab90015366243d9dfa0f8f9fde7fbdebfe00fa713231920b090226e6cdef72ce9f8807960495f30fb404cef9cb822595393a60f76ade7b9195a302473cf7b427a12d705dae1cfbf1eef3bc602c8303bd41cd7ee563e3df9d09d187645186df1affc13e8834a788b04bc528c954464ed0abab6ace74521affb38f5041c4f3c62470746a78bb35ec488523fa5843cd046956033c234c4d7715425291a50472c4f127250d5f0a60352bc174c2f5ba073b529afe5b129b6f9ee5be55cce2de9d4c81885630a9dcbdab4fae5de0fa2d92026da0abea8589cc606a4a7055286598898e71b823b4d9b45564df815e7f86ec312af95618e41745049fcd4a0d0a4322e1731508cceb8011ee1866f70fcbdcc6fe9fc9f37e3a3ddf3200e9e9207974c8ac46148dcbde36aaee79bde84936946ea131059c37c8e3bdb3080f2ffc391669ad1da789dfab8b83df889a31617b29f4757127e2adfe7e5ad717f65e7b3a380af05b3583db228d6f17100b48ab0df3a88e279a2e0f96e7aa9a88a71</script></div><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
      <categories>
        <category>考研</category>
      </categories>
      <tags>
        <tag>考研</tag>
        <tag>数据结构</tag>
      </tags>
  </entry>
  <entry>
    <title>BUAA-北航-自动评教代码</title>
    <url>/posts/buaa-bei-hang-zi-dong-ping-jiao-dai-ma/</url>
    <content><![CDATA[<ul>
<li><p>修复了<a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/IBSLGi9LfI75wQ3O7vHI4w">参考代码</a>中卡在<code>是否推荐</code>这一步无法继续运行的 Bug</p>
</li>
<li><p>适用于北航教务系统，校内网和VPN均可使用</p>
</li>
<li><p>截止本文发出前该代码仍可正常使用</p>
</li>
</ul>
<h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">javascript: <span class="function"><span class="keyword">function</span> <span class="title">judge</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    doc = <span class="built_in">window</span>.top.document.getElementById(<span class="string">&quot;iframename&quot;</span>).contentWindow;</span><br><span class="line">    doc.alert = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;;</span><br><span class="line">    doc.confirm = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">var</span> arr = [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>];</span><br><span class="line">    <span class="keyword">while</span> (arr[<span class="number">0</span>] === arr[<span class="number">1</span>] &amp;&amp; arr[<span class="number">2</span>] === arr[<span class="number">3</span>] &amp;&amp; arr[<span class="number">4</span>] === arr[<span class="number">5</span>] &amp;&amp; arr[<span class="number">1</span>] === arr[<span class="number">2</span>]) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">6</span>; i++) &#123;</span><br><span class="line">            arr[i] = <span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * <span class="number">3</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    a = doc.$(<span class="string">&quot;input[name^=tabmapzb]&quot;</span>);</span><br><span class="line">    b = doc.$(<span class="string">&quot;span.yellow&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (a.length !== <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">6</span>; i++) &#123;</span><br><span class="line">            a[arr[i] + i * <span class="number">5</span>].click();</span><br><span class="line">        &#125;</span><br><span class="line">        doc.$(<span class="string">&quot;#sftj&quot;</span>).get(<span class="number">0</span>).selectedIndex = <span class="number">1</span>;</span><br><span class="line">        doc.tj();</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        b[<span class="number">1</span>].firstElementChild.click();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">doc = <span class="built_in">window</span>.top.document.getElementById(<span class="string">&quot;iframename&quot;</span>).contentWindow;</span><br><span class="line"><span class="built_in">setInterval</span>(<span class="string">&quot;doc.$.onload = judge()&quot;</span>, <span class="number">1400</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h2><ol>
<li><p>使用 <strong>Chrome</strong> 浏览器打开评教页面</p>
<blockquote>
<p>打开教务管理系统 –&gt; 教学评价 –&gt; 学生评教 –&gt; 开始评教</p>
</blockquote>
</li>
<li><p>将此时浏览器地址栏的内容清空，并将上述代码复制到地址栏，并在代码的最开始加上</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">javascript:</span><br></pre></td></tr></table></figure>

<p>回车即可。</p>
<p>注意：代码最开始虽然有<code>javascript:</code>，但是复制过去后就没了，所以需要我们手动加上</p>
</li>
</ol>
<h2 id="代码说明与自定义"><a href="#代码说明与自定义" class="headerlink" title="代码说明与自定义"></a>代码说明与自定义</h2><ol>
<li><p>评教的效果是从前三项 <code>优秀</code>、<code>良好</code>、<code>中等</code>三者中随机生成的，而且保证不会出现全选一个等级的情况（全选一个等级是提交不上的）</p>
<p>如果需要修改，可把代码第12行</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">arr[i] = <span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * <span class="number">3</span>);</span><br></pre></td></tr></table></figure>

<p>中的<code>3</code> 改成 <code>n(1 &lt; n &lt;= 5)</code>，意思是从前 <code>n</code>项中随机生成</p>
</li>
<li><p>是否推荐选的是 <code>是</code></p>
<p>需要修改的话在第21行</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">doc.$(<span class="string">&quot;#sftj&quot;</span>).get(<span class="number">0</span>).selectedIndex = <span class="number">1</span>;</span><br></pre></td></tr></table></figure>

<p><code>0</code> 改为 <code>1</code> 表示选择不推荐</p>
</li>
<li><p>用完记得关闭评教页面</p>
</li>
<li><p>别的浏览器大概支持吧（选的课太少了，没机会试了_(:з)∠)_）</p>
</li>
</ol>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/IBSLGi9LfI75wQ3O7vHI4w">分享一份自动评教代码</a></p>
]]></content>
      <categories>
        <category>评教</category>
      </categories>
      <tags>
        <tag>评教</tag>
        <tag>BUAA</tag>
      </tags>
  </entry>
  <entry>
    <title>Mybatis学习笔记01</title>
    <url>/posts/mybatis-xue-xi-bi-ji-01/</url>
    <content><![CDATA[<h2 id="三层架构"><a href="#三层架构" class="headerlink" title="三层架构"></a>三层架构</h2><ul>
<li><p>表现层：用于展示数据</p>
</li>
<li><p>业务层：处理业务需求</p>
</li>
<li><p>持久层：和数据库交互</p>
</li>
</ul>
<p><img data-src="01.png" alt="三层架构"></p>
<h2 id="JDBC问题分析"><a href="#JDBC问题分析" class="headerlink" title="JDBC问题分析"></a>JDBC问题分析</h2><ol>
<li>数据库链接创建、释放频繁造成系统资源浪费从而影响系统性能，如果使用数据库链接池可解决此问题。</li>
<li>Sql 语句在代码中硬编码，造成代码不易维护，实际应用 sql 变化的可能较大，sql 变动需要改变 java 代码。 </li>
<li>使用 preparedStatement 向占有位符号传参数存在硬编码，因为 sql 语句的 where 条件不一定，可能 多也可能少，修改 sql 还要修改代码，系统不易维护。</li>
<li>对结果集解析存在硬编码（查询列名），sql 变化导致解析代码变化，系统不易维护，如果能将数据库记 录封装成 pojo 对象解析比较方便</li>
</ol>
<h2 id="MyBatis-框架概述"><a href="#MyBatis-框架概述" class="headerlink" title="MyBatis 框架概述"></a>MyBatis 框架概述</h2><ul>
<li><p>mybatis是一个持久层框架，用 Java 写的</p>
</li>
<li><p>它封装了 jdbc 操作的很多细节，使开发者只需要关注 sql 语句本身， 而不需要关注加载驱动、创建连接、创建 statement 等繁杂的过程。 </p>
</li>
<li><p>通过xml 或注解的方式将要执行的各种statement配置起来</p>
</li>
<li><p>采用 ORM 思想实现了对结果集的封装</p>
<blockquote>
<p>ORM：Object Relational Mapping 对象关系映射，简单地说，就是把数据库表和实体类及实体类的属性对应起来，让我们可以操作实体类就实现操作数据库表</p>
</blockquote>
</li>
</ul>
<h2 id="Mybatis-入门"><a href="#Mybatis-入门" class="headerlink" title="Mybatis 入门"></a>Mybatis 入门</h2><h3 id="mybatis-的环境搭建"><a href="#mybatis-的环境搭建" class="headerlink" title="mybatis 的环境搭建"></a>mybatis 的环境搭建</h3><ol>
<li>创建maven工程并导入坐标</li>
<li>创建实体类<code>User.java</code>和 dao 的接口<code>IUserDao.java</code></li>
</ol>
<p><code>User.java</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.conv.domain;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    <span class="keyword">private</span> Date birthday;</span><br><span class="line">    <span class="keyword">private</span> String sex;</span><br><span class="line">    <span class="keyword">private</span> String address;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Integer <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getUsername</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> username;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUsername</span><span class="params">(String username)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.username = username;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Date <span class="title">getBirthday</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> birthday;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setBirthday</span><span class="params">(Date birthday)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.birthday = birthday;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getSex</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> sex;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSex</span><span class="params">(String sex)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.sex = sex;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getAddress</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> address;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAddress</span><span class="params">(String address)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.address = address;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;User&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;id=&quot;</span> + id +</span><br><span class="line">                <span class="string">&quot;, username=&#x27;&quot;</span> + username + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, birthday=&quot;</span> + birthday +</span><br><span class="line">                <span class="string">&quot;, sex=&#x27;&quot;</span> + sex + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, address=&#x27;&quot;</span> + address + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><code>IUserDao.java</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.conv.Dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.conv.domain.User;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IUserDao</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 查询所有操作</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function">List&lt;User&gt; <span class="title">findAll</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ol start="3">
<li>创建 mybatis 主配置文件<code>SqlMapConfig.xml</code>（文件名任意）</li>
</ol>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">configuration</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">&quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--配置环境--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">&quot;mysql&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--配置myslq的环境--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">&quot;mysql&quot;</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--配置事务的类型--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">&quot;JDBC&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">transactionManager</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--配置数据源（连接池）--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">&quot;POOLED&quot;</span>&gt;</span></span><br><span class="line">                <span class="comment">&lt;!--配置连接数据库的基本信息--&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driver&quot;</span> <span class="attr">value</span>=<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;jdbc:mysql://localhost:3306/learn?serverTimezone=UTC&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;root&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;4869&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--指定映射配置文件的位置，映射配置文件指的是每个DAO独立的配置文件</span></span><br><span class="line"><span class="comment">        如果是用注解来配置的话，此处应该使用class属性指定被注解的dao全限定类名</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--xml配置，路径是resource下的路径--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">&quot;com/conv/dao/IUserDao.xml&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!--使用注解的配置--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--&lt;mapper class=&quot;com.conv.dao.IUserDao&quot;/&gt;--&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ol start="4">
<li>创建映射配置文件<code>IUserDao.xml</code>（文件名任意）</li>
</ol>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--namespace是Dao的全限定类名--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.conv.dao.IUserDao&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--配置查询所有--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--id是dao的方法名称，不能随便写--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findAll&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.conv.domain.User&quot;</span>&gt;</span></span><br><span class="line">        select * from user;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ol start="5">
<li>配置 <code>log4j.properties</code></li>
</ol>
<figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Set root category priority to INFO and its only appender to CONSOLE.</span></span><br><span class="line"><span class="comment">#log4j.rootCategory=INFO, CONSOLE            debug   info   warn error fatal</span></span><br><span class="line"><span class="meta">log4j.rootCategory</span>=<span class="string">debug, CONSOLE, LOGFILE</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Set the enterprise logger category to FATAL and its only appender to CONSOLE.</span></span><br><span class="line"><span class="meta">log4j.logger.org.apache.axis.enterprise</span>=<span class="string">FATAL, CONSOLE</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># CONSOLE is set to be a ConsoleAppender using a PatternLayout.</span></span><br><span class="line"><span class="meta">log4j.appender.CONSOLE</span>=<span class="string">org.apache.log4j.ConsoleAppender</span></span><br><span class="line"><span class="meta">log4j.appender.CONSOLE.layout</span>=<span class="string">org.apache.log4j.PatternLayout</span></span><br><span class="line"><span class="meta">log4j.appender.CONSOLE.layout.ConversionPattern</span>=<span class="string">%d&#123;ISO8601&#125; %-6r [%15.15t] %-5p %30.30c %x - %m\n</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># LOGFILE is set to be a File appender using a PatternLayout.</span></span><br><span class="line"><span class="meta">log4j.appender.LOGFILE</span>=<span class="string">org.apache.log4j.FileAppender</span></span><br><span class="line"><span class="meta">log4j.appender.LOGFILE.File</span>=<span class="string">d:\axis.log</span></span><br><span class="line"><span class="meta">log4j.appender.LOGFILE.Append</span>=<span class="string">true</span></span><br><span class="line"><span class="meta">log4j.appender.LOGFILE.layout</span>=<span class="string">org.apache.log4j.PatternLayout</span></span><br><span class="line"><span class="meta">log4j.appender.LOGFILE.layout.ConversionPattern</span>=<span class="string">%d&#123;ISO8601&#125; %-6r [%15.15t] %-5p %30.30c %x - %m\n</span></span><br></pre></td></tr></table></figure>

<h3 id="环境搭建的注意事项"><a href="#环境搭建的注意事项" class="headerlink" title="环境搭建的注意事项"></a>环境搭建的注意事项</h3><ol>
<li>在 Mybatis 中把持久层的操作接口名称和映射文件也叫做：Mapper，所以命名中：IUserDao 和 IUserMapper 是一样的</li>
<li>在 idea 中创建目录的时候，它和包是不一样的：<ul>
<li>包（package）在创建时：<code>com.conv.dao</code>它是三级结构</li>
<li>目录（directory）在创建时：<code>com.conv.dao</code>是一级目录</li>
</ul>
</li>
<li>mybatis 的映射配置文件位置必须和 dao 接口的包结构相同</li>
<li>映射配置文件的 mapper 标签 namespace 属性的取值必须是 dao 接口的全限定类名</li>
<li>映射配置文件的操作配置（select等），id 属性的取值必须是 dao 接口的方法名</li>
</ol>
<blockquote>
<p>第3、4、5点保证了在开发中无需实现 dao 的实现类</p>
</blockquote>
<h3 id="入门案例"><a href="#入门案例" class="headerlink" title="入门案例"></a>入门案例</h3><ol>
<li>读取配置文件</li>
<li>创建 SqlSessionFactory 工厂</li>
<li>创建 SqlSession</li>
<li>创建 Dao 接口的代理对象</li>
<li>执行 dao 中的方法</li>
<li>释放资源</li>
</ol>
<blockquote>
<p>注意事项：</p>
<p>不要忘记在映射配置<code>IUserDao.xml</code>中告知 mybatis 要封装到哪个实体类中</p>
<p>配置的方式：指定实体类的全限定类名（<code>resultType=&quot;com.conv.domain.User&quot;</code>）</p>
</blockquote>
<p>代码示例：<code>MybatisTest.java</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.conv.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MybatisTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test1</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="comment">//1. 读取配置文件</span></span><br><span class="line">        InputStream in = Resources.getResourceAsStream(<span class="string">&quot;SqlMapConfig.xml&quot;</span>);</span><br><span class="line">        <span class="comment">//2. 创建SqlSessionFactory工厂</span></span><br><span class="line">        SqlSessionFactoryBuilder builder = <span class="keyword">new</span> SqlSessionFactoryBuilder();</span><br><span class="line">        SqlSessionFactory factory = builder.build(in);</span><br><span class="line">        <span class="comment">//3. 使用工厂生产SqlSession对象</span></span><br><span class="line">        SqlSession session = factory.openSession();</span><br><span class="line">        <span class="comment">//4. 使用SqlSession创建Dao接口的代理对象</span></span><br><span class="line">        IUserDao userDao = session.getMapper(IUserDao.class);</span><br><span class="line">        <span class="comment">//5. 使用代理对象执行方法</span></span><br><span class="line">        List&lt;User&gt; users = userDao.findAll();</span><br><span class="line">        <span class="keyword">for</span> (User user : users) &#123;</span><br><span class="line">            System.out.println(user);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//6. 释放资源</span></span><br><span class="line">        session.close();</span><br><span class="line">        in.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="基于注解的入门案例"><a href="#基于注解的入门案例" class="headerlink" title="基于注解的入门案例"></a>基于注解的入门案例</h3><ol>
<li>把 <code>IUserDao.xml</code>移除，在 dao 接口的方法上使用 <code>@Select</code> 注解，并且指定 SQL 语句</li>
</ol>
<p><code>IUserDao.java</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.conv.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.conv.domain.User;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Select;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IUserDao</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 查询所有操作</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Select(&quot;select * from user&quot;)</span></span><br><span class="line">    <span class="function">List&lt;User&gt; <span class="title">findAll</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>在 <code>SqlMapConfig.xml</code> 中的 mapper 配置时，使用 <code>class</code> 属性指定 dao 接口的全限定类名</li>
</ol>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--指定映射配置文件的位置，映射配置文件指的是每个DAO独立的配置文件</span></span><br><span class="line"><span class="comment">    如果是用注解来配置的话，此处应该使用class属性指定被注解的dao全限定类名</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--xml配置，路径是resource下的路径--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--&lt;mapper resource=&quot;com/conv/dao/IUserDao.xml&quot;/&gt;--&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--使用注解的配置--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">class</span>=<span class="string">&quot;com.conv.dao.IUserDao&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br></pre></td></tr></table></figure>



<ul>
<li>明确：</li>
</ul>
<blockquote>
<p>Mybatis 是支持写 dao 实现类的</p>
<p>我们在实际开发中，都是越简练越好，所以不管使用 XML 还是注解配置，都是采用不写 dao 实现类的方式</p>
</blockquote>
<h3 id="DAO-实现类"><a href="#DAO-实现类" class="headerlink" title="* DAO 实现类"></a>* DAO 实现类</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.conv.dao.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.conv.dao.IUserDao;</span><br><span class="line"><span class="keyword">import</span> com.conv.domain.User;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserDaoImpl</span> <span class="keyword">implements</span> <span class="title">IUserDao</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> SqlSessionFactory factory;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">UserDaoImpl</span><span class="params">(SqlSessionFactory factory)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.factory = factory;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;User&gt; <span class="title">findAll</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//1. 使用工厂创建SqlSession对象</span></span><br><span class="line">        SqlSession session = factory.openSession();</span><br><span class="line">        <span class="comment">//2. 使用session执行查询所有方法</span></span><br><span class="line">        <span class="comment">// namespace + id 配合 IUserDao.xml</span></span><br><span class="line">        List&lt;User&gt; users = session.selectList(<span class="string">&quot;com.conv.dao.IuserDao.findAll&quot;</span>);</span><br><span class="line">        session.close();</span><br><span class="line">        <span class="comment">//3. 返回查询结果</span></span><br><span class="line">        <span class="keyword">return</span> users;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="自定义-Mybatis-的分析"><a href="#自定义-Mybatis-的分析" class="headerlink" title="自定义 Mybatis 的分析"></a>自定义 Mybatis 的分析</h2><p>mybatis 在使用代理 dao 的方式实现增删改查时做了：</p>
<ul>
<li>创建代理对象</li>
<li>在代理对象中调用 <code>selectList</code></li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MybatisTest</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test1</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="comment">//1. 读取配置文件</span></span><br><span class="line">        <span class="comment">//路径：(1) 使用类加载器，它只能读取类路径的配置文件</span></span><br><span class="line">        <span class="comment">//(2) 使用ServletContext对象的getRealPath()</span></span><br><span class="line">        InputStream in = Resources.getResourceAsStream(<span class="string">&quot;SqlMapConfig.xml&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2. 创建SqlSessionFactory工厂</span></span><br><span class="line">        <span class="comment">//创建工厂使用了构建者模式(SqlSessionFactoryBuilder即构建者)</span></span><br><span class="line">        <span class="comment">//优势：把对象的构建细节隐藏，是使用者直接调用方法即可拿到对象</span></span><br><span class="line">        SqlSessionFactoryBuilder builder = <span class="keyword">new</span> SqlSessionFactoryBuilder();</span><br><span class="line">        SqlSessionFactory factory = builder.build(in);</span><br><span class="line">        <span class="comment">//3. 使用工厂生产SqlSession对象</span></span><br><span class="line">        <span class="comment">//生产SqlSession使用了工厂模式</span></span><br><span class="line">        <span class="comment">//优势：解耦，降低类之间的依赖关系</span></span><br><span class="line">        SqlSession session = factory.openSession();</span><br><span class="line">        <span class="comment">//4. 使用SqlSession创建Dao接口的代理对象</span></span><br><span class="line">        <span class="comment">//创建Dao接口实现类使用了代理模式</span></span><br><span class="line">        <span class="comment">//优势：不修改源码的基础上对已有方法增强</span></span><br><span class="line">        IUserDao userDao = session.getMapper(IUserDao.class);</span><br><span class="line">        <span class="comment">//5. 使用代理对象执行方法</span></span><br><span class="line">        List&lt;User&gt; users = userDao.findAll();</span><br><span class="line">        <span class="keyword">for</span> (User user : users) &#123;</span><br><span class="line">            System.out.println(user);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//6. 释放资源</span></span><br><span class="line">        session.close();</span><br><span class="line">        in.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="selectList方法的流程："><a href="#selectList方法的流程：" class="headerlink" title="selectList方法的流程："></a><code>selectList</code>方法的流程：</h3><blockquote>
<p>需要的信息：</p>
<ul>
<li>连接信息</li>
<li>映射信息（包含执行的 sql 语句、封装结果的实体类全限定类名）</li>
</ul>
</blockquote>
<ol>
<li><p>读取配置文件：用到的技术就是解析XML的技术。</p>
<blockquote>
<p>此处用的是 dom4j 解析 xml 技术</p>
</blockquote>
</li>
<li><p>根据配置文件的信息创建 Connection 对象</p>
<blockquote>
<p>注册驱动，获取连接</p>
</blockquote>
</li>
<li><p>获取预处理对象 PreparedStatement</p>
<blockquote>
<p>此时需要 sql 语句（从 XML 解析得到）</p>
</blockquote>
</li>
<li><p>执行查询</p>
<p><code>ResultSet result = preparedStatement.executeQuery();</code></p>
</li>
<li><p>遍历结果集用于封装</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">List&lt;E&gt; list = <span class="keyword">new</span> ArrayList();</span><br><span class="line"><span class="keyword">while</span>(resultSet.next())&#123;</span><br><span class="line">    <span class="comment">//通过全限定类名使用反射得到对象</span></span><br><span class="line">    <span class="comment">//通过 resultType 得到配置的全限定类名</span></span><br><span class="line">    E element = (E)Class.forName(配置的全限定类名).newInstance();</span><br><span class="line">    <span class="comment">//使用反射进行封装，把每个rs的内容都添加到element中</span></span><br><span class="line">    <span class="comment">//实体类属性和表中的列名是一致的，于是我们就可以把表的列名看成是实体类的属性名称</span></span><br><span class="line">    <span class="comment">//就可以使用反射的方式来根据名称获取每个属性，并把值赋进去</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">//把element加入到list中</span></span><br><span class="line">    list.add(element);</span><br><span class="line">&#125;   </span><br></pre></td></tr></table></figure>
</li>
<li><p>返回 list</p>
<p><code>return list;</code></p>
</li>
</ol>
<p><img data-src="02.png" alt="查询所有的分析"></p>
<h3 id="使用SqlSession创建Dao接口的代理对象"><a href="#使用SqlSession创建Dao接口的代理对象" class="headerlink" title="使用SqlSession创建Dao接口的代理对象"></a>使用SqlSession创建Dao接口的代理对象</h3><p><code>IUserDao userDao = session.getMapper(IUserDao.class);</code></p>
<p>根据 Dao 的字节码创建 dao 的代理对象</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> &lt;T&gt; <span class="function">T <span class="title">getMapper</span><span class="params">(Class&lt;T&gt; daoInterfaceClass)</span></span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 类加载器：它使用的和被代理对象是相同的类加载器</span></span><br><span class="line"><span class="comment">    * 代理对象要实现的接口：和被代理对象实现相同的接口</span></span><br><span class="line"><span class="comment">    * 如何代理：它就是增强的方法，我们需要自己来提供</span></span><br><span class="line"><span class="comment">    *		 此处是一个InvocationHandler的接口，我们要写一个该接口的实现类</span></span><br><span class="line"><span class="comment">    *		 在实现类中调用 selectList 方法</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    Proxy.newProxyInstance(类加载器, 代理对象要实现的接口字节码数组, 如何代理);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img data-src="03.png" alt="自定义Mybatis分析"></p>
]]></content>
      <categories>
        <category>Mybatis</category>
      </categories>
      <tags>
        <tag>Mybatis</tag>
        <tag>JDBC</tag>
      </tags>
  </entry>
  <entry>
    <title>Spring学习笔记02</title>
    <url>/posts/spring-xue-xi-bi-ji-02/</url>
    <content><![CDATA[<h2 id="Spring-中-IOC-的常用注解"><a href="#Spring-中-IOC-的常用注解" class="headerlink" title="Spring 中 IOC 的常用注解"></a>Spring 中 IOC 的常用注解</h2><p>上一节介绍的 xml 配置：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;&quot;</span> <span class="attr">class</span>=<span class="string">&quot;&quot;</span> <span class="attr">scope</span>=<span class="string">&quot;&quot;</span> <span class="attr">init-method</span>=<span class="string">&quot;&quot;</span> <span class="attr">destroy-method</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&quot;</span> | <span class="attr">ref</span>=<span class="string">&quot;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="用于创建对象的"><a href="#用于创建对象的" class="headerlink" title="用于创建对象的"></a>用于创建对象的</h3><blockquote>
<p>与在 xml 配置文件中的 <bean> 标签实现的功能一致</p>
</blockquote>
<p><code>@Component:</code></p>
<blockquote>
<p>作用：用于把当前类对象存入 Spring 容器中</p>
<p>属性：<code>value</code>：用于指定 bean 的 id。如果不写，默认为当前类名，且首字母小写</p>
</blockquote>
<p>还有三个和 <code>@Component</code> 作用一摸一样的注解：</p>
<ul>
<li><p><code>@Controller</code>：一般用在表现层</p>
</li>
<li><p><code>@Service</code>：一般用在业务层</p>
</li>
<li><p><code>@Repository</code>：一般用在持久层</p>
</li>
</ul>
<p>是 spring 框架为我们提供明确的三层使用的注解，使我们的三层对象更加清晰（这四个注解可以互换使用，但不推荐）</p>
<p><code>com\conv\service\impl\AccountServiceImpl.java</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.conv.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.conv.dao.IAccountDao;</span><br><span class="line"><span class="keyword">import</span> com.conv.service.IAccountService;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 账户的业务层实现类</span></span><br><span class="line"><span class="comment"> * 当只有一个属性 value 时，value 可以省略不写</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Component(&quot;accountService&quot;)</span></span><br><span class="line"><span class="comment">//@Component(value = &quot;accountService&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AccountServiceImpl</span> <span class="keyword">implements</span> <span class="title">IAccountService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> IAccountDao accountDao;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">AccountServiceImpl</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;对象创建了&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">saveAccount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        accountDao.saveAccount();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>bean.xml</code></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">        https://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="tag"><span class="string">        https://www.springframework.org/schema/context/spring-context.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 告知spring在创建容器时要扫描的包，</span></span><br><span class="line"><span class="comment">    配置需要的标签不是在beans的约束中，而是一个名称为context名称空间和约束中 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.conv&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="用于注入数据的"><a href="#用于注入数据的" class="headerlink" title="用于注入数据的"></a>用于注入数据的</h3><blockquote>
<p>与在 xml 配置文件中在 <bean> 标签中写一个 <property> 标签的作用一致</p>
</blockquote>
<p><code>@Autowired</code>:</p>
<blockquote>
<p>作用：自动按照类型注入。只要容器中有唯一的一个bean对象类型和要注入的变量类型匹配，就可以注入成功。如果ioc容器中没有任何bean类型和要注入的变量类型匹配，则报错。如果有多个匹配时，先按照类型圈定数据类型，再按照名称去匹配，若都不匹配，则报错。</p>
<p>出现位置：可以是变量上，也可以是方法上。</p>
<p>细节：在使用注解注入时，set 方法就不是必须的了。</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> IAccountDao accountDao;</span><br></pre></td></tr></table></figure>

<p><code>@Qualifier</code>:</p>
<blockquote>
<p>作用：在按照类中注入的基础上再按照名称注入，它给类成员注入时不能单独使用（需要和Autowired同时使用）。但是给方法参数注入时可以</p>
<p>属性：</p>
<p>​    value：用于指定注入bean的id</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 账户的业务层实现类</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Service(&quot;accountService&quot;)</span></span><br><span class="line"><span class="comment">//@Service(value = &quot;accountService&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AccountServiceImpl</span> <span class="keyword">implements</span> <span class="title">IAccountService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="meta">@Qualifier(&quot;accountDao&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> IAccountDao accountDao;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">saveAccount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        accountDao.saveAccount();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>@Resource</code>:</p>
<blockquote>
<p>作用：直接按照bean的id注入。它可以独立使用。</p>
<p>属性：</p>
<p>​    name：用于指定注入bean的id</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 账户的业务层实现类</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Service(&quot;accountService&quot;)</span></span><br><span class="line"><span class="comment">//@Service(value = &quot;accountService&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AccountServiceImpl</span> <span class="keyword">implements</span> <span class="title">IAccountService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">//    @Autowired</span></span><br><span class="line"><span class="comment">//    @Qualifier(&quot;accountDao&quot;)</span></span><br><span class="line">    <span class="meta">@Resource(name = &quot;accountDao&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> IAccountDao accountDao;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">saveAccount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        accountDao.saveAccount();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>注意，这里的 <code>pom.xml</code>要增加一项：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.annotation<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>javax.annotation-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>以上三个注解都只能注入其他 bean 类型的数据，而基本类型和 String 类型无法使用上述注解实现</li>
<li>另外：集合类型的注入只能通过 XML 来实现</li>
</ul>
<p><code>@Value</code>:</p>
<blockquote>
<p>作用：用于注入基本类型和 String 类型的数据</p>
<p>属性：</p>
<p>​    value：用于指定数据的值。它可以使用 spring 中 SpEL（也就是 spring 的el表达式）</p>
<p>​    SpEL 的写法：<code>$&#123;表达式&#125;</code></p>
</blockquote>
<h3 id="用于改变作用范围的"><a href="#用于改变作用范围的" class="headerlink" title="用于改变作用范围的"></a>用于改变作用范围的</h3><blockquote>
<p>与在 <bean> 标签中使用 <code>scope</code> 属性实现的功能一致</p>
</blockquote>
<p><code>@Scope</code>:</p>
<blockquote>
<p>作用：用于指定 bean 的作用范围</p>
<p>属性：</p>
<p>​    value：指定范围的取值。常用取值：singleton prototype</p>
<p>​    默认是单例的</p>
</blockquote>
<h3 id="和生命周期相关（了解）"><a href="#和生命周期相关（了解）" class="headerlink" title="和生命周期相关（了解）"></a>和生命周期相关（了解）</h3><blockquote>
<p>与在 <bean> 标签中使用 <code>init-method</code>,<code>destroy-method</code> 属性实现的功能一致</p>
</blockquote>
<p><code>@PreDestroy</code>:</p>
<blockquote>
<p>作用：用于指定销毁方法</p>
</blockquote>
<p><code>@PostConstruct</code>:</p>
<blockquote>
<p>作用：用于指定初始化方法</p>
</blockquote>
<h2 id="案例"><a href="#案例" class="headerlink" title="案例"></a>案例</h2><blockquote>
<p>使用xml方式和注解的方式实现单表的CRUD操作</p>
</blockquote>
<ul>
<li>持久层技术选型：dbutils</li>
</ul>
<h2 id="改造基于注解的IOC案例，使用纯注解的方式实现"><a href="#改造基于注解的IOC案例，使用纯注解的方式实现" class="headerlink" title="改造基于注解的IOC案例，使用纯注解的方式实现"></a>改造基于注解的IOC案例，使用纯注解的方式实现</h2><blockquote>
<p>Spring 的一些新注解使用</p>
</blockquote>
<h2 id="Spring-和-Junit-的整合"><a href="#Spring-和-Junit-的整合" class="headerlink" title="Spring 和 Junit 的整合"></a>Spring 和 Junit 的整合</h2>]]></content>
      <categories>
        <category>Spring</category>
      </categories>
      <tags>
        <tag>Spring</tag>
      </tags>
  </entry>
  <entry>
    <title>Ubuntu命令行安装zsh、oh-my-zsh、插件以及相关配置</title>
    <url>/posts/ubuntu-ming-ling-xing-an-zhuang-zsh-oh-my-zsh-cha-jian-yi-ji-xiang-guan-pei-zhi/</url>
    <content><![CDATA[<p>鉴于网上的教程参差不齐，方法也都不太一样，我每次都需要找半天才能找到一个相对来说满意的教程。</p>
<p>所以为了避免麻烦，我就自己写一个教程，以后再重置服务器系统就能快速安装了</p>
<h2 id="1-安装-zsh"><a href="#1-安装-zsh" class="headerlink" title="1. 安装 zsh"></a>1. 安装 zsh</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt install zsh</span><br></pre></td></tr></table></figure>

<p>其他系统的安装地址 <a target="_blank" rel="noopener" href="https://github.com/ohmyzsh/ohmyzsh/wiki/Installing-ZSH">zsh-on-github-传送门</a></p>
<p>把默认的 <code>shell</code> 改成 <code>zsh</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">chsh -s /bin/zsh</span><br></pre></td></tr></table></figure>

<h2 id="2-安装-git"><a href="#2-安装-git" class="headerlink" title="2. 安装 git"></a>2. 安装 git</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt-get install git</span><br></pre></td></tr></table></figure>

<h2 id="3-安装-oh-my-zsh"><a href="#3-安装-oh-my-zsh" class="headerlink" title="3. 安装 oh-my-zsh"></a>3. 安装 oh-my-zsh</h2><p>可以使用 <code>curl</code> 或 <code>wget</code> 两种方式来安装</p>
<p><strong>via curl</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sh -c <span class="string">&quot;<span class="subst">$(curl -fsSL https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh)</span>&quot;</span></span><br></pre></td></tr></table></figure>

<p><strong>via wget</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sh -c <span class="string">&quot;<span class="subst">$(wget -O- https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh)</span>&quot;</span></span><br></pre></td></tr></table></figure>

<p>其他系统的安装地址 <a target="_blank" rel="noopener" href="https://github.com/ohmyzsh/ohmyzsh">on-my-zsh-on-github-传送门</a></p>
<blockquote>
<p>注意：</p>
<p>这一步有可能会报错，GitHub 的 raw.githubusercontent.com 无法连接，可直接修改 hosts：</p>
<p>Ubuntu、CentOS 及 macOS 直接在终端输入：</p>
<p><code>sudo vim /etc/hosts</code></p>
<p>添加以下内容保存即可（IP地址可自行查询后修改为延时最低的，也可以直接复制下面的）</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># GitHub Start</span></span><br><span class="line">52.74.223.119 github.com</span><br><span class="line">192.30.253.119 gist.github.com</span><br><span class="line">54.169.195.247 api.github.com</span><br><span class="line">185.199.111.153 assets-cdn.github.com</span><br><span class="line">151.101.76.133 raw.githubusercontent.com</span><br><span class="line">151.101.108.133 user-images.githubusercontent.com</span><br><span class="line">151.101.76.133 gist.githubusercontent.com</span><br><span class="line">151.101.76.133 cloud.githubusercontent.com</span><br><span class="line">151.101.76.133 camo.githubusercontent.com</span><br><span class="line">151.101.76.133 avatars0.githubusercontent.com</span><br><span class="line">151.101.76.133 avatars1.githubusercontent.com</span><br><span class="line">151.101.76.133 avatars2.githubusercontent.com</span><br><span class="line">151.101.76.133 avatars3.githubusercontent.com</span><br><span class="line">151.101.76.133 avatars4.githubusercontent.com</span><br><span class="line">151.101.76.133 avatars5.githubusercontent.com</span><br><span class="line">151.101.76.133 avatars6.githubusercontent.com</span><br><span class="line">151.101.76.133 avatars7.githubusercontent.com</span><br><span class="line">151.101.76.133 avatars8.githubusercontent.com</span><br><span class="line"><span class="comment"># GitHub End</span></span><br></pre></td></tr></table></figure>


<p>参考：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/sinferwu/p/12726833.html">https://www.cnblogs.com/sinferwu/p/12726833.html</a></p>
</blockquote>
<h2 id="4-选择主题-agnoster"><a href="#4-选择主题-agnoster" class="headerlink" title="4. 选择主题 agnoster"></a>4. 选择主题 <code>agnoster</code></h2><p>编辑 <code>~/.zshrc</code> 文件，修改 <code>ZSH_THEME</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ZSH_THEME=<span class="string">&quot;agnoster&quot;</span> <span class="comment"># (this is one of the fancy ones)</span></span><br></pre></td></tr></table></figure>

<p>注意：许多主题需要安装字体 <a target="_blank" rel="noopener" href="https://github.com/powerline/fonts">Powerline Fonts</a> 才能正常显示：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt-get install fonts-powerline</span><br></pre></td></tr></table></figure>

<p>更多主题：<a target="_blank" rel="noopener" href="https://github.com/ohmyzsh/ohmyzsh/wiki/Themes#agnoster">传送门</a></p>
<h2 id="5-安装-zsh-syntax-highlighting-语法高亮插件"><a href="#5-安装-zsh-syntax-highlighting-语法高亮插件" class="headerlink" title="5. 安装 zsh-syntax-highlighting 语法高亮插件"></a>5. 安装 <code>zsh-syntax-highlighting</code> 语法高亮插件</h2><ol>
<li>将此项目下载到 <code>$ZSH_CUSTOM/plugins</code> (默认为： <code>~/.oh-my-zsh/custom/plugins</code>)</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/zsh-users/zsh-syntax-highlighting.git <span class="variable">$&#123;ZSH_CUSTOM:-~/.oh-my-zsh/custom&#125;</span>/plugins/zsh-syntax-highlighting</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>修改 <code>~/.zshrc</code>（添加该插件）</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">plugins=( </span><br><span class="line">	[plugins...] </span><br><span class="line">	zsh-syntax-highlighting</span><br><span class="line">	)</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>重启 zsh（比如重新打开命令窗口或执行 <code>source ~/.zshrc</code>）</li>
</ol>
<p>其他系统的安装地址 <a target="_blank" rel="noopener" href="https://github.com/zsh-users/zsh-syntax-highlighting/blob/master/INSTALL.md">github-传送门</a></p>
<h2 id="6-安装-zsh-autosuggestions-自动提示插件"><a href="#6-安装-zsh-autosuggestions-自动提示插件" class="headerlink" title="6. 安装 zsh-autosuggestions 自动提示插件"></a>6. 安装 <code>zsh-autosuggestions</code> 自动提示插件</h2><ol>
<li>将此项目下载到 <code>$ZSH_CUSTOM/plugins</code> (默认为： <code>~/.oh-my-zsh/custom/plugins</code>)</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/zsh-users/zsh-autosuggestions <span class="variable">$&#123;ZSH_CUSTOM:-~/.oh-my-zsh/custom&#125;</span>/plugins/zsh-autosuggestions</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>修改 <code>~/.zshrc</code>（添加该插件）</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">plugins=( </span><br><span class="line">	[plugins...] </span><br><span class="line">	zsh-autosuggestions</span><br><span class="line">	)</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>重启 zsh（比如重新打开命令窗口或执行 <code>source ~/.zshrc</code>）</li>
</ol>
<p>其他系统的安装地址 <a target="_blank" rel="noopener" href="https://github.com/zsh-users/zsh-autosuggestions/blob/master/INSTALL.md">github-传送门</a></p>
<h2 id="7-安装-autojump-自动跳转插件"><a href="#7-安装-autojump-自动跳转插件" class="headerlink" title="7. 安装 autojump 自动跳转插件"></a>7. 安装 <code>autojump</code> 自动跳转插件</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt-get install autojump</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>修改 <code>~/.zshrc</code>（添加该插件）</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#在最后一行加入，注意点后面是一个空格</span></span><br><span class="line">. /usr/share/autojump/autojump.sh</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>重启 zsh（比如重新打开命令窗口或执行 <code>source ~/.zshrc</code>）</li>
</ol>
<p>其他系统的安装地址 <a target="_blank" rel="noopener" href="https://github.com/wting/autojump">github-传送门</a></p>
<h2 id="8-安装-zsh-completions-补全工具"><a href="#8-安装-zsh-completions-补全工具" class="headerlink" title="8. 安装 zsh-completions 补全工具"></a>8. 安装 <code>zsh-completions</code> 补全工具</h2><ol>
<li>将此项目下载到 <code>$ZSH_CUSTOM/plugins</code> (默认为： <code>~/.oh-my-zsh/custom/plugins</code>)</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/zsh-users/zsh-completions <span class="variable">$&#123;ZSH_CUSTOM:=~/.oh-my-zsh/custom&#125;</span>/plugins/zsh-completions</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>修改 <code>~/.zshrc</code>（添加该插件）</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">plugins=(</span><br><span class="line">	[plugins...]</span><br><span class="line">	zsh-completions</span><br><span class="line">	)</span><br><span class="line"><span class="built_in">autoload</span> -U compinit &amp;&amp; compinit</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>重启 zsh（比如重新打开命令窗口或执行 <code>source ~/.zshrc</code>）</li>
</ol>
<p>其他系统的安装地址 <a target="_blank" rel="noopener" href="https://github.com/zsh-users/zsh-completions">github-传送门</a></p>
<h2 id="9-修改阿里云服务器的主机名"><a href="#9-修改阿里云服务器的主机名" class="headerlink" title="9. 修改阿里云服务器的主机名"></a>9. 修改阿里云服务器的主机名</h2><ol>
<li><p>查看当前主机名</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hostname</span><br></pre></td></tr></table></figure>
</li>
<li><p>修改主机名</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hostnamectl set-hostname XXX</span><br></pre></td></tr></table></figure>
</li>
<li><p>重启服务器（或断开重连）</p>
</li>
</ol>
]]></content>
  </entry>
  <entry>
    <title>jdbc学习笔记01</title>
    <url>/posts/jdbc-xue-xi-bi-ji-01/</url>
    <content><![CDATA[<h2 id="JDBC"><a href="#JDBC" class="headerlink" title="JDBC"></a>JDBC</h2><h3 id="1-概念"><a href="#1-概念" class="headerlink" title="1. 概念"></a>1. 概念</h3><blockquote>
<p>Java DataBase Connectivity Java数据库连接（用Java操作数据库）</p>
</blockquote>
<p>定义了操作所有关系型数据库的规范（接口），实现类（数据库驱动jar包）由各数据库厂商实现用来操作数据库</p>
<h3 id="2-快速入门"><a href="#2-快速入门" class="headerlink" title="2. 快速入门"></a>2. 快速入门</h3><ul>
<li>步骤<ol>
<li>导入驱动jar包 <code>mysql-connector-java-8.0.19.jar</code></li>
<li>注册驱动</li>
<li>获取数据库连接对象 Connection</li>
<li>定义 sql</li>
<li>获取执行 sql 语句的对象 Statement</li>
<li>执行 sql，接收返回的结果</li>
<li>处理结果</li>
<li>释放资源</li>
</ol>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">//1. 导入驱动jar包(复制jar包，右键 add as library)</span></span><br><span class="line">        <span class="comment">//2. 注册驱动</span></span><br><span class="line">        Class.forName(<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>);</span><br><span class="line">        <span class="comment">//或使用下面这种写法（耦合性较高）</span></span><br><span class="line">        <span class="comment">//DriverManager.registerDriver(new com.mysql.cj.jdbc.Driver());</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">//3. 获取数据库连接对象 Connection</span></span><br><span class="line">        Connection connection = DriverManager.getConnection(<span class="string">&quot;jdbc:mysql://localhost:3306/learn?serverTimezone=GMT%2B8&amp;amp;characterEncoding=utf-8&quot;</span>, <span class="string">&quot;root&quot;</span>, <span class="string">&quot;4869&quot;</span>);</span><br><span class="line">        <span class="comment">//4. 定义 sql</span></span><br><span class="line">        String sql = <span class="string">&quot;update user set sex = &#x27;女&#x27; where id = 42&quot;</span>;</span><br><span class="line">        <span class="comment">//5. 获取执行 sql 语句的对象 Statement</span></span><br><span class="line">        Statement stmt = connection.createStatement();</span><br><span class="line">        <span class="comment">//6. 执行 sql，接收返回的结果</span></span><br><span class="line">        <span class="keyword">int</span> count = stmt.executeUpdate(sql);</span><br><span class="line">        <span class="comment">//7. 处理结果</span></span><br><span class="line">        System.out.println(count);</span><br><span class="line">        <span class="comment">//8. 释放资源</span></span><br><span class="line">        stmt.close();</span><br><span class="line">        connection.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-详解各个对象"><a href="#3-详解各个对象" class="headerlink" title="3. 详解各个对象"></a>3. 详解各个对象</h3><ol>
<li><p>DriverManager：驱动管理对象</p>
<ul>
<li><p>功能：</p>
<ol>
<li><p>注册驱动</p>
<blockquote>
<p>static void registerDriver (Driver driver) 使用 <code>DriverManager</code>注册给定的驱动程序</p>
<p>写代码时使用 <code>Class.forName(&quot;com.mysql.cj.jdbc.Driver&quot;);</code></p>
</blockquote>
<blockquote>
<p>另外，发现不注册驱动也能运行成功，这是因为在mysql5之后，在jar包中存在文件<code>mysql-connector-java-8.0.19.jar\META-INF\services\java.sql.Driver</code>，里面写的有默认驱动</p>
</blockquote>
</li>
<li><p>获取数据库连接</p>
<ul>
<li><p>方法：<code>static Connection getConnection(String url, String user, String password)</code></p>
</li>
<li><p>参数：</p>
<ul>
<li><p>url：指定连接的路径</p>
<ul>
<li><p>语法：jdbc:mysql://ip地址（域名）: 端口号/数据库名称?serverTimezone=所在时区</p>
<blockquote>
<p>mysql-jdbc 6.0以上版本需要在连接数据库url后面指定所在时区。<br>中国用的是GMT+8的时区，在jdbc连接的url后面加上东八区的<code>serverTimezone=Asia/Shanghai</code></p>
<p>或</p>
<p><code>serverTimezone=Hongkong</code></p>
<p>或</p>
<p><code>serverTimezone=GMT%2B8</code>（%2B是“+”号）</p>
<p>即可解决问题</p>
</blockquote>
</li>
<li><p>例子：<code>jdbc:mysql://localhost:3306/learn?serverTimezone=Hongkong</code></p>
</li>
<li><p>细节：如果连接的是本机mysql服务器，并且mysql服务的默认端口是3306，则url可以简写为：<code>jdbc:mysql:///数据库名称?serverTimezone=时区名称</code></p>
</li>
</ul>
</li>
<li><p>user：用户名</p>
</li>
<li><p>password：密码</p>
</li>
</ul>
</li>
</ul>
</li>
</ol>
</li>
</ul>
</li>
<li><p>Connection：数据库连接对象</p>
<ol>
<li>功能：<ol>
<li>获取执行 sql 的对象<ul>
<li><code>Statement createStatement()</code></li>
<li><code>PreparedStatement prepareStatement(String sql)</code></li>
</ul>
</li>
<li>管理事务<ul>
<li>开启事务：<code>setAutoCommit(boolean autoCommit)</code>：调用该方法设置参数为<code>false</code>即开启事务</li>
<li>提交事务：<code>commit()</code></li>
<li>回滚事务：<code>rollback()</code></li>
</ul>
</li>
</ol>
</li>
</ol>
</li>
<li><p>Statement：执行sql对象</p>
<ol>
<li>执行 sql<ol>
<li><code>boolean execute(String sql)</code>：可以执行任意的 sql 了解</li>
<li><code>int executeUpdate(String sql)</code>：执行 DML（insert、update、delete）语句、DDL语句（create、alter、drop）语句<ul>
<li>返回值：影响的行数，可以通过这个影响的行数判断 DML 语句是否执行成功，返回值 &gt; 0执行成功</li>
</ul>
</li>
<li><code>ResultSet executeQuery(String sql)</code>：执行 DQL（select）语句<ul>
<li>（其返回值和 2. 不同）</li>
</ul>
</li>
</ol>
</li>
</ol>
</li>
<li><p>ResultSet：结果集对象，封装查询结果</p>
<ul>
<li><p><code>boolean next()</code>：光标向下移动一行</p>
</li>
<li><p><code>getXxx(参数)</code>：获取数据</p>
<ul>
<li><code>Xxx</code>代表数据类型，如<code>int getInt(）</code>,<code>getString()</code></li>
<li>参数：<ol>
<li>int：代表列的编号，<strong>从 1 开始</strong> ，如：<code>getString(1)</code></li>
<li>String：代表列名称，如：<code>getDouble(&quot;balance&quot;)</code></li>
</ol>
</li>
</ul>
</li>
<li><p>注意：</p>
<ul>
<li><p>使用步骤：</p>
<ol>
<li>游标向下移动一行</li>
<li>判断是否有数据</li>
<li>获取数据</li>
</ol>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">String sql = <span class="string">&quot;select * from user&quot;</span>;</span><br><span class="line"><span class="comment">//5. 获取执行 sql 语句的对象 Statement</span></span><br><span class="line">Statement stmt = connection.createStatement();</span><br><span class="line"><span class="comment">//6. 执行 sql，接收返回的结果</span></span><br><span class="line">ResultSet rs = stmt.executeQuery(sql);</span><br><span class="line"><span class="comment">//7. 处理结果</span></span><br><span class="line"><span class="comment">// 循环判断游标是否是最后一行末尾</span></span><br><span class="line"><span class="keyword">while</span> (rs.next())&#123;</span><br><span class="line">    <span class="keyword">int</span> id = rs.getInt(<span class="number">1</span>);</span><br><span class="line">    String name = rs.getString(<span class="string">&quot;username&quot;</span>);</span><br><span class="line">    System.out.println(<span class="string">&quot;id = &quot;</span> + id + <span class="string">&quot; username = &quot;</span> + name);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
</li>
<li><p>PreparedStatement：执行sql对象</p>
<ol>
<li><p>SQL 注入问题：在拼接sql时，有一些sql的特殊关键字参与字符串的拼接。会造成安全问题</p>
<ol>
<li>输入用户名随便，输入密码：<code>a&#39; or ‘a&#39; = ‘a</code></li>
<li>sql：<code>select * from user where username = ‘asdad‘ and password = ‘a&#39; or ‘a‘ = ‘a&#39;</code></li>
</ol>
</li>
<li><p>解决sql注入问题：使用PreparedStatement对象来解决</p>
</li>
<li><p>预编译的sql：参数使用<code>?</code>作为占位符，用户的输入只是给占位符赋值</p>
</li>
<li><p>步骤：</p>
<ol>
<li>导入驱动jar包 <code>mysql-connector-java-8.0.19.jar</code></li>
<li>注册驱动</li>
<li>获取数据库连接对象 Connection</li>
<li>定义 sql<ul>
<li>注意：sql的参数使用<code>?</code>作为占位符。如：<code>select * from user where username = ? and password = ?;</code></li>
</ul>
</li>
<li>获取执行 sql 语句的对象 PrepareStatement <code>Connection.prepareStatement(String sql)</code></li>
<li>给 <code>?</code> 赋值：<ul>
<li>方法：<code>setXxx(参数1, 参数2)</code><ul>
<li>参数1：<code>?</code>的位置编号，从 1 开始</li>
<li>参数2：<code>?</code>的值</li>
</ul>
</li>
</ul>
</li>
<li>执行 sql，接收返回的结果</li>
<li>处理结果</li>
<li>释放资源</li>
</ol>
</li>
<li><p><strong>后期都会使用PreparedStatement来完成增删改查的所有操作</strong></p>
<ol>
<li>可以防止SQL注入</li>
<li>效率更高</li>
</ol>
</li>
<li><p>代码示例：(可以防止 sql 注入)</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    ResultSet rs = <span class="keyword">null</span>;</span><br><span class="line">    PreparedStatement pstmt = <span class="keyword">null</span>;</span><br><span class="line">    Connection connection = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        connection = JDBCUtils.getConnection();</span><br><span class="line">        <span class="comment">//4. 定义 sql</span></span><br><span class="line">        String sql = <span class="string">&quot;select * from user where username = ? and sex = ?&quot;</span>;</span><br><span class="line">        <span class="comment">//5. 获取执行 sql 语句的对象 PreparedStatement</span></span><br><span class="line">        pstmt = connection.prepareStatement(sql);</span><br><span class="line">        <span class="comment">//6. 给 ? 赋值</span></span><br><span class="line">        pstmt.setString(<span class="number">1</span>,<span class="string">&quot;ascasc&quot;</span>);</span><br><span class="line">        pstmt.setString(<span class="number">2</span>,<span class="string">&quot;a&#x27; or ‘a‘ = ‘a&quot;</span>);</span><br><span class="line">        <span class="comment">//7. 执行查询，不需要传参</span></span><br><span class="line">        rs = pstmt.executeQuery();</span><br><span class="line">        <span class="comment">//8. 判断,输出为 false</span></span><br><span class="line">        System.out.println(rs.next());</span><br><span class="line">    &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        JDBCUtils.close(rs,pstmt,connection);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



</li>
</ol>
</li>
</ol>
<h2 id="抽取JDBC工具类：JDBCUtils"><a href="#抽取JDBC工具类：JDBCUtils" class="headerlink" title="抽取JDBC工具类：JDBCUtils"></a>抽取JDBC工具类：JDBCUtils</h2><ul>
<li><p>目的：简化书写</p>
</li>
<li><p>分析：</p>
<ol>
<li><p>抽取注册驱动</p>
</li>
<li><p>抽取一个方法获取连接对象</p>
<ul>
<li><p>需求：不传递参数，同时保证工具类的通用性</p>
</li>
<li><p>解决：配置文件(<code>src/jdbc.properties</code>)</p>
<figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="attr">url</span>=<span class="string">jdbc:mysql:///learn?serverTimezone=Hongkong</span></span><br><span class="line"><span class="attr">user</span>=<span class="string">root</span></span><br><span class="line"><span class="attr">password</span>=<span class="string">4869</span></span><br><span class="line"><span class="attr">driver</span>=<span class="string">com.mysql.cj.jdbc.Driver</span></span><br></pre></td></tr></table></figure>



</li>
</ul>
</li>
</ol>
</li>
</ul>
<ol start="3">
<li><p>抽取一个方法释放资源</p>
<p>代码示例：</p>
<p><code>JDBCUtils.java</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.conv.util;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.FileReader;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.net.URL;</span><br><span class="line"><span class="keyword">import</span> java.sql.*;</span><br><span class="line"><span class="keyword">import</span> java.util.Properties;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * JDBC工具类</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JDBCUtils</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String url;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String user;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String password;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String driver;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 文件的读取，只需要读取一次即可拿到这些值，使用静态代码块</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//1. 读取资源文件，获取值</span></span><br><span class="line">            Properties pro = <span class="keyword">new</span> Properties();</span><br><span class="line"></span><br><span class="line">            <span class="comment">//2. 加载文件</span></span><br><span class="line">            <span class="comment">//方法 1（实测不可行）</span></span><br><span class="line">            <span class="comment">// 获取src路径下的文件的方式-----&gt;ClassLoader 类加载器</span></span><br><span class="line"><span class="comment">//            ClassLoader classLoader = JDBCUtils.class.getClassLoader();</span></span><br><span class="line"><span class="comment">//            // 根路径是 src 目录，所以只用写相对路径就行</span></span><br><span class="line"><span class="comment">//            URL res = classLoader.getResource(&quot;jdbc.properties&quot;);</span></span><br><span class="line"><span class="comment">//            String path = res != null ? res.getPath() : null;</span></span><br><span class="line"><span class="comment">//            System.out.println(path);</span></span><br><span class="line"><span class="comment">//            if (path != null) &#123;</span></span><br><span class="line"><span class="comment">//                pro.load(new FileReader(path));</span></span><br><span class="line"><span class="comment">//            &#125;</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">//方法 2</span></span><br><span class="line">            <span class="comment">// 该行代码实测是可行的（可能java8不行？）若不行的话可采用上面的方法</span></span><br><span class="line">            pro.load(<span class="keyword">new</span> FileReader(<span class="string">&quot;src/jdbc.properties&quot;</span>));</span><br><span class="line">            <span class="comment">//3. 获取数据，赋值</span></span><br><span class="line">            url = pro.getProperty(<span class="string">&quot;url&quot;</span>);</span><br><span class="line">            user = pro.getProperty(<span class="string">&quot;user&quot;</span>);</span><br><span class="line">            password = pro.getProperty(<span class="string">&quot;password&quot;</span>);</span><br><span class="line">            driver = pro.getProperty(<span class="string">&quot;driver&quot;</span>);</span><br><span class="line">            <span class="comment">//4. 注册驱动</span></span><br><span class="line">            Class.forName(driver);</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException | ClassNotFoundException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取连接</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 连接对象</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> SQLException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Connection <span class="title">getConnection</span><span class="params">()</span> <span class="keyword">throws</span> SQLException </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> DriverManager.getConnection(url, user, password);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 关闭资源</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> statement</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> connection</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">(Statement statement, Connection connection)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (statement != <span class="keyword">null</span>) &#123;</span><br><span class="line">                statement.close();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (connection != <span class="keyword">null</span>) &#123;</span><br><span class="line">                connection.close();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 关闭资源</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> resultSet</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> statement</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> connection</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">(ResultSet resultSet, Statement statement, Connection connection)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (resultSet != <span class="keyword">null</span>) &#123;</span><br><span class="line">                resultSet.close();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (statement != <span class="keyword">null</span>) &#123;</span><br><span class="line">                statement.close();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (connection != <span class="keyword">null</span>) &#123;</span><br><span class="line">                connection.close();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>main.java</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.conv.jdbc;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.conv.util.JDBCUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        ResultSet rs = <span class="keyword">null</span>;</span><br><span class="line">        Statement stmt = <span class="keyword">null</span>;</span><br><span class="line">        Connection connection = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            connection = JDBCUtils.getConnection();</span><br><span class="line">            <span class="comment">//4. 定义 sql</span></span><br><span class="line">            <span class="comment">//String sql = &quot;update user set sex = &#x27;男&#x27; where id = 42&quot;;</span></span><br><span class="line">            String sql = <span class="string">&quot;select * from user&quot;</span>;</span><br><span class="line">            <span class="comment">//5. 获取执行 sql 语句的对象 Statement</span></span><br><span class="line">            stmt = connection.createStatement();</span><br><span class="line">            <span class="comment">//6. 执行 sql，接收返回的结果</span></span><br><span class="line">            rs = stmt.executeQuery(sql);</span><br><span class="line">            <span class="comment">//7. 处理结果</span></span><br><span class="line">            <span class="keyword">while</span> (rs.next()) &#123;</span><br><span class="line">                <span class="keyword">int</span> id = rs.getInt(<span class="number">1</span>);</span><br><span class="line">                String name = rs.getString(<span class="string">&quot;username&quot;</span>);</span><br><span class="line">                System.out.println(<span class="string">&quot;id = &quot;</span> + id + <span class="string">&quot; username = &quot;</span> + name);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            JDBCUtils.close(rs,stmt,connection);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<ul>
<li><p>sql 语句拼接Java中的变量</p>
<blockquote>
<p>java中的字符串只能双引号（js可以单引号也可以双引号）引上，如果字符串中需要拼接变量，该变量用单引号括起来，然后加两个双引号再加两个加号，中间就是变量</p>
</blockquote>
<p>例：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">String username, password;	<span class="comment">//username 和 password 已经定义</span></span><br><span class="line">String sql = “select * from user where username = <span class="string">&#x27;&quot;+username+&quot;&#x27;</span> and password = <span class="string">&#x27;&quot;+password+&quot;&#x27;</span>”</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="JDBC-控制事务"><a href="#JDBC-控制事务" class="headerlink" title="JDBC 控制事务"></a>JDBC 控制事务</h2><ol>
<li><p>事务：一个包含多个步骤的业务操作。如果这个业务操作被事务管理，则这多个步骤要么同时成功，要么同时失败</p>
</li>
<li><p>操作：</p>
<ol>
<li>开启事务：</li>
<li>提交事务</li>
<li>回滚事务</li>
</ol>
</li>
<li><p>使用Connection对象来管理事务</p>
<ul>
<li>开启事务：<code>setAutoCommit(boolean autoCommit)</code>：调用该方法设置参数为<code>false</code>即开启事务<ul>
<li>在执行sql之前开启事务</li>
</ul>
</li>
<li>提交事务：<code>commit()</code><ul>
<li>当所有sql都执行完提交事务</li>
</ul>
</li>
<li>回滚事务：<code>rollback()</code><ul>
<li>在catch中回滚事务</li>
</ul>
</li>
</ul>
</li>
<li><p>代码示例：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    ResultSet rs = <span class="keyword">null</span>;</span><br><span class="line">    PreparedStatement pstmt1 = <span class="keyword">null</span>;</span><br><span class="line">    PreparedStatement pstmt2 = <span class="keyword">null</span>;</span><br><span class="line">    Connection connection = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">//1. 获取连接</span></span><br><span class="line">        connection = JDBCUtils.getConnection();</span><br><span class="line">        <span class="comment">//开启事务</span></span><br><span class="line">        connection.setAutoCommit(<span class="keyword">false</span>);</span><br><span class="line">        <span class="comment">//2.定义 sql</span></span><br><span class="line">        <span class="comment">//2.1 张三 - 300</span></span><br><span class="line">        String sql1 = <span class="string">&quot;update account set money = money - ? where id = ?&quot;</span>;</span><br><span class="line">        <span class="comment">//2.2 李四 + 300</span></span><br><span class="line">        String sql2 = <span class="string">&quot;update account set money = money + ? where id = ?&quot;</span>;</span><br><span class="line">        <span class="comment">//3. 获取执行sql对象</span></span><br><span class="line">        pstmt1 = connection.prepareStatement(sql1);</span><br><span class="line">        pstmt2 = connection.prepareStatement(sql2);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//4. 设置参数</span></span><br><span class="line">        pstmt1.setInt(<span class="number">1</span>, <span class="number">300</span>);</span><br><span class="line">        pstmt1.setInt(<span class="number">2</span>, <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">        pstmt2.setInt(<span class="number">1</span>, <span class="number">300</span>);</span><br><span class="line">        pstmt2.setInt(<span class="number">2</span>, <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//5. 执行sql</span></span><br><span class="line">        pstmt1.executeUpdate();</span><br><span class="line">        <span class="comment">//手动制造异常</span></span><br><span class="line">        <span class="keyword">int</span> i = <span class="number">1</span> / <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        pstmt2.executeUpdate();</span><br><span class="line"></span><br><span class="line">        connection.commit();</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        <span class="comment">//事务回滚(回滚到事务开启之前的状态)</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (connection != <span class="keyword">null</span>) &#123;</span><br><span class="line">                connection.rollback();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException ex) &#123;</span><br><span class="line">            ex.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        JDBCUtils.close(pstmt1, connection);</span><br><span class="line">        JDBCUtils.close(pstmt2, <span class="keyword">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ol>
]]></content>
      <categories>
        <category>JDBC</category>
      </categories>
      <tags>
        <tag>JDBC</tag>
      </tags>
  </entry>
  <entry>
    <title>jdbc学习笔记02</title>
    <url>/posts/jdbc-xue-xi-bi-ji-02/</url>
    <content><![CDATA[<h2 id="数据库连接池"><a href="#数据库连接池" class="headerlink" title="数据库连接池"></a>数据库连接池</h2><h3 id="概念："><a href="#概念：" class="headerlink" title="概念："></a>概念：</h3><blockquote>
<p> 其实就是一个容器（集合），存放数据库连接的容器</p>
</blockquote>
<ul>
<li>当系统初始化好后，容器被创建，容器会申请一些连接对象，当用户来访问数据库时，从容器中获取连接对象，用户访问完之后，会将连接对象归还给容器。</li>
</ul>
<h3 id="好处"><a href="#好处" class="headerlink" title="好处"></a>好处</h3><ol>
<li>节约资源</li>
<li>用户访问高效</li>
</ol>
<h3 id="实现："><a href="#实现：" class="headerlink" title="实现："></a>实现：</h3><ol>
<li>标准接口：<code>DataSource</code>     <code>javax.sql</code>包下的<ol>
<li>方法;<ul>
<li>获取连接：<code>getConnection()</code></li>
<li>归还连接：<code>Connection.close()</code>。如果连接对象Connection是从连接池中获取的，那么调用<code>Connection.close()</code>方法，则不会关闭连接了，而是归还连接</li>
</ul>
</li>
</ol>
</li>
<li>一般我们不去实现它，由数据库厂商来实现<ol>
<li>C3P0：数据库连接池技术</li>
<li>Druid：数据库连接池技术，由阿里巴巴提供的</li>
</ol>
</li>
</ol>
<h3 id="C3P0：数据库连接池技术"><a href="#C3P0：数据库连接池技术" class="headerlink" title="C3P0：数据库连接池技术"></a>C3P0：数据库连接池技术</h3><ul>
<li><p>步骤：</p>
<ol>
<li><p>导入jar包（三个） <code>c3p0-0.9.5.5.jar</code>, <code>mchange-commons-java-0.2.19.jar</code></p>
<ul>
<li>不要忘记导入数据库jar包：<code>mysql-connector-java-8.0.19.jar</code></li>
</ul>
</li>
<li><p>定义配置文件：</p>
<ul>
<li>名称：<code>c3p0.properties</code> 或者 <code>c3p0-config.xml</code></li>
<li>路径：直接将文件放在<code>src</code>目录下即可</li>
</ul>
<p>示例：<code>c3p0-config.xml</code>：</p>
</li>
</ol>
</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">c3p0-config</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--默认配置，无参数时使用该配置--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">default-config</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--连接参数--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driverClass&quot;</span>&gt;</span>com.mysql.cj.jdbc.Driver<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;jdbcUrl&quot;</span>&gt;</span>jdbc:mysql:///learn?serverTimezone=Hongkong<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;user&quot;</span>&gt;</span>root<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span>&gt;</span>4869<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!--连接池参数--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--初始化连接池中申请的连接数量--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;initialPoolSize&quot;</span>&gt;</span>5<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--连接池中最大的的连接数量--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;maxPoolSize&quot;</span>&gt;</span>10<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--超时时间：3s--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;checkoutTimeout&quot;</span>&gt;</span>3000<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">default-config</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--自定义配置，传递参数为 otherc3p0 时使用该配置文件--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">named-config</span> <span class="attr">name</span>=<span class="string">&quot;otherc3p0&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--连接参数--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driverClass&quot;</span>&gt;</span>com.mysql.cj.jdbc.Driver<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;jdbcUrl&quot;</span>&gt;</span>jdbc:mysql://localhost:3306/learn?serverTimezone=UTC<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;user&quot;</span>&gt;</span>root<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span>&gt;</span>4869<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!--连接池参数--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;initialPoolSize&quot;</span>&gt;</span>5<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;maxPoolSize&quot;</span>&gt;</span>8<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;checkoutTimeout&quot;</span>&gt;</span>1000<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">named-config</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">c3p0-config</span>&gt;</span></span><br></pre></td></tr></table></figure>


<ol start="3">
<li><p>创建核心对象 数据库连接池对象 <code>ComboPooledDataSource()</code></p>
</li>
<li><p>获取连接：<code>getConnection()</code></p>
</li>
<li><p>代码示例：</p>
</li>
</ol>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> SQLException </span>&#123;</span><br><span class="line">    <span class="comment">//1. 创建数据库连接池对象</span></span><br><span class="line">    <span class="comment">//DataSource ds = new ComboPooledDataSource();</span></span><br><span class="line">    DataSource ds = <span class="keyword">new</span> ComboPooledDataSource(<span class="string">&quot;otherc3p0&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//2. 获取连接对象</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">11</span>; i++) &#123;</span><br><span class="line">        Connection conn = ds.getConnection();</span><br><span class="line">        <span class="comment">//3. 输出</span></span><br><span class="line">        System.out.println(i + <span class="string">&quot;:&quot;</span> + conn);</span><br><span class="line">        <span class="keyword">if</span>(i == <span class="number">5</span>)  <span class="comment">//归还连接</span></span><br><span class="line">            conn.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Druid：数据库连接池技术，由阿里巴巴提供"><a href="#Druid：数据库连接池技术，由阿里巴巴提供" class="headerlink" title="Druid：数据库连接池技术，由阿里巴巴提供"></a>Druid：数据库连接池技术，由阿里巴巴提供</h3><ol>
<li><p>步骤：</p>
<ol>
<li><p>导入jar包 <code>lib/druid-1.1.21.jar</code>, <code>lib/mysql-connector-java-8.0.19.jar</code></p>
</li>
<li><p>定义配置文件：</p>
<ul>
<li>是<code>.properties</code>形式的</li>
<li>可以叫任意名称，可以放在任意目录下</li>
</ul>
</li>
<li><p>加载配置文件：<code>Properties</code></p>
</li>
<li><p>获取数据库连接池对象：通过工厂来获取 <code>DruidDataSourceFactory()</code></p>
</li>
<li><p>获取连接：<code>getConnection()</code> </p>
</li>
<li><p>代码示例：</p>
</li>
</ol>
</li>
</ol>
<p><code>Druid.properties</code></p>
<figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="attr">driverClassName</span>=<span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line"><span class="attr">url</span>=<span class="string">jdbc:mysql://localhost:3306/learn?serverTimezone=Hongkong</span></span><br><span class="line"><span class="attr">username</span>=<span class="string">root</span></span><br><span class="line"><span class="attr">password</span>=<span class="string">4869</span></span><br><span class="line"><span class="comment"># 初始化连接数量</span></span><br><span class="line"><span class="attr">initialSize</span>=<span class="string">5</span></span><br><span class="line"><span class="comment"># 最大连接数</span></span><br><span class="line"><span class="attr">maxActive</span>=<span class="string">10</span></span><br><span class="line"><span class="comment"># 超时时间</span></span><br><span class="line"><span class="attr">maxWait</span>=<span class="string">3000</span></span><br></pre></td></tr></table></figure>

<p><code>.java</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DruidTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    <span class="comment">//1. 导入 jar 包</span></span><br><span class="line">    <span class="comment">//2.导入配置文件</span></span><br><span class="line">    <span class="comment">//3. 加载配置文件</span></span><br><span class="line">    Properties pro = <span class="keyword">new</span> Properties();</span><br><span class="line">    <span class="comment">//法1</span></span><br><span class="line">    <span class="comment">//pro.load(new FileReader(&quot;src/druid.properties&quot;));</span></span><br><span class="line">    <span class="comment">//法2</span></span><br><span class="line">    InputStream inputStream = DruidTest.class.getClassLoader().getResourceAsStream(<span class="string">&quot;druid.properties&quot;</span>);</span><br><span class="line">    pro.load(inputStream);</span><br><span class="line">    <span class="comment">//4. 获取连接池对象</span></span><br><span class="line">    DataSource dataSource = DruidDataSourceFactory.createDataSource(pro);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//5. 获取连接</span></span><br><span class="line">    Connection connection = dataSource.getConnection();</span><br><span class="line">    System.out.println(connection);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li><p>定义工具类：</p>
<ol>
<li><p>定义一个类 <code>JDBCUtils</code></p>
</li>
<li><p>提供静态代码块加载配置文件，初始化连接池对象</p>
<ol>
<li>获取连接方法：通过数据库连接池获取连接</li>
<li>释放资源</li>
<li>获取连接池的方法</li>
</ol>
</li>
<li><p>代码示例：</p>
</li>
</ol>
</li>
</ol>
<p><code>JDBCUtils.java</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Druid连接池的工具类</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JDBCUtils</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> DataSource ds;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//1. 加载配置文件</span></span><br><span class="line">            Properties pro = <span class="keyword">new</span> Properties();</span><br><span class="line">            pro.load(Objects.requireNonNull(JDBCUtils.class.getClassLoader().getResourceAsStream(<span class="string">&quot;druid.properties&quot;</span>)));</span><br><span class="line">            <span class="comment">//2. 获取DataSource</span></span><br><span class="line">            ds = DruidDataSourceFactory.createDataSource(pro);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取连接</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 连接对象</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> SQLException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Connection <span class="title">getConnection</span><span class="params">()</span> <span class="keyword">throws</span> SQLException </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ds.getConnection();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 归还连接</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> statement</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> connection</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">(Statement statement, Connection connection)</span> </span>&#123;</span><br><span class="line">        close(<span class="keyword">null</span>, statement, connection);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 归还连接</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> resultSet</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> statement</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> connection</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">(ResultSet resultSet, Statement statement, Connection connection)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (resultSet != <span class="keyword">null</span>) &#123;</span><br><span class="line">                resultSet.close();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (statement != <span class="keyword">null</span>) &#123;</span><br><span class="line">                statement.close();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (connection != <span class="keyword">null</span>) &#123;</span><br><span class="line">                connection.close();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取连接池方法</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 连接池</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> DataSource <span class="title">getDataSource</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ds;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>.java</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"> <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">     Connection conn = <span class="keyword">null</span>;</span><br><span class="line">     PreparedStatement pstmt = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">     <span class="keyword">try</span> &#123;</span><br><span class="line"><span class="comment">//1. 获取连接</span></span><br><span class="line">         conn = JDBCUtils.getConnection();</span><br><span class="line"><span class="comment">//2. 定义sql</span></span><br><span class="line">         String sql = <span class="string">&quot;insert into user (id, username, sex) values(?, ?, ?)&quot;</span>;</span><br><span class="line"><span class="comment">//3. 获取pstmt对象</span></span><br><span class="line">         pstmt = conn.prepareStatement(sql);</span><br><span class="line"><span class="comment">//4. 给 ? 赋值</span></span><br><span class="line">         pstmt.setInt(<span class="number">1</span>, <span class="number">50</span>);</span><br><span class="line">         pstmt.setString(<span class="number">2</span>,<span class="string">&quot;老黄&quot;</span>);</span><br><span class="line">         pstmt.setString(<span class="number">3</span>, <span class="string">&quot;男&quot;</span>);</span><br><span class="line"><span class="comment">//5. 执行sql</span></span><br><span class="line">         <span class="keyword">int</span> count = pstmt.executeUpdate();</span><br><span class="line">         System.out.println(count);</span><br><span class="line"></span><br><span class="line">     &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">         e.printStackTrace();</span><br><span class="line">     &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">         JDBCUtils.close(pstmt, conn);</span><br><span class="line">     &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<h2 id="Spring-JDBC-JDBC-Template"><a href="#Spring-JDBC-JDBC-Template" class="headerlink" title="Spring JDBC : JDBC Template"></a>Spring JDBC : JDBC Template</h2><ul>
<li><p>Spring 框架对 JDBC 的简单封装。提供了一个<code>JDBCTemplate</code>对象简化JDBC的开发</p>
</li>
<li><p>步骤：</p>
<ol>
<li><p>导入jar包</p>
</li>
<li><p>创建<code>JdbcTemplate</code>对象。依赖于数据源<code>DataSource</code></p>
<ul>
<li><code>JdbcTemplate template = new JdbcTemplate(ds);</code></li>
</ul>
</li>
<li><p>调用<code>JdbcTemplate</code>的方法来完成CRUD的操作</p>
<ul>
<li><code>update()</code>：执行DML语句。增、删、改语句</li>
<li><code>queryForMap()</code>：查询结果将结果封装为map集合：将列名作为key，将值作为value，将这条记录封装为一个map集合<ul>
<li>注意：这个方法查询的结果集长度只能是1，即只能有一条记录</li>
</ul>
</li>
<li><code>queryForList()</code>：查询结果将结果封装为list集合<ul>
<li>注意：这个方法是将每一条记录封装为Map集合，再将Map集合装载到List集合中</li>
</ul>
</li>
</ul>
</li>
</ol>
<ul>
<li><code>query()</code>：查询结果将结果封装为JavaBean对象<ul>
<li><code>query</code>的参数：<code>RowMapper</code></li>
<li>一般我们使用<code>BeanPropertyRowMapper</code>实现类，可以完成数据到JavaBean的自动封装<ul>
<li><code>new BeanPropertyRowMapper&lt;类型&gt;(类型.class)</code></li>
</ul>
</li>
<li><code>queryForObject()</code>：查询结果将结果封装为基本数据类型的集合<ul>
<li>一般用于聚合函数的查询</li>
</ul>
</li>
</ul>
</li>
</ul>
<ol start="4">
<li>代码示例：</li>
</ol>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//1. 导入jar包</span></span><br><span class="line">    <span class="comment">//2. 创建JDBCTemplate对象</span></span><br><span class="line">    JdbcTemplate template = <span class="keyword">new</span> JdbcTemplate(JDBCUtils.getDataSource());</span><br><span class="line">    <span class="comment">//3. 调用方法</span></span><br><span class="line">    String sql = <span class="string">&quot;update account set money = 1000 where id &lt; ?&quot;</span>;</span><br><span class="line">    <span class="keyword">int</span> count = template.update(sql,<span class="number">3</span>);</span><br><span class="line">    System.out.println(count);</span><br><span class="line">    <span class="comment">//无需关心归还连接池的问题</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="5">
<li>代码示例 2（maven项目）：</li>
</ol>
<p><code>pom.xml</code>（部分）</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- https://mvnrepository.com/artifact/com.alibaba/druid --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>druid<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.1.21<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- https://mvnrepository.com/artifact/mysql/mysql-connector-java --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>8.0.19<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.springframework/spring-jdbc --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-jdbc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.2.3.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- https://mvnrepository.com/artifact/junit/junit --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.13<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><code>Emp.java</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.conv.domain;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Emp</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 最好写引用数据类型而不是基本数据类型，这样便于接收 null</span></span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    <span class="keyword">private</span> Date birthday;</span><br><span class="line">    <span class="keyword">private</span> String sex;</span><br><span class="line">    <span class="keyword">private</span> String address;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Integer <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getUsername</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> username;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUsername</span><span class="params">(String username)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.username = username;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Date <span class="title">getBirthday</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> birthday;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setBirthday</span><span class="params">(Date birthday)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.birthday = birthday;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getSex</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> sex;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSex</span><span class="params">(String sex)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.sex = sex;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getAddress</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> address;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAddress</span><span class="params">(String address)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.address = address;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Emp&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;id=&quot;</span> + id +</span><br><span class="line">                <span class="string">&quot;, username=&#x27;&quot;</span> + username + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, birthday=&quot;</span> + birthday +</span><br><span class="line">                <span class="string">&quot;, sex=&#x27;&quot;</span> + sex + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, address=&#x27;&quot;</span> + address + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>AppTest.java</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.conv;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.conv.domain.Emp;</span><br><span class="line"><span class="keyword">import</span> com.conv.utils.JDBCUtils;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> org.springframework.jdbc.core.BeanPropertyRowMapper;</span><br><span class="line"><span class="keyword">import</span> org.springframework.jdbc.core.JdbcTemplate;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Unit test for simple App.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AppTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> JdbcTemplate template = <span class="keyword">new</span> JdbcTemplate(JDBCUtils.getDataSource());</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 1. 修改数据</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Test1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        String sql = <span class="string">&quot;update user set sex = &#x27;女&#x27; where id = 41&quot;</span>;</span><br><span class="line">        <span class="keyword">int</span> count = template.update(sql);</span><br><span class="line">        System.out.println(count);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 2. 添加一条记录</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        String sql = <span class="string">&quot;insert into user values(?,?,?,?,?)&quot;</span>;</span><br><span class="line">        <span class="keyword">int</span> count = template.update(sql, <span class="keyword">null</span>, <span class="string">&quot;梁非凡&quot;</span>, <span class="string">&quot;2019-12-30 23:59:59&quot;</span>, <span class="string">&quot;女&quot;</span>, <span class="string">&quot;湖北武汉&quot;</span>);</span><br><span class="line">        System.out.println(count);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 3. 删除记录</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test3</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        String sql = <span class="string">&quot;delete from user where username = ?&quot;</span>;</span><br><span class="line">        <span class="keyword">int</span> count = template.update(sql, <span class="string">&quot;梁非凡&quot;</span>);</span><br><span class="line">        System.out.println(count);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 4. 查询id为41的记录，并将其封装为Map集合</span></span><br><span class="line"><span class="comment">     * 注意：这个方法查询的结果集长度只能是1</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test4</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        String sql = <span class="string">&quot;select * from user where id = ?&quot;</span>;</span><br><span class="line">        Map&lt;String, Object&gt; map = template.queryForMap(sql, <span class="number">41</span>);</span><br><span class="line">        System.out.println(map);</span><br><span class="line">        <span class="comment">//&#123;id=41, username=老王, birthday=2018-02-28 01:47:08.0, sex=女, address=北京&#125;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 5. 查询所有记录，并将其封装为List集合</span></span><br><span class="line"><span class="comment">     * 注意：这个方法是将每一条记录封装为Map集合，再将Map集合装载到List集合中</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test5</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        String sql = <span class="string">&quot;select * from user&quot;</span>;</span><br><span class="line">        List&lt;Map&lt;String, Object&gt;&gt; list = template.queryForList(sql);</span><br><span class="line">        <span class="keyword">for</span> (Map&lt;String, Object&gt; stringObjectMap : list) &#123;</span><br><span class="line">            System.out.println(stringObjectMap);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 6. 查询所有记录，并将其封装为Emp对象的List集合</span></span><br><span class="line"><span class="comment">     * 注意：这个方法是将每一条记录封装为Map集合，再将Map集合装载到List集合中</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test6</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        String sql = <span class="string">&quot;select * from user&quot;</span>;</span><br><span class="line">        List&lt;Emp&gt; list = template.query(sql, <span class="keyword">new</span> BeanPropertyRowMapper&lt;Emp&gt;(Emp.class));</span><br><span class="line">        <span class="keyword">for</span> (Emp emp : list) &#123;</span><br><span class="line">            System.out.println(emp);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 7. 查询总记录数</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test7</span><span class="params">()</span></span>&#123;</span><br><span class="line">        String sql = <span class="string">&quot;select count(id) from user&quot;</span>;</span><br><span class="line">        Long total = template.queryForObject(sql, Long.class);</span><br><span class="line">        System.out.println(total);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>​     </p>
]]></content>
      <categories>
        <category>JDBC</category>
      </categories>
      <tags>
        <tag>JDBC</tag>
      </tags>
  </entry>
  <entry>
    <title>电路基础01</title>
    <url>/posts/dian-lu-ji-chu-01/</url>
    <content><![CDATA[<h2 id="电路与电路模型"><a href="#电路与电路模型" class="headerlink" title="电路与电路模型"></a>电路与电路模型</h2><h3 id="物理公式回顾"><a href="#物理公式回顾" class="headerlink" title="物理公式回顾"></a>物理公式回顾</h3><table>
<thead>
<tr>
<th>物理量</th>
<th>符号表示</th>
<th>计算公式</th>
<th>单位</th>
</tr>
</thead>
<tbody><tr>
<td>电流</td>
<td>$I$</td>
<td>$\cfrac{dq}{dt}$</td>
<td>安培（$A$）</td>
</tr>
<tr>
<td>电压</td>
<td>$U$</td>
<td>$\cfrac{dw}{dq}$</td>
<td>伏特（$V$）</td>
</tr>
<tr>
<td>功率</td>
<td>$P(t)$</td>
<td>$\cfrac{dw(t)}{dt}=\cfrac{dw(t)}{dq}·\cfrac{dq}{dt}=u(t)i(t)$</td>
<td>瓦特（$W$）</td>
</tr>
<tr>
<td>能量</td>
<td>$W(t)$</td>
<td>$\int_{0}^{t}p(t)dt$</td>
<td>焦耳（$J$）</td>
</tr>
<tr>
<td>电导</td>
<td>$G$</td>
<td>$\cfrac{1}{R}$</td>
<td>西门子（$S$）</td>
</tr>
<tr>
<td>电容</td>
<td>$C$</td>
<td>$C=\cfrac Q U$</td>
<td>法拉（$F$）</td>
</tr>
</tbody></table>
<h3 id="电路的作用"><a href="#电路的作用" class="headerlink" title="电路的作用"></a>电路的作用</h3><ul>
<li>进行能量的转换和传输</li>
<li>进行信号的处理和传递</li>
<li>进行信息的存储</li>
</ul>
<p>电路理论研究的对象不是实际电路，而是理想化的电路模型。</p>
<h3 id="电路模型"><a href="#电路模型" class="headerlink" title="电路模型"></a>电路模型</h3><ol>
<li>一个器件的电路模型及参数与该器件的工作条件有关</li>
<li>电路模型是一种数学模型</li>
<li>电路模型只是对实际物理过程的一种近似描述，模型的繁简与实际工程计算的要求有关</li>
</ol>
<h3 id="集总假设及集总电路"><a href="#集总假设及集总电路" class="headerlink" title="集总假设及集总电路"></a>集总假设及集总电路</h3><ul>
<li><p>集总假设元件及电路各方向的尺寸远远小于电路周围的电磁波波长</p>
<p>$$\lambda=\frac{C}{f}, f=50Hz, C=3*10^8m/s$$</p>
<p>$$\Rightarrow \lambda=6*10^6m$$</p>
</li>
<li><p>不同工作条件下，实际器件可以用不同电路模型组合表示</p>
<blockquote>
<p>例如：</p>
<p>电感线圈在直流情况下可视为一个电阻；</p>
<p>在低频交流的情况下可视为一个电阻和一个理想电感的串联；</p>
<p>在高频交流的情况下可视为一个电阻和一个理想电感的串联之后再与一个理想电容并联；</p>
</blockquote>
</li>
<li><p>由理想元件连接而成的电路称为集总电路</p>
</li>
</ul>
<h3 id="参考方向"><a href="#参考方向" class="headerlink" title="参考方向"></a>参考方向</h3><ol>
<li>电流<ul>
<li>电流的实际流动方向是指单位正电荷的移动方向</li>
<li>电流的<strong>参考方向</strong>是一种任意选定的方向<ul>
<li>当 $i&gt;0$ 时参考方向与实际方向一致</li>
<li>当 $i&lt;0$ 时参考方向与实际方向相反</li>
<li>注意：$i$ 是代数量</li>
</ul>
</li>
<li>通常将正电荷运动的方向规定为电流的参考方向 </li>
</ul>
</li>
<li>电压（类似）<ul>
<li>当 $u&gt;0$ 时参考方向与实际方向一致</li>
<li>当 $u&lt;0$ 时参考方向与实际方向相反</li>
<li>注意：$u$ 是代数量</li>
</ul>
</li>
<li>电压与电流的关联参考方向<ul>
<li>电流与电压的参考方向一致则称为关联参考方向，反之则为非关联参考方向</li>
<li>关联参考方向一定是针对一段电路讨论</li>
</ul>
</li>
</ol>
<h3 id="功率"><a href="#功率" class="headerlink" title="功率"></a>功率</h3><ul>
<li><p>当 $p&gt;0$ 时，吸收功率</p>
</li>
<li><p>当 $p&lt;0$ 时，发出功率</p>
</li>
<li><p>注意：在多电源电路中，有的电源会发出功率，有的电源会吸收功率</p>
</li>
</ul>
<h3 id="独立电源的分类及电压源"><a href="#独立电源的分类及电压源" class="headerlink" title="独立电源的分类及电压源"></a>独立电源的分类及电压源</h3><p>独立电源</p>
<blockquote>
<p>指二端元件输出的电压（电流）仅由其本身性质确定，与电路中其余部分的电压（电流）无关</p>
</blockquote>
<p>电压源</p>
<ul>
<li><p>理想电压源</p>
<blockquote>
<p>一个二端元件输出的电压<strong>恒定</strong></p>
<p>（恒定并不是不变，而是不随着外电路的电流发生改变，本身可以随时间变化）</p>
</blockquote>
</li>
<li><p>实际电压源</p>
<blockquote>
<p>一个二端元件输出的电压，随流过它的电流变化而变化</p>
<p>电路模型：</p>
<p>可视为一个理想电压源与一个电阻串联</p>
</blockquote>
</li>
</ul>
<p>电流源</p>
<ul>
<li><p>理想电流源</p>
<blockquote>
<p>一个二端元件输出的电流<strong>恒定</strong></p>
</blockquote>
</li>
<li><p>实际电流源</p>
<blockquote>
<p>一个二端元件输出的电流，随其端电压变化而变化</p>
<p>电路模型：</p>
<p>可视为一个理想电流源与一个电阻并联</p>
</blockquote>
<p>注意：由于实际电流源中的内阻越大越好，所以开路状态下外电压将会很高，故实际电流源不允许开路使用</p>
</li>
</ul>
<h3 id="受控源"><a href="#受控源" class="headerlink" title="受控源"></a>受控源</h3><p>若一个电源的输出电压（电流）受到电路中其他支路的电压（电流）控制时，称为受控源</p>
<h4 id="分类"><a href="#分类" class="headerlink" title="分类"></a>分类</h4><ul>
<li><p>电压控制电压源（VCVS）</p>
<p><img data-src="01.png" alt="VCVS"></p>
<p>$$i_1=0,u_2=\mu u_1$$</p>
<p>$\mu$ ：电压放大倍数（无量纲）</p>
</li>
<li><p>电流控制电压源（CCVS）</p>
<p><img data-src="02.png" alt="CCVS"></p>
<p>$$u_1=0,u_2=ri_1$$</p>
<p>r：转移电阻（电阻量纲）</p>
</li>
<li><p>电压控制电流源（VCCS）</p>
<p><img data-src="03.png" alt="VCCS"></p>
<p>$$i_1=0,i_2=gu_1$$</p>
<p>g：转移电导（电导量纲）</p>
</li>
<li><p>电流控制电流源（CCCS）</p>
<p><img data-src="04.png" alt="CCCS"></p>
<p>$$u_1=0,i_2=\beta i_1$$</p>
<p>$\beta$：电流放大倍数（无量纲）</p>
</li>
</ul>
<h4 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h4><ol>
<li><p>理想的含义</p>
<ul>
<li>控制支路<ul>
<li>控制量是 $u_1$ 时，$i_1=0$</li>
<li>控制量是 $i_1$ 时，$u_1=0$</li>
</ul>
</li>
<li>输出支路<ul>
<li>输出是电压时，内阻为 0</li>
<li>输出是电流时，内导为 0</li>
</ul>
</li>
</ul>
</li>
<li><p>受控源具有电源与电阻的二重性</p>
</li>
<li><p>对理想受控电源 </p>
<ul>
<li>当控制变量为电压时，控制回路是开路的，如：VCVS，VCCS</li>
<li>当控制变量为电流时，控制回路是短路的，如：CCVS，CCCS</li>
<li>对于控制回路（输入回路），因为 $p_2=u_2i_2=0$, 故输入端的功率为零； </li>
<li>对于被控制回路（输出回路），因为 $p_2=u_2i_2\not=0$, 表明输出功率不为零，故受控源为一种<strong>有源元件</strong>。</li>
</ul>
</li>
<li><p>受控源与独立源在电路中的作用： </p>
<p>独立电源是<strong>激励</strong>，表示其对其它电路的一种作用； 受控电源表示控制回路与被控制回路之间的一种<strong>耦合关系</strong>。</p>
</li>
<li><p>只要电路中有一条支路的电压（或电流）受到另外任意一条支路电压（或电流）控制时，它们就构成了一个受控电源。</p>
</li>
</ol>
<h3 id="二端网络"><a href="#二端网络" class="headerlink" title="二端网络"></a>二端网络</h3><ul>
<li>当网络与外部通过两个端点连接时，称其为二端网络</li>
<li>通常二端网络中含独立源时称为含源二端网络，用 $N_S$ 表示</li>
<li>二端网络中不含独立源时，称为无源二端网络，用 $N_O$ 表示</li>
</ul>
<h3 id="基尔霍夫定律"><a href="#基尔霍夫定律" class="headerlink" title="基尔霍夫定律"></a>基尔霍夫定律</h3><h4 id="名词解释"><a href="#名词解释" class="headerlink" title="名词解释"></a>名词解释</h4><ul>
<li><p>支路：一个具有两个端钮，由一个或多个元件串联而成， 且在电路中一段无分支的电路</p>
</li>
<li><p>节点：两条及两条以上支路的连接点</p>
</li>
<li><p>回路： 在电路中从某一节点出发又回到该节点的任一闭合路径</p>
</li>
<li><p>网孔：当回路中不包含其他支路时称为网孔</p>
</li>
<li><p>网络：复杂电路</p>
</li>
</ul>
<h4 id="基尔霍夫电流定律（Kirchhoff’s-current-law-KCL）"><a href="#基尔霍夫电流定律（Kirchhoff’s-current-law-KCL）" class="headerlink" title="基尔霍夫电流定律（Kirchhoff’s current law  KCL）"></a>基尔霍夫电流定律（Kirchhoff’s current law  KCL）</h4><ul>
<li><p>定律：任一时刻，流入电路中任一节点的电流代数和恒为零</p>
<p> $$\sum_{}^{}i_k=0$$</p>
<p> 即</p>
<p> $$\sum i_{in} = \sum i_{out}$$</p>
</li>
<li><p>约定：电流流入取负，流出取正</p>
</li>
<li><p>物理实质：电荷的连续性原理</p>
<blockquote>
<p>电荷是流动的，不会在一个点堆积</p>
</blockquote>
</li>
<li><p>KCL适用于任何集总参数的电路，与电路元件的性质无关</p>
</li>
<li><p>例题：</p>
<p><img data-src="05.png" alt="example"></p>
<p>分析：</p>
<p>两幅图唯一的区别在于 B 点是否接地。</p>
<ol>
<li>第一幅图：<ul>
<li>C点：从上方流入 $i_1$ ，向左边流出 $i_1$ ，故：$$i_1=-\cfrac{10V}{5\Omega}=-2A$$</li>
<li>B点：向右方流出 $i_2$ ，所以上方流入 $i_2$ </li>
<li>A点：右方流入 $$i_2$$ ，向下流出 $$i_2$$ ，故 $$i_{AC}=0$$，故 $$i_2=\cfrac{12V}{12\Omega}=1A$$</li>
</ul>
</li>
<li>第二幅图：<ul>
<li>C点：从上方流入 $$i_1^*$$  ，向左边流出 $$i_1^*$$ ，故：$$i_1^*=-\cfrac{10V}{5\Omega}=-2A$$ </li>
<li>B、C 两点等电势，故可以将其用导线连起来分析</li>
<li>AB、AC 是并联的，等效电阻为 $4\Omega$ ，故 $$i_2^*=\cfrac{12V}{4\Omega+4\Omega}=1.5A$$ </li>
<li>B点：向右方流出 $$i_2^*$$ ，上方流入 $$\cfrac{i_2^*}{2}$$，下方流入 $$\cfrac{i_2^*}{2}$$ </li>
<li>C点：AC 流入 $$\cfrac{i_2^*}{2}$$ ，向下流出 $$\cfrac{i_2^*}{2}$$</li>
</ul>
</li>
</ol>
</li>
</ul>
<h4 id="基尔霍夫电压定律（Kirchhoff’s-voltage-law-KVL）"><a href="#基尔霍夫电压定律（Kirchhoff’s-voltage-law-KVL）" class="headerlink" title="基尔霍夫电压定律（Kirchhoff’s voltage law  KVL）"></a>基尔霍夫电压定律（Kirchhoff’s voltage law  KVL）</h4><ul>
<li><p>定律：任一时刻，沿任一闭合回路电压降代数和恒为零</p>
<p>$\sum u_k=0$</p>
</li>
<li><p>约定：电压降与回路绕行方向一致取正，反之取负</p>
</li>
<li><p>物理实质：电位的单值性原理</p>
<blockquote>
<p>一个点的电位只有一个</p>
</blockquote>
</li>
<li><p>KVL 是能量守恒在集总参数电路中的具体反映</p>
</li>
<li><p>KVL适用于任何集总参数电路，与电路元件的性质无关</p>
</li>
<li><p>KVL 回路中的各支路电压之间加上了线性约束</p>
</li>
<li><p>KVL 既可以用于由导线连接的任何回路，也可以用于其他任何非闭合路径（即广义回路）。 </p>
</li>
</ul>
<h3 id="电位"><a href="#电位" class="headerlink" title="电位"></a>电位</h3><p>将单位正电荷自电场中某一点 a 移动到参考点（物理学中习惯选无穷远处作为参考点，在电路中习惯设定某点为参考点而不是无穷远处）电场力做功的大小称作 a 的电位。</p>
<p>计算电路中某一点的电位，实际上是计算该点与参考点之间的电压。同电压一样，电位也是代数量</p>
]]></content>
      <categories>
        <category>电路</category>
      </categories>
      <tags>
        <tag>电路</tag>
      </tags>
  </entry>
  <entry>
    <title>电路基础02</title>
    <url>/posts/dian-lu-ji-chu-02/</url>
    <content><![CDATA[<h2 id="等效变换的概念"><a href="#等效变换的概念" class="headerlink" title="等效变换的概念"></a>等效变换的概念</h2><p>如果有两个电路N1、N2，其内部结构不同，但从端口看，它们的电压、电流关系相同（方向、大小均相同），则称它们是相互等效的电路，即N1与N2对外电路的影响是相同的。</p>
<h2 id="电阻的串联、并联和混联"><a href="#电阻的串联、并联和混联" class="headerlink" title="电阻的串联、并联和混联"></a>电阻的串联、并联和混联</h2><ul>
<li>分压公式：</li>
</ul>
<p>$$<br>u_k=\cfrac{R_k}{\sum{R_k}}u<br>$$</p>
<ul>
<li>分流公式：</li>
</ul>
<p>$$<br>i_k=\cfrac{G_k}{\sum{G_k}}i<br>$$</p>
<ul>
<li><p>混联</p>
<ol>
<li><p>电路在几何对称的情况下，应首先找出相应的等电位点，然后再进行化简</p>
</li>
<li><p>电桥：</p>
</li>
</ol>
<p><img data-src="01.png" alt="电桥"></p>
<p>平衡条件（平衡时中间桥臂电流电压均为零）：<br>$$<br>\frac{R_1}{R3}=\frac{R_2}{R_4}<br>$$</p>
</li>
</ul>
<p>  一些翻转和变形：</p>
<p>  <img data-src="02.png" alt="翻转和变形"></p>
<ul>
<li><p>分析法：</p>
<blockquote>
<p>先判断电桥是否平衡。</p>
<p>平衡时中间桥臂电压为零可以将其短路（虚短）；平衡时中间桥臂电流为零可以将其断路（虚断）</p>
<p>而最后的计算结果相同</p>
<p>如果电桥不平衡，可采用 $Y-\triangle$ 变换的方法分析</p>
</blockquote>
</li>
<li><p>注：平衡电桥只对无源支路成立</p>
</li>
</ul>
<h2 id="电阻的-Y-triangle-（星形-三角形）变换"><a href="#电阻的-Y-triangle-（星形-三角形）变换" class="headerlink" title="电阻的 $Y-\triangle$ （星形-三角形）变换"></a>电阻的 $Y-\triangle$ （星形-三角形）变换</h2><h3 id="三端网络的等效概念"><a href="#三端网络的等效概念" class="headerlink" title="三端网络的等效概念"></a>三端网络的等效概念</h3><p>若两个三端网络与同一个外部电路相接时，电压 $$u_{12}, u_{23}$$ 与电流 $${i_1, i_2}$$ 之间的关系完全相同，则称这两个三端网络对外互为等效</p>
<p><img data-src="03.png" alt="三端网络"></p>
<ul>
<li><p>对 $Y$ 电路<br>$$<br>\left{<br>\begin{aligned}<br>i_1=\frac{R_3}{R_1R_2+R_2R_3+R_3R_1}u_{12}-\frac{R_2}{R_1R_2+R_2R_3+R_3R_1}u_{31} \<br>i_2=\frac{R_1}{R_1R_2+R_2R_3+R_3R_1}u_{23}-\frac{R_3}{R_1R_2+R_2R_3+R_3R_1}u_{12} \<br>i_3=\frac{R_2}{R_1R_2+R_2R_3+R_3R_1}u_{31}-\frac{R_1}{R_1R_2+R_2R_3+R_3R_1}u_{23} \<br>\end{aligned}<br>\right.<br>$$</p>
</li>
<li><p>对 $\triangle$ 电路<br>$$<br>\left{<br>\begin{aligned}<br>i^{‘}<em>1=i</em>{12}-i_{31}=\frac1{R_{12}}u_{12}-\frac1{R_{31}}u_{31} \<br>i^{‘}<em>2=i</em>{23}-i_{12}=\frac1{R_{23}}u_{23}-\frac1{R_{12}}u_{12} \<br>i^{‘}<em>3=i</em>{31}-i_{23}=\frac1{R_{31}}u_{31}-\frac1{R_{23}}u_{23} \<br>\end{aligned}<br>\right.<br>$$</p>
</li>
</ul>
<h3 id="等效变换公式：-triangle-rightarrow-Y"><a href="#等效变换公式：-triangle-rightarrow-Y" class="headerlink" title="等效变换公式：$\triangle \rightarrow Y$"></a>等效变换公式：$\triangle \rightarrow Y$</h3><p><img data-src="04.png" alt="三角形-星形"><br>$$<br>\left{<br>\begin{aligned}<br>R_1=\frac{R_{12}R_{31}}{\sum R_{ij}} \<br>R_2=\frac{R_{12}R_{23}}{\sum R_{ij}} \<br>R_3=\frac{R_{23}R_{31}}{\sum R_{ij}} \<br>\end{aligned}<br>\right.<br>$$</p>
<p>若 $$R_{12}=R_{23}=R_{31}=R$$，则 $$R_1=R_2=R_3=\cfrac R 3$$</p>
<blockquote>
<p>分母为 $\triangle$ 形中三个电阻之和</p>
<p>分子为 $\triangle$ 形中与之对应节点相连的电阻之积</p>
</blockquote>
<h3 id="等效变换公式：-Y-rightarrow-triangle"><a href="#等效变换公式：-Y-rightarrow-triangle" class="headerlink" title="等效变换公式：$Y \rightarrow \triangle$"></a>等效变换公式：$Y \rightarrow \triangle$</h3><p><img data-src="05.png" alt="星形-三角形"><br>$$<br>\left{<br>\begin{aligned}<br>R_{12}=\frac{R_1R_2+R_2R_3+R_3R_1}{R_{3}} \<br>R_{23}=\frac{R_1R_2+R_2R_3+R_3R_1}{R_{1}} \<br>R_{31}=\frac{R_1R_2+R_2R_3+R_3R_1}{R_{2}} \<br>\end{aligned}<br>\right.<br>$$</p>
<p>若 $$R_1=R_2=R_3=R$$，则 $$R_{12}=R_{23}=R_{31}=3R$$</p>
<blockquote>
<p>分子为 $Y$ 形中三个电阻两两乘积之和</p>
<p>分母为 $Y$ 形中与之对应两节点的无关电阻</p>
</blockquote>
<h3 id="建议画出该图"><a href="#建议画出该图" class="headerlink" title="建议画出该图"></a>建议画出该图</h3><p><img data-src="06.png" alt="全图"></p>
<h3 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h3><p>求 $R_{ab}$ :</p>
<p>首先选择比较容易变换的电阻进行变换：（$Y \rightarrow \triangle $）</p>
<p><img data-src="07.png" alt="例题"><br>$$<br>R_{ab}=\cfrac{1}{\cfrac19+\cfrac13+\cfrac14}\Omega=\cfrac{36}{25}\Omega<br>$$</p>
<h2 id="理想电压源的串联和并联"><a href="#理想电压源的串联和并联" class="headerlink" title="理想电压源的串联和并联"></a>理想电压源的串联和并联</h2><ul>
<li><p>理想电压源的<strong>并联</strong>必须是同极性、同数值</p>
</li>
<li><p>对外电路进行讨论时，与理想电压源<strong>并联</strong>的元件（支路）对外电路不起作用，对外电路讨论时可<strong>断开</strong></p>
</li>
<li><p>计算流过理想电压源支路的电流时，并联支路的作用必须予以保留</p>
</li>
</ul>
<h2 id="理想电流源的串联和并联"><a href="#理想电流源的串联和并联" class="headerlink" title="理想电流源的串联和并联"></a>理想电流源的串联和并联</h2><ul>
<li>理想电流源的<strong>并联</strong>，同方向（同向上或同向下）相加</li>
<li>理想电流源的<strong>串联</strong>必须是同方向、同数值</li>
<li>与理想电流源<strong>串联</strong>的元件（支路）对外电路不起作用，对外电路讨论时可短接</li>
<li>若求理想电流源的端电压时，串联支路的作用必须予以保留</li>
</ul>
<h2 id="实际电源的等效变换"><a href="#实际电源的等效变换" class="headerlink" title="实际电源的等效变换"></a>实际电源的等效变换</h2><p><img data-src="08.png" alt="等效变换"></p>
<p>等效互换条件：<br>$$<br>\begin{aligned}<br>R_{su}=R_{si}&amp;\overset{\triangle}{=}R_{}s \<br>u_s&amp;=R_si_s \<br>(i_s&amp;=\frac{u_s}{R_s})<br>\end{aligned}<br>$$<br>注意：</p>
<ul>
<li>两个条件必须同时满足</li>
<li>等效变换前后要保持电源方向的一致，即电流源的方向由电压源方向的 $“-“$ 指向 $“+”$</li>
<li>等效是对外部而言，对内不等效</li>
</ul>
<h3 id="例1"><a href="#例1" class="headerlink" title="例1"></a>例1</h3><p>运用电源等效变换方法求 $u$</p>
<p><img data-src="09.png" alt="例题"></p>
<p>解：</p>
<p><img data-src="10.png" alt="例题"></p>
<p>理想电流源的并联可以等效为一个理想电流源（两个理想电流源的数值和）</p>
<p><img data-src="11.png" alt="例题"></p>
<p>再转化为电压源与 $6V$ 的电压源组合：</p>
<p><img data-src="12.png" alt="例题"></p>
<p>最终等效电路图：</p>
<p><img data-src="13.png" alt="例题"><br>$$<br>u=4\times\cfrac{\cfrac{5}{4}+2}{2}=6.5V<br>$$</p>
<h3 id="例2"><a href="#例2" class="headerlink" title="例2"></a>例2</h3><p>已知：$$U_{s1}=12V,U_{s2}=24V,R_1=R_2=20\Omega,R_3=50\Omega$$</p>
<p><img data-src="14.png" alt="例题"></p>
<p><img data-src="15.png" alt="例题"></p>
<p><img data-src="16.png" alt="例题"></p>
<h2 id="含受控源电路等效电阻的求取"><a href="#含受控源电路等效电阻的求取" class="headerlink" title="含受控源电路等效电阻的求取"></a>含受控源电路等效电阻的求取</h2><p>名词解释：</p>
<ul>
<li><p>输入电阻</p>
<blockquote>
<p>一个二端无源网络$N_0$，其端口处的电压与电流之比称之为该无源网络的输入电阻，即：</p>
<p>$$R_{in}=\dfrac{u}{i}$$</p>
</blockquote>
</li>
</ul>
<p>一个含受控源的简单二端网络，可以通过与独立源相似的等效变换来化简电路。</p>
<p><img data-src="17.png" alt="例题"></p>
<p>注意：</p>
<p><strong>在化简过程中，必须保留受控源的控制变量支路</strong></p>
<h3 id="例："><a href="#例：" class="headerlink" title="例："></a>例：</h3><p>求电路的输入电阻：</p>
<p><img data-src="18.png" alt="例题"></p>
<p><img data-src="20.png" alt="例题"></p>
<ul>
<li>可见：含受控源电路的输入电阻为 “+” 为 “-” 均属正常，一定要注意物理量的方向</li>
</ul>
<h2 id="运用等效变换分析含受控源的电阻电路"><a href="#运用等效变换分析含受控源的电阻电路" class="headerlink" title="运用等效变换分析含受控源的电阻电路"></a>运用等效变换分析含受控源的电阻电路</h2><blockquote>
<p>注意：</p>
<p>等效变换中控制支路不参与等效变换，予以保留</p>
</blockquote>
<h3 id="例1-1"><a href="#例1-1" class="headerlink" title="例1"></a>例1</h3><p><img data-src="21.png" alt="例题"></p>
<blockquote>
<p>分析：</p>
<ul>
<li>控制支路 $3\Omega$ 不参与等效变换</li>
<li>其余支路：$6A$ 和 $4A$ 可以等效变换，$9\Omega$ 和右侧的混联电阻可以做等效变换</li>
</ul>
</blockquote>
<p>可得到：</p>
<p><img data-src="22.png" alt="例题"></p>
<h3 id="例2-1"><a href="#例2-1" class="headerlink" title="例2"></a>例2</h3><p><img data-src="23.png" alt="例题"></p>
<h2 id="另外一些例题"><a href="#另外一些例题" class="headerlink" title="另外一些例题"></a>另外一些例题</h2><p><img data-src="24.png" alt="例题"></p>
<p><img data-src="25.png" alt="例题"></p>
<p><img data-src="26.png" alt="例题"></p>
<p><img data-src="27.png" alt="例题"></p>
]]></content>
      <categories>
        <category>电路</category>
      </categories>
      <tags>
        <tag>电路</tag>
      </tags>
  </entry>
  <entry>
    <title>电路基础04</title>
    <url>/posts/dian-lu-ji-chu-04/</url>
    <content><![CDATA[<h2 id="叠加定理"><a href="#叠加定理" class="headerlink" title="叠加定理"></a>叠加定理</h2><ul>
<li>线性函数的叠加性：</li>
</ul>
<p>$$<br>f(ax_1+bx_2)=af(x_1)+bf(x_2)<br>$$</p>
<ul>
<li>对于任一线性网络，若同时受到多个独立电源的作用，则这些共同作用的电源在某条支路上所产生的电压或电流，应该等于每个独立电源各自单独作用时，在该支路上所产生的电压或电流分量的代数和。</li>
</ul>
<h3 id="例-1"><a href="#例-1" class="headerlink" title="例 1"></a>例 1</h3><p><img data-src="01.png" alt="例题"></p>
<ul>
<li>注意<ol>
<li>只适用于线性电路中求电压、电流，不适用于直接求功率（因为求功率的函数不是线性的）；也不适用于非线性电路</li>
<li>某个独立电源单独作用时，其余独立电源全为<strong>零</strong>值，电压源用“短路”替代，电流源用“断路”替代</li>
<li>受控源不可单独作用，当每个独立源作用时均予以保留，将控制量改称为对应的控制分量</li>
<li>代数和指分量参考方向与总量方向一致取正，不一致取负。</li>
</ol>
</li>
</ul>
<h3 id="例-2"><a href="#例-2" class="headerlink" title="例 2"></a>例 2</h3><p><img data-src="02.png" alt="例题"></p>
<p><img data-src="03.png" alt="例题"></p>
<p><img data-src="04.png" alt="例题"></p>
<h3 id="例-3"><a href="#例-3" class="headerlink" title="例 3"></a>例 3</h3><p><img data-src="05.png" alt="例题"></p>
<ul>
<li>当 $U_{s5}$ 单独作用时，$R_1R_4=R_2R_3$，电桥平衡（$R_6$ 是桥）</li>
<li>当 $U_{s6}$ 单独作用时，$R_1R_4=R_2R_3$，电桥平衡（$R_5$ 是桥）</li>
</ul>
<h3 id="例-4"><a href="#例-4" class="headerlink" title="例 4"></a>例 4</h3><p><img data-src="06.png" alt="例题"></p>
<p>解：</p>
<ol>
<li>设 $u_0=k_1i_s+k_2u_s$，带入求解得：$u_0=15V$</li>
<li>设 $u_0=k^{‘}_1i_s+k^{‘}_2u_s-12$，带入求解得：$u_0=3V$</li>
</ol>
<h3 id="例-5-含受控源电路求解"><a href="#例-5-含受控源电路求解" class="headerlink" title="例 5 含受控源电路求解"></a>例 5 含受控源电路求解</h3><p><img data-src="07.png" alt="例题"></p>
<p><img data-src="08.png" alt="例题"></p>
<blockquote>
<p>注：</p>
<p>由于 $$U^{‘}<em>{R2}=i</em>{m1}R_2$$，</p>
<p>故： $$\alpha u^{‘}_{R2}=\alpha R_2i_{m1}$$</p>
</blockquote>
<p><img data-src="09.png" alt="例题"></p>
<h2 id="替代定理"><a href="#替代定理" class="headerlink" title="替代定理"></a>替代定理</h2><p>在任意的<strong>线性或非线性</strong>网络中，若已知第 n 条支路的电压和电流为 $U_n$ 和 $I_n$，则不论该支路是何元件组成，总可以用下列的任何一个元件去替代：</p>
<ul>
<li>电压值为 $U_n$ 的理想电压源</li>
<li>电流值为 $I_n$ 的理想电流源</li>
<li>电阻值为 $\cfrac{U_n}{I_n}$ 的理想线性电阻元件 $R_n$</li>
</ul>
<p>替代后的电路中全部电压和电流都将保持原值不变。</p>
<h2 id="戴维南定理和诺顿定理"><a href="#戴维南定理和诺顿定理" class="headerlink" title="戴维南定理和诺顿定理"></a>戴维南定理和诺顿定理</h2><p>对于任一<strong>含源线性二端网络</strong>，就其两个端钮而言，都可以用一条最简单支路对外部等效：</p>
<ol>
<li><p>戴维南定理：以一个电压源和一个电阻串联的等效电路替代</p>
<p><img data-src="10.png" alt="戴维南定理"></p>
<blockquote>
<p>电压源的电压值等于线性网络的开路电压 $U_{oc}$</p>
<p>其串联电阻等于该含源线性二端网络中所有独立源为零时，由端钮看进去的等效电阻 $R{eq}$</p>
</blockquote>
</li>
<li><p>诺顿定理：以一个电流源和一个电阻并联的等效电路替代</p>
<p><img data-src="11.png" alt="诺顿定理"></p>
<blockquote>
<p>电流源的电流值等于该含源线性二端网络的短路电流 $I_{sc}$</p>
<p>其并联电阻的确定同上</p>
</blockquote>
</li>
</ol>
<h3 id="例-1-1"><a href="#例-1-1" class="headerlink" title="例 1"></a>例 1</h3><p><img data-src="12.png" alt="例题"></p>
<p>分析：并在 $\cfrac15V$ 电压源的电阻对外电路不起作用，可将其断开；可将原电路分成左右两部分，分别使用戴维南定理求取。</p>
<ul>
<li><p>左边电压：</p>
<p><img data-src="13.png" alt="例题"></p>
</li>
<li><p>左边电阻</p>
<p><img data-src="14.png" alt="例题"></p>
</li>
<li><p>左右合并</p>
<p><img data-src="15.png" alt="例题"></p>
</li>
</ul>
<h3 id="例-2-1"><a href="#例-2-1" class="headerlink" title="例 2"></a>例 2</h3><p><img data-src="16.png" alt="例题"></p>
<p><img data-src="17.png" alt="例题"></p>
<h3 id="例-3-1"><a href="#例-3-1" class="headerlink" title="例 3"></a>例 3</h3><p><img data-src="18.png" alt="例题"></p>
<p>解：根据戴维南定理，将 $R$ 支路以外的其余部分所构成的二端网络，用一个电压源 $U_{oc}$ 和电阻 $R_0$ 相串联去等效代替。 </p>
<ol>
<li><p>求 $U_{oc}$：将 $R$ 支路断开，如图 (b) 所示。用节点电位法（取 b 点点位为 0）可求得：<br>$$<br>U_{oc}=\cfrac{\frac{2}{2+2+2}+1}{\frac1{2+2+2}+\frac12}=2V<br>$$</p>
</li>
<li><p>求 $R_0$：将两个独立源变为零值，即将 2V 电压源短路，而将 1A 电流源开路，如图 (c)所示。可求得：<br>$$<br>R_0=\cfrac{2\times(2+2+2)}{2+2+2+2}=\cfrac32\Omega=1.5\Omega<br>$$</p>
</li>
<li><p>根据所求得的 $U_{oc}$ 和 $R_0$，可作出戴维南等效电路，接上 $R$ 支路如图 (d) 所示，即可求得：<br>$$<br>I=\cfrac23A,U=1V<br>$$</p>
</li>
</ol>
<h3 id="例-4-1"><a href="#例-4-1" class="headerlink" title="例 4"></a>例 4</h3><p><img data-src="19.png" alt="例题"></p>
<p>解：该题如果只用一次戴维南定理，直接求出 4Ω 电阻支路以左的等效电压源，则计算开路电压将会很麻烦。为此，可以逐次应用戴维南定理。</p>
<ol>
<li>先求图 (a) 中 ab 以左的戴维南等效电路。将最左侧电压源等效为电流源，再与 1A 电流源合并，最后再等效为电压源（也可以和例 3 一样，令 $u_b=0$，用节点电位法求取），得：</li>
</ol>
<p>$$<br>U_{ab}=4V,R_{ab}=2\Omega<br>$$</p>
<ol start="2">
<li><p>这样可得到图 (b)。同理，在图 (b) 中，先求左边两列的等效，得：<br>$$<br>U^{‘}=8V,R^{‘}=6\Omega<br>$$<br>再同理求 cd 以左的戴维南等效电路。于是有：<br>$$<br>U_{cd}=4V,R_{cd}=2\Omega<br>$$</p>
</li>
<li><p>得图 (d)。由此可求得：$I=\cfrac4{2+4}=\cfrac23A$</p>
</li>
</ol>
<h2 id="一般方法求等效电阻"><a href="#一般方法求等效电阻" class="headerlink" title="一般方法求等效电阻"></a>一般方法求等效电阻</h2><ol>
<li>求等效电阻 $R_{eq}$ 时，若电路为纯电阻网络，可以用串、并联化简时，直接用串、并联化简的方法求</li>
<li>无法用串并联化简时，则用一般方法求</li>
<li>当电路中含受控源时，则一定要用一般方法求戴维南等效电阻</li>
</ol>
<h2 id="利用戴维南定理分析受控源的电路"><a href="#利用戴维南定理分析受控源的电路" class="headerlink" title="利用戴维南定理分析受控源的电路"></a>利用戴维南定理分析受控源的电路</h2><blockquote>
<p>原则：</p>
<ul>
<li>被等效电路内部与负载内部不应有任何联系（控制量为端口 $U$ 或 $I$ 除外）</li>
<li>求 $R_{eq}$ 要用一般方法</li>
</ul>
</blockquote>
<h3 id="例-1-2"><a href="#例-1-2" class="headerlink" title="例 1"></a>例 1</h3><p><img data-src="20.png" alt="例题"></p>
<ul>
<li><p>求 $U_{oc}$</p>
<p>控制量是被断开断口处的电压，断开断口处的电压即可以看作是负载部分的，也可以看作是被等效部分的</p>
<p><img data-src="21.png" alt="例题"></p>
</li>
</ul>
<ul>
<li><p>求 $R_{eq}$</p>
<ul>
<li>法一：外加激励法</li>
</ul>
<p><img data-src="22.png" alt="例题"></p>
<ul>
<li><p>法二：开路短路法</p>
<p>短路后 $U=0$，即控制量为零，所以受控源的输出量也等于零，受控源是一个受控电流源，输出量为零可视作断路</p>
</li>
</ul>
<p><img data-src="23.png" alt="例题"></p>
</li>
<li><p>作戴维南等效电路求电压 $U$</p>
<p><img data-src="24.png" alt="例题"></p>
</li>
</ul>
<h3 id="例-2-2"><a href="#例-2-2" class="headerlink" title="例 2"></a>例 2</h3><p><img data-src="25.png" alt="例题"></p>
<blockquote>
<p>分析：</p>
<p>断开待求支路，求戴维南等效电路时，会使控制量 $I_1$、被控制量 $2I_1 $ 分属被等效电路与负载两部分</p>
<p>故需要做控制量转移，图中可以看出 $U=1\Omega\times I$，故 $2I_1$ 可用 $2U$ 代替，这样控制量与被控质量同时属于负载部分。</p>
</blockquote>
<ol>
<li><p>求等效电压</p>
<ul>
<li>当 $4V$ 电压源单独作用时：</li>
</ul>
<p><img data-src="26.png" alt="例题"></p>
<ul>
<li>当 $1A$ 电流源单独作用时：</li>
</ul>
<p><img data-src="27.png" alt="例题"></p>
</li>
<li><p>求等效电阻</p>
<p>电桥平衡，$R_{eq}=\cfrac{1+\cfrac{2+2}2}{1+\cfrac{2+2}2+1}=\cfrac34\Omega$</p>
</li>
<li><p>求 $U,I$</p>
<p><img data-src="28.png" alt="例题"></p>
</li>
</ol>
<h2 id="最大功率传输定理（不要求）"><a href="#最大功率传输定理（不要求）" class="headerlink" title="*最大功率传输定理（不要求）"></a>*最大功率传输定理（不要求）</h2><p><img data-src="29.png" alt="大功率传输定理"></p>
<p><img data-src="30.png" alt="大功率传输定理"></p>
]]></content>
      <categories>
        <category>电路</category>
      </categories>
      <tags>
        <tag>电路</tag>
      </tags>
  </entry>
  <entry>
    <title>电路基础03</title>
    <url>/posts/dian-lu-ji-chu-03/</url>
    <content><![CDATA[<h2 id="一般电路的网孔电流法"><a href="#一般电路的网孔电流法" class="headerlink" title="一般电路的网孔电流法"></a>一般电路的网孔电流法</h2><h3 id="支路电流法"><a href="#支路电流法" class="headerlink" title="支路电流法"></a>支路电流法</h3><p><strong>以支路电流为未知量</strong>，根据 KCL、KVL 列关于支路电流的方程，进行求解的过程</p>
<ul>
<li>支路：任意一段无分支的电路</li>
<li>节点：三条及三条以上支路的连接点</li>
</ul>
<h4 id="基本步骤"><a href="#基本步骤" class="headerlink" title="基本步骤"></a>基本步骤</h4><ol>
<li><p>选定<strong>各支路</strong>电流参考方向，列出各节点的 KCL 方程</p>
</li>
<li><p>对独立回路列关于支路电流的 KVL 方程</p>
<blockquote>
<p>独立回路的选取</p>
<ul>
<li><p>充分条件：当每个回路中均具有一条其他回路不具有的新支路时，这一组回路互相独立</p>
</li>
<li><p>平面电路（画在平面中不出现交叉导线的电路）：内网孔是一组独立回路</p>
</li>
</ul>
</blockquote>
</li>
<li><p>求解</p>
</li>
</ol>
<p>缺点：未知量过多</p>
<h3 id="网孔电流法"><a href="#网孔电流法" class="headerlink" title="网孔电流法"></a>网孔电流法</h3><p><strong>以网孔电流作为独立变量</strong>，根据 KVL 列出关于网孔电流的电路方程，进行求解的过程</p>
<blockquote>
<p>网孔电流：假想沿着电路中网孔边界流动的电流</p>
<ul>
<li>对于一个节点数为 n，支路数为 b 的平面电路，其网孔数为 $b-n+1$ 个，网孔电流数也为 $b-n+1$ 个</li>
<li>网孔电流的特点<ul>
<li>独立性：网孔电流自动满足 KCL，而且相互独立</li>
<li>完备性：电路中所有支路电流都可以用网孔电流来表示</li>
</ul>
</li>
</ul>
</blockquote>
<p>例：</p>
<p><img data-src="01.png" alt="例题"></p>
<h4 id="基本步骤-1"><a href="#基本步骤-1" class="headerlink" title="基本步骤"></a>基本步骤</h4><ol>
<li>指定网孔电流的参考方向，并以此作为列写 KVL 方程的回路绕行方向</li>
<li>根据 KVL 列写关于网孔电流的电路方程</li>
</ol>
<p>如上图：<br>$$<br>\begin{cases}<br>R_1I_{m1}+R_5(I_{m1}-I_{m2})+U_{s4}+R_4(I_{m1}-I_{m3})-U_{s1}=0 \<br>R_2I_{m2}+U_{s2}+R_6(I_{m2}-I_{m3})+R_5(I_{m2}-I_{m1})=0 \<br>R_4(I_{m3}-I_{m1})-U_{s4}+R_6(I_{m3}-I_{m2})-U_{s3}+R_3I_{m3}=0 \<br>\end{cases}<br>$$</p>
<p>$$<br>\begin{matrix}<br>\Downarrow<br>\end{matrix}<br>$$</p>
<p>$$<br>\begin{cases}<br>(R_1+R_5+R_4)I_{m1}-R_5I_{m2}-R_4I_{m3}=U_{s1}-U_{s4} \<br>-R_5I_{m1}+(R_2+R_5+R_6)I_{m2}-R_6I_{m3}=-U_{s2} \<br>-R_4I_{m1}-R_6I_{m2}+(R_3+R_4+R_6)I_{m3}=U_{s3}+U_{s4} \<br>\end{cases}<br>$$</p>
<p>$$<br>\begin{matrix}<br>\Downarrow<br>\end{matrix}<br>$$</p>
<p>$$<br>\begin{bmatrix}<br>R_1+R_4+R_5 &amp; -R_5 &amp; -R_4 \<br>-R_5 &amp; R_2+R_5+R_6 &amp; -R_6 \<br>-R_4 &amp; -R_6 &amp; R_3+R_4+R_6<br>\end{bmatrix}<br>\begin{bmatrix}<br>I_{m1} \<br>I_{m2} \<br>I_{m3}<br>\end{bmatrix}<br>=<br>\begin{bmatrix}<br>U_{s1}-U_{s4} \<br>-U_{s2} \<br>U_{s3}+U_{s4} \<br>\end{bmatrix}<br>$$</p>
<h4 id="网孔电流方程的一般形式"><a href="#网孔电流方程的一般形式" class="headerlink" title="网孔电流方程的一般形式"></a>网孔电流方程的一般形式</h4><p>$$<br>\begin{bmatrix}<br>R_{11} &amp; R_{12} &amp; R_{13} \<br>R_{21} &amp; R_{22} &amp; R_{23} \<br>R_{31} &amp; R_{32} &amp; R_{33} \<br>\end{bmatrix}<br>\begin{bmatrix}<br>I_{m1} \<br>I_{m2} \<br>I_{m3}<br>\end{bmatrix}<br>=<br>\begin{bmatrix}<br>U_{s11} \<br>U_{s22} \<br>U_{s33} \<br>\end{bmatrix}<br>$$</p>
<p>解释：</p>
<ul>
<li><p>系数矩阵主对角线上的元素：$R_{ij}(i=j)$ 称为<strong>自电阻</strong>，为第 $i$ 个网孔中各支路的电阻之和，<strong>值恒为正</strong></p>
<blockquote>
<p>如上图中的：</p>
<p>$R_{11}=R_1+R_4+R_5$</p>
<p>$R_{22}=R_2+R_5+R_6$</p>
<p>$R_{33}=R_3+R_4+R_6$</p>
</blockquote>
</li>
<li><p>系数矩阵非主对角线上的元素：$R_{ij}(i\not=j)$ 称为<strong>互电阻</strong>，为第 $i$ 个与第 $j$ 个网孔之间公共支路的电阻之和，值可正可负，<strong>当相邻网孔电流在公共支路上流向一致为正，不一致时为负</strong>。</p>
</li>
<li><p>不含受控源的电路系数矩阵为对称阵。</p>
</li>
<li><p>$U_{sii}$ 为第 $i$ 个网孔中的<strong>等效电压源</strong>，其值为该网孔中各支路电压源电压值的代数和。<strong>当电压源方向与绕行方向一致时取负，不一致时取正</strong> （这是由于把电压源由方程左端搬到方程右端所导致的）。</p>
</li>
</ul>
<h4 id="网孔电流法的分析步骤"><a href="#网孔电流法的分析步骤" class="headerlink" title="网孔电流法的分析步骤"></a>网孔电流法的分析步骤</h4><p>一般电路<strong>（电路中仅含电压源）</strong>的网孔法：</p>
<ol>
<li><p>选取各网孔电流绕行方向</p>
</li>
<li><p>利用直接观察法（自电阻、互电阻、等效电源）形成方程</p>
<blockquote>
<p>$$<br>\begin{aligned}<br>\sum(\text{自电阻}\times\text{本网孔电流})\pm\sum{(\text{互电阻}\times\text{相邻网孔电流})} \<br>=\sum{\text{本网孔电压源代数和}}<br>\end{aligned}<br>$$</p>
</blockquote>
</li>
<li><p>方程求解</p>
</li>
</ol>
<h2 id="含理想电流源支路的网孔电流法"><a href="#含理想电流源支路的网孔电流法" class="headerlink" title="含理想电流源支路的网孔电流法"></a>含理想电流源支路的网孔电流法</h2><p>第一类：含实际电流源：电源等效变换，按一般电路网孔电流分析方法进行电路分析</p>
<p>第二类：含理想电流源，分以下两种情况</p>
<ol>
<li><p>理想电流源支路位于网孔边沿支路（网孔电流等于电流源电流）</p>
<p><img data-src="02.png" alt="case1"></p>
<blockquote>
<ul>
<li>选取网孔电流绕行方向，其中含理想电流源支路的网孔为已知量 $$I_{m2}=-I_s$$</li>
<li>对不含电流源支路的网孔根据直接观察法列方程：$$(R_1+R_3)I_{m1}-R_3I_{m2}=U_s$$</li>
<li>注意：若对含理想电流源支路的网孔列网孔电流方程时必须考虑理想电流源的端电压</li>
</ul>
</blockquote>
</li>
<li><p>理想电流源支路位于网孔公共支路</p>
<p><img data-src="03.png" alt="case2"></p>
<blockquote>
<ul>
<li><p>选取网孔电流绕行方向，虚设电流源电压 $U$</p>
</li>
<li><p>根据直接观察法列方程：<br>$$<br>\begin{cases}<br>(R_1+R_2)I_{m1}-R_2I_{m2}+U=U_s \<br>-R_2+(R_2+R_3)I_{m2}-U=0 \<br>\end{cases}<br>$$</p>
</li>
<li><p>添加约束方程：$$I_{m2}-I_{m1}=I_s$$</p>
</li>
<li><p>求解</p>
</li>
</ul>
</blockquote>
<p><del>为啥我觉得直接列 KCL 和 KVL 方程更简单直接呢？</del></p>
</li>
</ol>
<h2 id="含受控源电路的网孔电流法"><a href="#含受控源电路的网孔电流法" class="headerlink" title="含受控源电路的网孔电流法"></a>含受控源电路的网孔电流法</h2><p>注意：系数矩阵不再是对称矩阵</p>
<h2 id="含理想电流源支路的回路电流法"><a href="#含理想电流源支路的回路电流法" class="headerlink" title="含理想电流源支路的回路电流法"></a>含理想电流源支路的回路电流法</h2><p>以回路电流作为电路独立变量进行电路分析的方法称为<strong>回路电流法</strong></p>
<blockquote>
<ul>
<li>适用于多个理想电流源支路的电路</li>
<li>回路电流是在一个回路中连续流动的假想电流</li>
<li>电路中的独立回路数即为网孔数</li>
<li>一个具有 b 条支路和 n 个节点的电路，其独立回路数为 $$(b-n+1)$$</li>
</ul>
</blockquote>
<p><img data-src="04.png" alt="例题"></p>
<p>解：</p>
<ul>
<li><p>适当选取回路，使独立电源支路只有一个回路电流流过：</p>
<p>$$I_{l1}=2A;,I_{l2}=3A;,I_{l3}=1A$$</p>
</li>
<li><p>对回路 4 列写回路电流方程：</p>
<p>$$<br>\begin{matrix}<br>-2I_{l1}-2I_{l2}+3I_{l3}+5I_{l4}&amp;=5+1+3 \<br>&amp;\Rightarrow I_{l4}=3.2A \<br>\therefore I=I_{l4}=3.2A<br>\end{matrix}<br>$$</p>
</li>
</ul>
<h2 id="一般电路的节点电压法"><a href="#一般电路的节点电压法" class="headerlink" title="一般电路的节点电压法"></a>一般电路的节点电压法</h2><ul>
<li>以独立节点的电压作为独立变量，根据 KCL 列出关于节点电压的电路方程，进行求解的过程</li>
<li>节点电压法适用于结构复杂、非平面电路、独立回路选择麻烦、以及节点少、回路多的电路的分析求解。</li>
</ul>
<blockquote>
<p>节点电压：</p>
<p>在电路中任意选择一个节点为参考节点（也称非独立节点）. 其它节点即为独立节点。独立节点与参考点之间的电压,称为该节点的节点电压. </p>
<p>节点电压的两个特点：</p>
<ul>
<li><p>独立性：节点电压自动满足 KVL，且相互独立</p>
</li>
<li><p>完备性：电路中所有支路电压都可以用节点电压表示</p>
</li>
</ul>
</blockquote>
<h3 id="节点电压方程的一般形式"><a href="#节点电压方程的一般形式" class="headerlink" title="节点电压方程的一般形式"></a>节点电压方程的一般形式</h3><p>$$<br>\begin{bmatrix}<br>G_{11} &amp; G_{12} &amp; G_{13} \<br>G_{21} &amp; G_{22} &amp; G_{23} \<br>G_{31} &amp; G_{32} &amp; G_{33} \<br>\end{bmatrix}<br>\begin{bmatrix}<br>U_{n1} \<br>U_{n2} \<br>U_{n3}<br>\end{bmatrix}<br>=<br>\begin{bmatrix}<br>I_{s11} \<br>I_{s22} \<br>I_{s33} \<br>\end{bmatrix}<br>$$</p>
<p>解释：</p>
<ul>
<li><p>系数矩阵主对角线上的元素：$G_{ij}(i=j)$ 称为<strong>自电导</strong>，为连接到第 $i$ 个节点中各支路的电导之和，<strong>值恒为正</strong></p>
</li>
<li><p>系数矩阵非主对角线上的元素：$G_{ij}(i\not=j)$ 称为<strong>互电导</strong>，为连接于节点 $i$ 个与节点 $j$ 之间支路上的电导之和，<strong>值恒为负</strong>。</p>
</li>
<li><p>不含受控源的电路系数矩阵为对称阵。</p>
</li>
<li><p>$I_{sii}$ 为流入第 $i$ 个节点的各支路电流源电流值代数和。<strong>流入取正，流出取负</strong> （这是由于把电流源由方程左端搬到方程右端所导致的）。</p>
</li>
</ul>
<h3 id="节点电压法的分析步骤"><a href="#节点电压法的分析步骤" class="headerlink" title="节点电压法的分析步骤"></a>节点电压法的分析步骤</h3><ol>
<li><p>指定电路中某一节点为参考点，标出各独立节点电位（符号）</p>
</li>
<li><p>利用直接观察法形成方程</p>
<blockquote>
<p>$$<br>\begin{aligned}<br>\sum(自电导\times本节点电压)-\sum{(互电导\times相邻节点电压)} \<br>=\sum{流入本节点的电流源代数和（流入节点取正，流出取负）} \<br>\end{aligned}<br>$$</p>
<p>列写第 n 个节点电压方程时</p>
<ul>
<li><p>与 n 节点相连接的支路上的电阻元件的电导之和（自电导）一律取 “+” 号</p>
</li>
<li><p>与 n 节点相关联支路的电阻元件的电导（互电导）一律取 “-” 号。流入 n 节点的理想电流源的电流取 “+” 号，流出的取 “-” 号。</p>
</li>
</ul>
</blockquote>
</li>
<li><p>方程求解</p>
</li>
</ol>
<h3 id="例"><a href="#例" class="headerlink" title="例"></a>例</h3><p><img data-src="05.png" alt="例题"></p>
<p><img data-src="06.png" alt="例题"></p>
]]></content>
      <categories>
        <category>电路</category>
      </categories>
      <tags>
        <tag>电路</tag>
      </tags>
  </entry>
  <entry>
    <title>Hexo 博客踩坑</title>
    <url>/posts/hexo-bo-ke-cai-keng/</url>
    <content><![CDATA[<h2 id="TOC-锚点-undefined"><a href="#TOC-锚点-undefined" class="headerlink" title="TOC 锚点 undefined"></a>TOC 锚点 undefined</h2><p>最近使用 hexo 搭了一个博客，然而在写文章测试后发现，文章的导航栏不能正常使用：导航栏的生成是正常的，但是在点击导航栏后并不能跳转到文章的对应位置，而是在网址后面多了一个 <code>/#undefined</code>，如图：</p>
<p><img data-src="undefined.png" alt="undefined"></p>
<p>TOC 跳转链接应该是与文章标题对应的，但是 <code>.md</code> 渲染后文章标题并没有对应相应的 id，如果渲染正确，我们期望得到的是：</p>
<p><code>.../#[标题]</code></p>
<p>现在基本上可以确认是 TOC 锚点失败造成的。</p>
<h3 id="markdown-it-插件的-bug"><a href="#markdown-it-插件的-bug" class="headerlink" title="markdown-it 插件的 bug"></a>markdown-it 插件的 bug</h3><p>我的博客是由 markdown-it 渲染的，由于 Markdown-it 的插件并未渲染 heading 的 id 所以导致锚点失效，这个是 <a target="_blank" rel="noopener" href="https://github.com/hexojs/hexo-renderer-markdown-it">hexo-renderer-markdown-it</a> 的 bug，但是 markdown-it 的作者拒绝修复，认为是其他库的坑。</p>
<h3 id="方法-1"><a href="#方法-1" class="headerlink" title="方法 1"></a>方法 1</h3><p>安装 markdown-it-named-headings 插件</p>
<p>这个插件是另外一个大佬针对这个 bug 做的一个修复</p>
<p>首先安装它：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install markdown-it-named-headings --save</span><br></pre></td></tr></table></figure>

<p>然后进入你项目的根目录，修改根目录下 <code>node_modules\hexo-renderer-markdown-it\lib\renderer.js</code> 文件，在 <code>renderer.js</code> 中添加一行以使用此插件：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">parser.use(<span class="built_in">require</span>(<span class="string">&#x27;markdown-it-named-headings&#x27;</span>))</span><br></pre></td></tr></table></figure>

<p>就像下面这样：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="meta">&#x27;use strict&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span> (<span class="params">data, options</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> MdIt = <span class="built_in">require</span>(<span class="string">&#x27;markdown-it&#x27;</span>);</span><br><span class="line">  <span class="keyword">var</span> cfg = <span class="built_in">this</span>.config.markdown;</span><br><span class="line">  <span class="keyword">var</span> opt = (cfg) ? cfg : <span class="string">&#x27;default&#x27;</span>;</span><br><span class="line">  <span class="keyword">var</span> parser = (opt === <span class="string">&#x27;default&#x27;</span> || opt === <span class="string">&#x27;commonmark&#x27;</span> || opt === <span class="string">&#x27;zero&#x27;</span>) ?</span><br><span class="line">    <span class="keyword">new</span> MdIt(opt) :</span><br><span class="line">    <span class="keyword">new</span> MdIt(opt.render);</span><br><span class="line"></span><br><span class="line">  parser.use(<span class="built_in">require</span>(<span class="string">&#x27;markdown-it-named-headings&#x27;</span>))</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (opt.plugins) &#123;</span><br><span class="line">    parser = opt.plugins.reduce(<span class="function"><span class="keyword">function</span> (<span class="params">parser, pugs</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> parser.use(<span class="built_in">require</span>(pugs));</span><br><span class="line">    &#125;, parser);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (opt.anchors) &#123;</span><br><span class="line">    parser = parser.use(<span class="built_in">require</span>(<span class="string">&#x27;./anchors&#x27;</span>), opt.anchors);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> parser.render(data.text);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>有很多人用这种方法解决了问题，然而事实证明这种方法并不适合我○|￣|_，我用了之后并没有什么改善，最后是用下面的方法 2 解决的</p>
<p>不过大家有兴趣的可以尝试一下，说不定就成功了呢？</p>
<h3 id="方法-2"><a href="#方法-2" class="headerlink" title="方法 2"></a>方法 2</h3><p>经过简单的排查，发现现在编译出的HTML内容中，如下的 markdown 标题：</p>
<p><code>## title</code></p>
<p>原来会被编译成 <code>&lt;h2 id=&quot;title&quot;&gt;title&lt;/h2&gt;</code></p>
<p>而现在会被编译成 <code>&lt;h2&gt;&lt;span id=&quot;title&quot;&gt;title&lt;/span&gt;&lt;/h2&gt;</code></p>
<p>推测因此导致了生成 TOC 时，H2 元素的 id 属性为未定义，进而导致 TOC 中的锚点也为未定义的问题。</p>
<p>以上的变更，是包 hexo-toc 的变更导致的，具体应该是这次<a target="_blank" rel="noopener" href="https://github.com/bubkoo/hexo-toc/blob/7c9624c2d3fb7d13ce973cb8de4dc10ff865c089/lib/filter.js#L28">提交</a>。</p>
<p>但是目前仅仅是初步排查，暂时没有确定问题就是出在hexo-toc上，仅仅是认为这个修改可能会导致后续某些生成toc的代码的不兼容。</p>
<p>因此目前阶段，进入你项目根目录的 <code>node_modules\hexo-toc\lib\filter.js</code> 中，把28行~31行修改为：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">$title.attr(<span class="string">&#x27;id&#x27;</span>, id);</span><br><span class="line"><span class="comment">// $title.children(&#x27;a&#x27;).remove();</span></span><br><span class="line"><span class="comment">// $title.html( &#x27;&lt;span id=&quot;&#x27; + id + &#x27;&quot;&gt;&#x27; + $title.html() + &#x27;&lt;/span&gt;&#x27; );</span></span><br><span class="line"><span class="comment">// $title.removeAttr(&#x27;id&#x27;);</span></span><br></pre></td></tr></table></figure>

<p>也就是恢复这次提交，保留旧版本，仅保留28行，其他的内容注释掉。</p>
<p>这样的话，生成的TOC应该就是正常的了。</p>
<p>ps：另外需要注意的是，编译的 markdown 貌似有缓存，因此修改后，你可以再新建一篇文章后再生成，用新文章测试以上手段是否有效修复。旧文章由于缓存问题，可能不会生成新的 HTML（这部分也只是看到现象，暂时没有进行详细了解）。如果新文章确实能够修复此问题，再处理旧文章即可。</p>
<h3 id="根本原因"><a href="#根本原因" class="headerlink" title="根本原因"></a>根本原因</h3><p>实际上这是由包 <code>hexo-toc</code> 引起的问题。这个包更新之后产生了不兼容的情况。有些童鞋没有这个问题可能是因为你使用的是旧版本。</p>
<p>在上面提到的 hexo-toc 的提交中，在 HTML 生成前， <code>hexo-toc</code> 去掉了 <code>&lt;h2&gt;</code> 等标签的 id 属性，将其放入内部新生成的 <code>&lt;span&gt;...&lt;/span&gt;</code> 中。而 hexo 本身生成 toc 的时候，取得仍是 <code>&lt;h2&gt;</code> 标签的 id，因此得到的是 <code>undefined</code>。具体代码在<a target="_blank" rel="noopener" href="https://github.com/hexojs/hexo/blob/master/lib/plugins/helper/toc.js#L27">这里</a></p>
<p>在这里做兼容的修复应该也是可以的，不过我并没有尝试，有兴趣的可以尝试一下。</p>
<h2 id="添加置顶"><a href="#添加置顶" class="headerlink" title="添加置顶"></a>添加置顶</h2><p>运行如下两条命令安装置顶插件：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm uninstall hexo-generator-index --save</span><br><span class="line">npm install hexo-generator-index-pin-top --save</span><br></pre></td></tr></table></figure>

<p>然后打开 <code>blog\themes\beantech\layout\index.ejs</code> ，在如下位置添加：</p>
<p><img data-src="posttop.png" alt="posttop"></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;% if (post.top) &#123;%&gt;</span><br><span class="line">    &lt;i class&#x3D;&quot;fa fa-thumb-tack&quot;&gt;&lt;&#x2F;i&gt;</span><br><span class="line">    &lt;font color&#x3D;7D26CD&gt;置顶&lt;&#x2F;font&gt;</span><br><span class="line">    &lt;span class&#x3D;&quot;post-meta-divider&quot;&gt;|&lt;&#x2F;span&gt;</span><br><span class="line">&lt;%&#125;%&gt;</span><br></pre></td></tr></table></figure>

<p>然后在你想置顶的文章md文件里，添加如下配置选项：</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">top:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>

<h2 id="添加-Gittalk-评论插件"><a href="#添加-Gittalk-评论插件" class="headerlink" title="添加 Gittalk 评论插件"></a>添加 Gittalk 评论插件</h2><p>之前试过 Disqus，并不好用，而且界面也并不好看，这次换成了 <a target="_blank" rel="noopener" href="https://github.com/gitalk/gitalk">Gitalk</a> 插件感觉好多了，最大的亮点应该是支持 markdown 语法了。它的评论界面大概长这样：</p>
<p><img data-src="gitalk.png" alt="gitalk"></p>
<p>评论时需要登陆 github 账号，每一次评论都相当于用你的 github 账号在每篇文章对应的 issue 上提问题：</p>
<p><img data-src="issue.png" alt="issue"></p>
<h3 id="配置-Gitalk"><a href="#配置-Gitalk" class="headerlink" title="配置 Gitalk"></a>配置 Gitalk</h3><p>好，现在我们根据 Gitalk 的<a target="_blank" rel="noopener" href="https://github.com/gitalk/gitalk/blob/master/readme-cn.md">官方文档</a>，来对网站进行配置，首先找到你自己网站的配置文章的部分，我这里是 <code>\themes\beantech\layout\post.ejs</code>，在和文章同一个 <code>&lt;div&gt;</code> 下（当然，要在文章的下方）添加 gitalk 的代码，这点很重要，否则最后配置好以后你的评论框的位置和大小会变得很奇怪。</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Gitalk start --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;gitalk-container&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> gitalk = <span class="keyword">new</span> Gitalk(&#123;</span></span><br><span class="line"><span class="javascript">      clientID: <span class="string">&#x27;GitHub Application Client ID&#x27;</span>,</span></span><br><span class="line"><span class="javascript">      clientSecret: <span class="string">&#x27;GitHub Application Client Secret&#x27;</span>,</span></span><br><span class="line"><span class="javascript">      repo: <span class="string">&#x27;GitHub 仓库的名字&#x27;</span>,  <span class="comment">//如 &#x27;convivae.github.io&#x27;</span></span></span><br><span class="line"><span class="javascript">      owner: <span class="string">&#x27;GitHub repository 所有者&#x27;</span>,</span></span><br><span class="line"><span class="javascript">      admin: [<span class="string">&#x27;对这个 repository 有写权限的用户&#x27;</span>], <span class="comment">//这是个字符串数组，可填写多个</span></span></span><br><span class="line"><span class="javascript">      id: location.pathname,      <span class="comment">// 页面的唯一标识。长度必须小于50，默认是文章路径</span></span></span><br><span class="line"><span class="javascript">      distractionFreeMode: <span class="literal">true</span>  <span class="comment">// 类似Facebook评论框的全屏遮罩效果.</span></span></span><br><span class="line">    &#125;);</span><br><span class="line"><span class="javascript">    gitalk.render(<span class="string">&#x27;gitalk-container&#x27;</span>);</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- Gitalk end --&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="申请-GitHub-Application"><a href="#申请-GitHub-Application" class="headerlink" title="申请 GitHub Application"></a>申请 GitHub Application</h3><p>上述的代码中需要使用 GitHub Application，如果没有 <a target="_blank" rel="noopener" href="https://github.com/settings/applications/new">点击这里申请</a>，填写方式与下面类似</p>
<p><img data-src="oauth.png" alt="oauth"></p>
<p>注册之后就得到了 Client ID 和 Client Secret，填入上面的代码中即可。</p>
<h3 id="label-长度不能超过-50-个字符"><a href="#label-长度不能超过-50-个字符" class="headerlink" title="label 长度不能超过 50 个字符"></a>label 长度不能超过 50 个字符</h3><p>这是 Github 的限制，我们的 id 使用的是文章的相对路径，路径中含有标题。所以一种解决方案是文章标题短一点；另一种解决方案是对路径算 hash，通过 MD5 加密 id 来缩短label长度，这样，不论标题多长都没有问题。具体操作如下：<br>从 github 上 <a target="_blank" rel="noopener" href="https://github.com/blueimp/JavaScript-MD5/tree/master/js">下载</a> <code>md5.min.js</code> 文件，或直接在 <code>themes\beantech\source\js</code> 中创建 <code>md5.min.js</code> 文件并复制下面的代码：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">! <span class="function"><span class="keyword">function</span>(<span class="params">n</span>) </span>&#123;</span><br><span class="line"><span class="meta">    &quot;use strict&quot;</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">t</span>(<span class="params">n, t</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> r = (<span class="number">65535</span> &amp; n) + (<span class="number">65535</span> &amp; t);</span><br><span class="line">        <span class="keyword">return</span> (n &gt;&gt; <span class="number">16</span>) + (t &gt;&gt; <span class="number">16</span>) + (r &gt;&gt; <span class="number">16</span>) &lt;&lt; <span class="number">16</span> | <span class="number">65535</span> &amp; r</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">r</span>(<span class="params">n, t</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> n &lt;&lt; t | n &gt;&gt;&gt; <span class="number">32</span> - t</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">e</span>(<span class="params">n, e, o, u, c, f</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> t(r(t(t(e, n), t(u, f)), c), o)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">o</span>(<span class="params">n, t, r, o, u, c, f</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> e(t &amp; r | ~t &amp; o, n, t, u, c, f)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">u</span>(<span class="params">n, t, r, o, u, c, f</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> e(t &amp; o | r &amp; ~o, n, t, u, c, f)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">c</span>(<span class="params">n, t, r, o, u, c, f</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> e(t ^ r ^ o, n, t, u, c, f)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params">n, t, r, o, u, c, f</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> e(r ^ (t | ~o), n, t, u, c, f)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">i</span>(<span class="params">n, r</span>) </span>&#123;</span><br><span class="line">        n[r &gt;&gt; <span class="number">5</span>] |= <span class="number">128</span> &lt;&lt; r % <span class="number">32</span>, n[<span class="number">14</span> + (r + <span class="number">64</span> &gt;&gt;&gt; <span class="number">9</span> &lt;&lt; <span class="number">4</span>)] = r;</span><br><span class="line">        <span class="keyword">var</span> e, i, a, d, h, l = <span class="number">1732584193</span>,</span><br><span class="line">            g = -<span class="number">271733879</span>,</span><br><span class="line">            v = -<span class="number">1732584194</span>,</span><br><span class="line">            m = <span class="number">271733878</span>;</span><br><span class="line">        <span class="keyword">for</span> (e = <span class="number">0</span>; e &lt; n.length; e += <span class="number">16</span>) i = l, a = g, d = v, h = m, g = f(g = f(g = f(g = f(g = c(g = c(g = c(g = c(g = u(g = u(g = u(g = u(g = o(g = o(g = o(g = o(g, v = o(v, m = o(m, l = o(l, g, v, m, n[e], <span class="number">7</span>, -<span class="number">680876936</span>), g, v, n[e + <span class="number">1</span>], <span class="number">12</span>, -<span class="number">389564586</span>), l, g, n[e + <span class="number">2</span>], <span class="number">17</span>, <span class="number">606105819</span>), m, l, n[e + <span class="number">3</span>], <span class="number">22</span>, -<span class="number">1044525330</span>), v = o(v, m = o(m, l = o(l, g, v, m, n[e + <span class="number">4</span>], <span class="number">7</span>, -<span class="number">176418897</span>), g, v, n[e + <span class="number">5</span>], <span class="number">12</span>, <span class="number">1200080426</span>), l, g, n[e + <span class="number">6</span>], <span class="number">17</span>, -<span class="number">1473231341</span>), m, l, n[e + <span class="number">7</span>], <span class="number">22</span>, -<span class="number">45705983</span>), v = o(v, m = o(m, l = o(l, g, v, m, n[e + <span class="number">8</span>], <span class="number">7</span>, <span class="number">1770035416</span>), g, v, n[e + <span class="number">9</span>], <span class="number">12</span>, -<span class="number">1958414417</span>), l, g, n[e + <span class="number">10</span>], <span class="number">17</span>, -<span class="number">42063</span>), m, l, n[e + <span class="number">11</span>], <span class="number">22</span>, -<span class="number">1990404162</span>), v = o(v, m = o(m, l = o(l, g, v, m, n[e + <span class="number">12</span>], <span class="number">7</span>, <span class="number">1804603682</span>), g, v, n[e + <span class="number">13</span>], <span class="number">12</span>, -<span class="number">40341101</span>), l, g, n[e + <span class="number">14</span>], <span class="number">17</span>, -<span class="number">1502002290</span>), m, l, n[e + <span class="number">15</span>], <span class="number">22</span>, <span class="number">1236535329</span>), v = u(v, m = u(m, l = u(l, g, v, m, n[e + <span class="number">1</span>], <span class="number">5</span>, -<span class="number">165796510</span>), g, v, n[e + <span class="number">6</span>], <span class="number">9</span>, -<span class="number">1069501632</span>), l, g, n[e + <span class="number">11</span>], <span class="number">14</span>, <span class="number">643717713</span>), m, l, n[e], <span class="number">20</span>, -<span class="number">373897302</span>), v = u(v, m = u(m, l = u(l, g, v, m, n[e + <span class="number">5</span>], <span class="number">5</span>, -<span class="number">701558691</span>), g, v, n[e + <span class="number">10</span>], <span class="number">9</span>, <span class="number">38016083</span>), l, g, n[e + <span class="number">15</span>], <span class="number">14</span>, -<span class="number">660478335</span>), m, l, n[e + <span class="number">4</span>], <span class="number">20</span>, -<span class="number">405537848</span>), v = u(v, m = u(m, l = u(l, g, v, m, n[e + <span class="number">9</span>], <span class="number">5</span>, <span class="number">568446438</span>), g, v, n[e + <span class="number">14</span>], <span class="number">9</span>, -<span class="number">1019803690</span>), l, g, n[e + <span class="number">3</span>], <span class="number">14</span>, -<span class="number">187363961</span>), m, l, n[e + <span class="number">8</span>], <span class="number">20</span>, <span class="number">1163531501</span>), v = u(v, m = u(m, l = u(l, g, v, m, n[e + <span class="number">13</span>], <span class="number">5</span>, -<span class="number">1444681467</span>), g, v, n[e + <span class="number">2</span>], <span class="number">9</span>, -<span class="number">51403784</span>), l, g, n[e + <span class="number">7</span>], <span class="number">14</span>, <span class="number">1735328473</span>), m, l, n[e + <span class="number">12</span>], <span class="number">20</span>, -<span class="number">1926607734</span>), v = c(v, m = c(m, l = c(l, g, v, m, n[e + <span class="number">5</span>], <span class="number">4</span>, -<span class="number">378558</span>), g, v, n[e + <span class="number">8</span>], <span class="number">11</span>, -<span class="number">2022574463</span>), l, g, n[e + <span class="number">11</span>], <span class="number">16</span>, <span class="number">1839030562</span>), m, l, n[e + <span class="number">14</span>], <span class="number">23</span>, -<span class="number">35309556</span>), v = c(v, m = c(m, l = c(l, g, v, m, n[e + <span class="number">1</span>], <span class="number">4</span>, -<span class="number">1530992060</span>), g, v, n[e + <span class="number">4</span>], <span class="number">11</span>, <span class="number">1272893353</span>), l, g, n[e + <span class="number">7</span>], <span class="number">16</span>, -<span class="number">155497632</span>), m, l, n[e + <span class="number">10</span>], <span class="number">23</span>, -<span class="number">1094730640</span>), v = c(v, m = c(m, l = c(l, g, v, m, n[e + <span class="number">13</span>], <span class="number">4</span>, <span class="number">681279174</span>), g, v, n[e], <span class="number">11</span>, -<span class="number">358537222</span>), l, g, n[e + <span class="number">3</span>], <span class="number">16</span>, -<span class="number">722521979</span>), m, l, n[e + <span class="number">6</span>], <span class="number">23</span>, <span class="number">76029189</span>), v = c(v, m = c(m, l = c(l, g, v, m, n[e + <span class="number">9</span>], <span class="number">4</span>, -<span class="number">640364487</span>), g, v, n[e + <span class="number">12</span>], <span class="number">11</span>, -<span class="number">421815835</span>), l, g, n[e + <span class="number">15</span>], <span class="number">16</span>, <span class="number">530742520</span>), m, l, n[e + <span class="number">2</span>], <span class="number">23</span>, -<span class="number">995338651</span>), v = f(v, m = f(m, l = f(l, g, v, m, n[e], <span class="number">6</span>, -<span class="number">198630844</span>), g, v, n[e + <span class="number">7</span>], <span class="number">10</span>, <span class="number">1126891415</span>), l, g, n[e + <span class="number">14</span>], <span class="number">15</span>, -<span class="number">1416354905</span>), m, l, n[e + <span class="number">5</span>], <span class="number">21</span>, -<span class="number">57434055</span>), v = f(v, m = f(m, l = f(l, g, v, m, n[e + <span class="number">12</span>], <span class="number">6</span>, <span class="number">1700485571</span>), g, v, n[e + <span class="number">3</span>], <span class="number">10</span>, -<span class="number">1894986606</span>), l, g, n[e + <span class="number">10</span>], <span class="number">15</span>, -<span class="number">1051523</span>), m, l, n[e + <span class="number">1</span>], <span class="number">21</span>, -<span class="number">2054922799</span>), v = f(v, m = f(m, l = f(l, g, v, m, n[e + <span class="number">8</span>], <span class="number">6</span>, <span class="number">1873313359</span>), g, v, n[e + <span class="number">15</span>], <span class="number">10</span>, -<span class="number">30611744</span>), l, g, n[e + <span class="number">6</span>], <span class="number">15</span>, -<span class="number">1560198380</span>), m, l, n[e + <span class="number">13</span>], <span class="number">21</span>, <span class="number">1309151649</span>), v = f(v, m = f(m, l = f(l, g, v, m, n[e + <span class="number">4</span>], <span class="number">6</span>, -<span class="number">145523070</span>), g, v, n[e + <span class="number">11</span>], <span class="number">10</span>, -<span class="number">1120210379</span>), l, g, n[e + <span class="number">2</span>], <span class="number">15</span>, <span class="number">718787259</span>), m, l, n[e + <span class="number">9</span>], <span class="number">21</span>, -<span class="number">343485551</span>), l = t(l, i), g = t(g, a), v = t(v, d), m = t(m, h);</span><br><span class="line">        <span class="keyword">return</span> [l, g, v, m]</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params">n</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> t, r = <span class="string">&quot;&quot;</span>,</span><br><span class="line">            e = <span class="number">32</span> * n.length;</span><br><span class="line">        <span class="keyword">for</span> (t = <span class="number">0</span>; t &lt; e; t += <span class="number">8</span>) r += <span class="built_in">String</span>.fromCharCode(n[t &gt;&gt; <span class="number">5</span>] &gt;&gt;&gt; t % <span class="number">32</span> &amp; <span class="number">255</span>);</span><br><span class="line">        <span class="keyword">return</span> r</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">d</span>(<span class="params">n</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> t, r = [];</span><br><span class="line">        <span class="keyword">for</span> (r[(n.length &gt;&gt; <span class="number">2</span>) - <span class="number">1</span>] = <span class="keyword">void</span> <span class="number">0</span>, t = <span class="number">0</span>; t &lt; r.length; t += <span class="number">1</span>) r[t] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">var</span> e = <span class="number">8</span> * n.length;</span><br><span class="line">        <span class="keyword">for</span> (t = <span class="number">0</span>; t &lt; e; t += <span class="number">8</span>) r[t &gt;&gt; <span class="number">5</span>] |= (<span class="number">255</span> &amp; n.charCodeAt(t / <span class="number">8</span>)) &lt;&lt; t % <span class="number">32</span>;</span><br><span class="line">        <span class="keyword">return</span> r</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">h</span>(<span class="params">n</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> a(i(d(n), <span class="number">8</span> * n.length))</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">l</span>(<span class="params">n, t</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> r, e, o = d(n),</span><br><span class="line">            u = [],</span><br><span class="line">            c = [];</span><br><span class="line">        <span class="keyword">for</span> (u[<span class="number">15</span>] = c[<span class="number">15</span>] = <span class="keyword">void</span> <span class="number">0</span>, o.length &gt; <span class="number">16</span> &amp;&amp; (o = i(o, <span class="number">8</span> * n.length)), r = <span class="number">0</span>; r &lt; <span class="number">16</span>; r += <span class="number">1</span>) u[r] = <span class="number">909522486</span> ^ o[r], c[r] = <span class="number">1549556828</span> ^ o[r];</span><br><span class="line">        <span class="keyword">return</span> e = i(u.concat(d(t)), <span class="number">512</span> + <span class="number">8</span> * t.length), a(i(c.concat(e), <span class="number">640</span>))</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">g</span>(<span class="params">n</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> t, r, e = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">for</span> (r = <span class="number">0</span>; r &lt; n.length; r += <span class="number">1</span>) t = n.charCodeAt(r), e += <span class="string">&quot;0123456789abcdef&quot;</span>.charAt(t &gt;&gt;&gt; <span class="number">4</span> &amp; <span class="number">15</span>) + <span class="string">&quot;0123456789abcdef&quot;</span>.charAt(<span class="number">15</span> &amp; t);</span><br><span class="line">        <span class="keyword">return</span> e</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">v</span>(<span class="params">n</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">unescape</span>(<span class="built_in">encodeURIComponent</span>(n))</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">m</span>(<span class="params">n</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> h(v(n))</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">p</span>(<span class="params">n</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> g(m(n))</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">s</span>(<span class="params">n, t</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> l(v(n), v(t))</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">C</span>(<span class="params">n, t</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> g(s(n, t))</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">A</span>(<span class="params">n, t, r</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> t ? r ? s(t, n) : C(t, n) : r ? m(n) : p(n)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="string">&quot;function&quot;</span> == <span class="keyword">typeof</span> define &amp;&amp; define.amd ? define(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> A</span><br><span class="line">    &#125;) : <span class="string">&quot;object&quot;</span> == <span class="keyword">typeof</span> <span class="built_in">module</span> &amp;&amp; <span class="built_in">module</span>.exports ? <span class="built_in">module</span>.exports = A : n.md5 = A</span><br><span class="line">&#125;(<span class="built_in">this</span>);</span><br><span class="line"><span class="comment">//# sourceMappingURL=md5.min.js.map</span></span><br></pre></td></tr></table></figure>

<p>保存文件，进入 <code>\themes\beantech\layout\post.ejs</code> ，将上面 Gitalk 的代码略做修改：</p>
<p>添加一行：</p>
<p><code>&lt;script src=&quot;/js/md5.min.js&quot;&gt;&lt;/script&gt;</code></p>
<p>并将：</p>
<p> <code>id: location.pathname,</code></p>
<p>修改为：</p>
<p><code>id: md5(location.pathname),</code></p>
<p>类似下面这样：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Gitalk start --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;gitalk-container&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;/js/md5.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> gitalk = <span class="keyword">new</span> Gitalk(&#123;</span></span><br><span class="line"><span class="javascript">      clientID: <span class="string">&#x27;GitHub Application Client ID&#x27;</span>,</span></span><br><span class="line"><span class="javascript">      clientSecret: <span class="string">&#x27;GitHub Application Client Secret&#x27;</span>,</span></span><br><span class="line"><span class="javascript">      repo: <span class="string">&#x27;GitHub 仓库的名字&#x27;</span>,  <span class="comment">//如 &#x27;convivae.github.io&#x27;</span></span></span><br><span class="line"><span class="javascript">      owner: <span class="string">&#x27;GitHub repository 所有者&#x27;</span>,</span></span><br><span class="line"><span class="javascript">      admin: [<span class="string">&#x27;对这个 repository 有写权限的用户&#x27;</span>], <span class="comment">//这是个字符串数组，可填写多个</span></span></span><br><span class="line"><span class="javascript">      id: md5(location.pathname),      <span class="comment">// 页面的唯一标识。长度必须小于50，默认是文章路径</span></span></span><br><span class="line"><span class="javascript">      distractionFreeMode: <span class="literal">true</span>  <span class="comment">// 类似Facebook评论框的全屏遮罩效果.</span></span></span><br><span class="line">    &#125;);</span><br><span class="line"><span class="javascript">    gitalk.render(<span class="string">&#x27;gitalk-container&#x27;</span>);</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- Gitalk end --&gt;</span></span><br></pre></td></tr></table></figure>

<p>到此，当你将代码推送到 Github 仓库后，进入你的博客就能看到出现评论框了。</p>
<h3 id="自动初始化-Gitalk-和-Gitment-评论"><a href="#自动初始化-Gitalk-和-Gitment-评论" class="headerlink" title="自动初始化 Gitalk 和 Gitment 评论"></a>自动初始化 Gitalk 和 Gitment 评论</h3><p>需要说明的是，Gitalk 需要你点开每篇文章的页面才会创建对应的 issue，对于文章比较多又比较懒的人来说并不友好，你可以参照这篇 <a target="_blank" rel="noopener" href="https://convivae.github.io/posts/zi-dong-chu-shi-hua-gitalk-he-gitment-ping-lun/">自动初始化 Gitalk 和 Gitment 评论</a> 进行设置。</p>
<h2 id="添加图片放大功能"><a href="#添加图片放大功能" class="headerlink" title="添加图片放大功能"></a>添加图片放大功能</h2><p>两种方案，<a target="_blank" rel="noopener" href="https://desmonding.me/zooming/docs/#/">zooming</a> 或 <a target="_blank" rel="noopener" href="https://github.com/fancyapps/fancyBox">fancybox</a></p>
<h3 id="zooming"><a href="#zooming" class="headerlink" title="zooming"></a>zooming</h3><p>首先下载 <code>zooming.js</code> 的文件 <a target="_blank" rel="noopener" href="https://github.com/kingdido999/zooming/tree/master/build/zooming.js">地址</a>，保存在 <code>themes\beantech\source\js</code> 目录下，打开 <code>themes\beantech\layout\post.ejs</code>，在最下方粘贴：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;script type=<span class="string">&quot;text/javascript&quot;</span> src=<span class="string">&quot;/js/zooming.js&quot;</span>&gt;&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>或者，直接用 <code>npm</code> 安装</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install zooming --save</span><br></pre></td></tr></table></figure>

<p>然后打开 <code>themes\beantech\layout\post.ejs</code>，在最下方粘贴：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;script src=<span class="string">&quot;node_modules/zooming/build/zooming.min.js&quot;</span>&gt;&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>然后在 <code>.md</code> 文件中引入图片时，在需要进行缩放的图片上内敛 <code>html</code> 语法，加上 <code>data-action=&quot;zoom&quot;</code> ，经典的 markdown 语法 <code>![img caption](img url)</code> 不能实现该功能（至少我目前不能，如果你知道怎么实现，请告诉我）</p>
<p>类似下面这样：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;img/some_img.png&quot;</span> <span class="attr">alt</span> = <span class="string">&quot;some_text&quot;</span> <span class="attr">data-action</span>=<span class="string">&quot;zoom&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>

<p>然后文章里的图片即可单击全屏。</p>
<p>你还可以使用 <code>data-original</code> 属性来使放大的图片指向高清大图，类似下面这样：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;img/thumbnail.jpg&quot;</span> <span class="attr">data-action</span>=<span class="string">&quot;zoom&quot;</span> <span class="attr">data-original</span>=<span class="string">&quot;img/original.jpg&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="添加访客人数统计和字数统计"><a href="#添加访客人数统计和字数统计" class="headerlink" title="添加访客人数统计和字数统计"></a>添加访客人数统计和字数统计</h2><h3 id="访客人数统计"><a href="#访客人数统计" class="headerlink" title="访客人数统计"></a>访客人数统计</h3><p>在 <a target="_blank" rel="noopener" href="http://amazingcounters.com/">amazingcounters</a> 中创建账号并选择合适的样式，将其中的 <code>Standard Code</code> 复制到 <code>themes\beantech\layout\_partial\footer.ejs</code> 下面的位置：</p>
<p><img data-src="footer.png" alt="footer"></p>
<p>注意去掉默认代码中的 <code>&lt;div align=&quot;center&quot;&gt;&lt;/div&gt;</code> 以及 <code>&lt;href = &quot;...&quot;&gt;</code>，这样就能保持博客格式的不变而且不会点击就跳转到他的网站。</p>
<h3 id="字数统计"><a href="#字数统计" class="headerlink" title="字数统计"></a>字数统计</h3><p>首先安装插件：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm i --save hexo-wordcount</span><br></pre></td></tr></table></figure>

<p>然后在 <code>themes\beantech\layout\_partial\footer.ejs</code> 中添加如下代码：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;post-count&quot;</span>&gt;</span>&lt;%= totalcount(site) %&gt; words altogether<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>具体位置如上图所示。</p>
<h2 id="将博客同时托管到-coding-上"><a href="#将博客同时托管到-coding-上" class="headerlink" title="将博客同时托管到 coding 上"></a>将博客同时托管到 coding 上</h2><p>github 由于服务器位于国外，国内的访问速度很慢，造成了非常不好的体验，我们可以同时部署到国内的托管平台 coding.net 上来加快国内的访问速度。</p>
<h3 id="coding-的准备工作"><a href="#coding-的准备工作" class="headerlink" title="coding 的准备工作"></a>coding 的准备工作</h3><p>进入 <a target="_blank" rel="noopener" href="https://coding.net/">coding</a>，点击个人版登录，注册并登陆账户，如果你之前注册过腾讯云的服务，会自动跳转到腾讯云开发者平台，进入控制台，新建一个项目，填写项目名称（最好与用户名一致）、项目地址进行创建，进入项目，点击 <code>Pages 服务</code>：</p>
<p><img data-src="pages.png" alt="pages"></p>
<p>开启 Pages 功能，分支选 master</p>
<h3 id="自定义域名-amp-域名解析"><a href="#自定义域名-amp-域名解析" class="headerlink" title="自定义域名 &amp; 域名解析"></a>自定义域名 &amp; 域名解析</h3><p>Pages 的设置页面可以设置自定义域名，购买域名之后在域名注册商（比如我的是在阿里云）按照下面图片所示设置 DNS 解析：</p>
<p><img data-src="dns.png" alt="dns"></p>
<p>添加 CNAME 值指向 <code>your-name.coding.net</code> 即可，不必再设置 A 记录，因为 ip 地址可能会变，下面的几个指向境外的是 github 的设置，那几个 ip 地址主要是为了开启 github 的 https 功能，根据 <a target="_blank" rel="noopener" href="https://help.github.com/en/articles/setting-up-an-apex-domain">github 官方</a> 的描述，设置一个（即<code>your-name.github.io</code> 实际指向的那个）即可。注意，不建议开启 coding 的 https 功能，某些浏览器会认为他的证书不安全</p>
<p>之后在本地的 <code>source/CNAME</code> 中填写自己的域名，注意不要加 <code>http://</code> 或 <code>https://</code>，也不要加 <code>www.</code>，因为域名的定义中本身就不包含这些前缀，填写 <code>your-name.xxx</code> 即可</p>
<h3 id="SSH-登陆-coding"><a href="#SSH-登陆-coding" class="headerlink" title="SSH 登陆 coding"></a>SSH 登陆 coding</h3><p>其实上一步完成之后就可以修改 <code>_config.yml</code> 的 <code>deploy</code> 属性进行代码同步了，但是 <code>deploy</code> 时每次都要输入密码很麻烦，所以我们开启一下 <code>SSH公钥</code> 的功能</p>
<p>在 coding 的个人设置中找到 <code>SSH公钥</code>，按照 <a target="_blank" rel="noopener" href="https://dev.tencent.com/help/doc/faq/bbe781aee786/ssh">官方文档</a> 进行配置，如果你之前配置过 github 的 SSH，这一步注意不要无脑回车，在生成路径那里要自己另外设置一个路径，否则你原来 github 的公钥就会被新生成的公钥覆盖掉</p>
<p>打开你的项目，复制上面 SSH 的网址，进入本地根目录下 <code>_config.yml</code>，进行如下的配置：</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">deploy:</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">type:</span> <span class="string">git</span></span><br><span class="line">  <span class="attr">repository:</span> <span class="string">git@github.com:your-name/your-name.github.io.git</span></span><br><span class="line">  <span class="attr">branch:</span> <span class="string">master</span></span><br><span class="line"></span><br><span class="line"><span class="bullet">-</span> <span class="attr">type:</span> <span class="string">git</span></span><br><span class="line">  <span class="attr">repository:</span> <span class="string">git@git.dev.tencent.com:your-name/your-name.git</span></span><br><span class="line">  <span class="attr">branch:</span> <span class="string">master</span></span><br></pre></td></tr></table></figure>

<p>修改其中的ssh地址为你自己项目的地址，然后 <code>hexo clean; hexo g; hexo d</code>，（<code>hexo g; hexo d</code> 可用 <code>hexo d -g</code> 来代替）即可同步更新你的网站到 github 和 coding 了。</p>
<h2 id="to-do-list"><a href="#to-do-list" class="headerlink" title="to do list"></a>to do list</h2><ul>
<li><p>文章分享（微博、微信、空间）链接</p>
</li>
<li><p>更改签名图片</p>
</li>
<li><p>添加邮箱</p>
</li>
</ul>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p><a target="_blank" rel="noopener" href="https://github.com/hexojs/hexo-renderer-markdown-it/issues/40">hexojs/hexo-renderer-markdown-it #40</a><br><a target="_blank" rel="noopener" href="https://github.com/YenYuHsuan/hexo-theme-beantech/issues/11">hexo-theme-beantech #11</a><br><a target="_blank" rel="noopener" href="https://knightcai.github.io/2017/12/19/%E4%B8%BA%E5%8D%9A%E5%AE%A2%E6%B7%BB%E5%8A%A0-Gitalk-%E8%AF%84%E8%AE%BA%E6%8F%92%E4%BB%B6/">为博客添加-Gitalk-评论插件</a><br><a target="_blank" rel="noopener" href="https://godweiyang.com/2018/04/13/hexo-blog/">WeiYang Blog</a></p>
]]></content>
      <categories>
        <category>Blog</category>
        <category>Hexo</category>
      </categories>
      <tags>
        <tag>Blog</tag>
        <tag>Gitalk</tag>
        <tag>TOC</tag>
        <tag>JS</tag>
      </tags>
  </entry>
  <entry>
    <title>Mybatis学习笔记02</title>
    <url>/posts/mybatis-xue-xi-bi-ji-02/</url>
    <content><![CDATA[<h2 id="Mybatis-开发流程图"><a href="#Mybatis-开发流程图" class="headerlink" title="Mybatis 开发流程图"></a>Mybatis 开发流程图</h2><p><img data-src="01.png" alt="Mybatis 开发流程图"></p>
<h2 id="基于代理DAO实现CRUD操作（使用xml配置）"><a href="#基于代理DAO实现CRUD操作（使用xml配置）" class="headerlink" title="基于代理DAO实现CRUD操作（使用xml配置）"></a>基于代理DAO实现CRUD操作（使用xml配置）</h2><blockquote>
<p>使用要求： </p>
<ol>
<li>持久层接口和持久层接口的映射配置必须在相同的包下</li>
<li>持久层映射配置中 mapper 标签的 namespace 属性取值必须是持久层接口的全限定类名</li>
<li>SQL 语句的配置标签 <code>&lt;select&gt;</code>, <code>&lt;insert&gt;</code>, <code>&lt;delete&gt;</code>, <code>&lt;update&gt;</code> 的 id 属性必须和持久层接口的 方法名相同。 </li>
</ol>
</blockquote>
<h3 id="1-持久层接口中的方法"><a href="#1-持久层接口中的方法" class="headerlink" title="1.  持久层接口中的方法"></a>1.  持久层接口中的方法</h3><p><code>com\conv\dao\IUserDao.java</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.conv.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.conv.domain.User;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IUserDao</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 查询所有用户</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function">List&lt;User&gt; <span class="title">findAll</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 保存用户</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> user</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">saveUser</span><span class="params">(User user)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 更新用户</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> user</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">updateUser</span><span class="params">(User user)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *  根据id删除用户</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">deleteUser</span><span class="params">(Integer id)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 根据id查询用户信息</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> userId</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function">User <span class="title">findById</span><span class="params">(Integer userId)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 根据名称模糊查询用户信息</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> username</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function">List&lt;User&gt; <span class="title">findByName</span><span class="params">(String username)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 查询总用户数</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">findTotal</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-用户映射配置文件中的配置"><a href="#2-用户映射配置文件中的配置" class="headerlink" title="2. 用户映射配置文件中的配置"></a>2. 用户映射配置文件中的配置</h3><p><code>com\conv\dao\IUserDao.xml</code></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--namespace是Dao的全限定类名--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.conv.dao.IUserDao&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--配置查询所有--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--id是dao的方法名称，不能随便写--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findAll&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.conv.domain.User&quot;</span>&gt;</span></span><br><span class="line">        select * from user;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--保存用户--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--新增用户后，同时还要返回当前新增用户的 id 值，因为 id 是由数据库的自动增长来实现的，所以就相 当于我们要在新增后将自动增长 auto_increment 的值返回--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">&quot;saveUser&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;com.conv.domain.User&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 配置插入操作后，获取插入数据的id --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">selectKey</span> <span class="attr">keyProperty</span>=<span class="string">&quot;id&quot;</span> <span class="attr">keyColumn</span>=<span class="string">&quot;id&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;int&quot;</span> <span class="attr">order</span>=<span class="string">&quot;AFTER&quot;</span>&gt;</span></span><br><span class="line">            select last_insert_id();</span><br><span class="line">        <span class="tag">&lt;/<span class="name">selectKey</span>&gt;</span></span><br><span class="line">        insert into user(username, birthday, sex, address) values (#&#123;username&#125;,#&#123;birthday&#125;,#&#123;sex&#125;,#&#123;address&#125;);</span><br><span class="line">    <span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--更新用户--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">&quot;updateUser&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;com.conv.domain.User&quot;</span>&gt;</span></span><br><span class="line">        update user set username=#&#123;username&#125;,address=#&#123;address&#125;,sex=#&#123;sex&#125;,birthday=#&#123;birthday&#125; where id = #&#123;id&#125;;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--删除用户--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--parameterType可以写Integer、INT、java.lang.Integer（不区分大小写）--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">delete</span> <span class="attr">id</span>=<span class="string">&quot;deleteUser&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;Integer&quot;</span>&gt;</span></span><br><span class="line">        delete from user where  id = #&#123;uid&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">delete</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--根据id查询用户--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findById&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;Int&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.conv.domain.User&quot;</span>&gt;</span></span><br><span class="line">        select * from user where id = #&#123;uid&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--根据名称模糊查询用户信息--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findByName&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;string&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.conv.domain.User&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 常用  --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--select * from user where username like #&#123;uname&#125;--&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!--  不常用，会造成Sql注入 --&gt;</span></span><br><span class="line">        select * from user where username like &#x27;%$&#123;value&#125;%&#x27;;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!--查询总用户数--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findTotal&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;int&quot;</span>&gt;</span></span><br><span class="line">        select count(id) from user ;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>细节：</p>
<ol>
<li><p>resultType 属性</p>
<blockquote>
<p>用于指定结果集的类型</p>
</blockquote>
</li>
<li><p>parameterType 属性</p>
<blockquote>
<p>用于指定传入参数的类型，</p>
<p>若传入的是基本类型：我们可以直接写类型名称 ，也可以使用包名 . 类名的方式 ，如 Integer 类型，可以写<code>Integer</code>、<code>INT</code>、<code>java.lang.Integer</code>等，不区分大小写</p>
<p>若传入的是实体类类型，目前我们只能使用全限定类名。 </p>
<p>究其原因，是 mybaits 在加载时已经把常用的数据类型注册了别名，从而我们在使用时可以不写包名， 而我们的是实体类并没有注册别名，所以必须写全限定类名</p>
</blockquote>
</li>
<li><p>sql 语句中使用<code>#&#123;&#125;</code>字符</p>
<blockquote>
<p>它代表占位符，相当于原来 jdbc 部分所学的 <code>?</code>，都是用于执行语句时替换实际的数据。    </p>
<p>具体的数据是由 <code>#&#123;&#125;</code> 里面的内容决定的。 </p>
</blockquote>
</li>
<li><p><code>#&#123;&#125;</code> 中内容的写法</p>
<blockquote>
<p>根据数据类型的不同，写法也有所不同，当保存方法的参数的数据类型是：</p>
<ol>
<li>基本类型：此处可以随意写</li>
<li> User 对象：此处要写 User 对象中的属性名称。 它用的是 ognl 表达式。 </li>
</ol>
<p>ognl 表达式：   </p>
<p>它是 apache 提供的一种表达式语言，全称是：<code>Object Graphic Navigation Language </code> 对象图导航语言   它是按照一定的语法格式来获取数据的。   </p>
<p>语法格式就是使用  <code>#&#123;对象.对象&#125;</code> 的方式 </p>
<p>比如：我们获取用户的名称：</p>
<ul>
<li>类中的写法：<code>user.getUsername()</code></li>
<li>ONGL表达式的写法：<code>user.username</code></li>
</ul>
<p><code>#&#123;user.username&#125;</code> 它会先去找 user 对象，然后在 user 对象中找到 username 属性，并调用 getUsername()方法把值取出来。</p>
<p>mybatis 中为什么能直接写 <code>username</code>，而不是 <code>user.</code> 呢？</p>
<p>但是我们在 parameterType 属性上指定了实体类名称，所以可以省略 user. 而直接写 username。 </p>
</blockquote>
</li>
</ol>
</li>
</ul>
<h3 id="3-添加测试类中的测试方法"><a href="#3-添加测试类中的测试方法" class="headerlink" title="3. 添加测试类中的测试方法"></a>3. 添加测试类中的测试方法</h3><p>  <code>com\conv\test\MybatisTest.java</code></p>
  <figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.conv.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MybatisTest</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> InputStream in;</span><br><span class="line">    <span class="keyword">private</span> SqlSession session;</span><br><span class="line">    IUserDao userDao;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Before</span> <span class="comment">//用于在测试方法执行之前执行</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="comment">//1. 读取配置文件，生成字节输入流</span></span><br><span class="line">        in = Resources.getResourceAsStream(<span class="string">&quot;SqlMapConfig.xml&quot;</span>);</span><br><span class="line">        <span class="comment">//2. 获取SqlSessionFactory</span></span><br><span class="line">        SqlSessionFactory factory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(in);</span><br><span class="line">        <span class="comment">//3. 获取SqlSession对象</span></span><br><span class="line">        session = factory.openSession();</span><br><span class="line">        <span class="comment">//4. 获取dao的代理对象</span></span><br><span class="line">        userDao = session.getMapper(IUserDao.class);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@After</span>  <span class="comment">//用于在测试方法执行之后执行</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="comment">// 提交事务</span></span><br><span class="line">        <span class="comment">// 若没有此句，打开 Mysql 数据库发现并没有修改任何记录，原因是什么？ </span></span><br><span class="line">        <span class="comment">// 这一点和 jdbc 是一样的，我们在实现增删改时一定要去控制事务的提交</span></span><br><span class="line">        <span class="comment">// 可以使用: session.commit();来实现事务提交</span></span><br><span class="line">        session.commit();</span><br><span class="line">        <span class="comment">// 关闭资源</span></span><br><span class="line">        session.close();</span><br><span class="line">        in.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * 测试查询所有</span></span><br><span class="line"><span class="comment">       *</span></span><br><span class="line"><span class="comment">       * <span class="doctag">@throws</span> IOException</span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="meta">@Ignore</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testFinfAll</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        List&lt;User&gt; users = userDao.findAll();</span><br><span class="line">        <span class="keyword">for</span> (User user : users) &#123;</span><br><span class="line">            System.out.println(user);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * 测试新增用户</span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSave</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        User user = <span class="keyword">new</span> User();</span><br><span class="line">        user.setUsername(<span class="string">&quot;saveuser&quot;</span>);</span><br><span class="line">        user.setAddress(<span class="string">&quot;湖北武汉&quot;</span>);</span><br><span class="line">        user.setSex(<span class="string">&quot;男&quot;</span>);</span><br><span class="line">        user.setBirthday(<span class="keyword">new</span> Date());</span><br><span class="line"></span><br><span class="line">        <span class="comment">//执行保存方法</span></span><br><span class="line">        System.out.println(<span class="string">&quot;保存之前：&quot;</span> + user);</span><br><span class="line">        userDao.saveUser(user);</span><br><span class="line">        System.out.println(<span class="string">&quot;保存之后：&quot;</span> + user);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * 测试更新操作</span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="meta">@Ignore</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testUpdate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        User user = <span class="keyword">new</span> User();</span><br><span class="line">        user.setId(<span class="number">51</span>);</span><br><span class="line">        user.setUsername(<span class="string">&quot;testUpdate&quot;</span>);</span><br><span class="line">        user.setAddress(<span class="string">&quot;北京市顺义区&quot;</span>);</span><br><span class="line">        user.setSex(<span class="string">&quot;女&quot;</span>);</span><br><span class="line">        user.setBirthday(<span class="keyword">new</span> Date());</span><br><span class="line"></span><br><span class="line">        <span class="comment">//执行更新方法</span></span><br><span class="line">        userDao.updateUser(user);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * 测试删除操作</span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="meta">@Ignore</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testDelete</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//执行更新方法</span></span><br><span class="line">        userDao.deleteUser(<span class="number">71</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * 测试查询操作</span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="meta">@Ignore</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testFindOne</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//执行方法</span></span><br><span class="line">        User user = userDao.findById(<span class="number">51</span>);</span><br><span class="line">        System.out.println(user);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * 测试模糊查询操作</span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="meta">@Ignore</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testFindByName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//执行方法</span></span><br><span class="line">        <span class="comment">//        List&lt;User&gt; users = userDao.findByName(&quot;%小%&quot;);</span></span><br><span class="line">        List&lt;User&gt; users = userDao.findByName(<span class="string">&quot;小&quot;</span>);</span><br><span class="line">        users.forEach(System.out::println);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * 测试查询总记录条数</span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="meta">@Ignore</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testFindTotal</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//执行方法</span></span><br><span class="line">        <span class="keyword">int</span> count = userDao.findTotal();</span><br><span class="line">        System.out.println(count);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">  </span><br></pre></td></tr></table></figure>

<ul>
<li><p>注意</p>
<blockquote>
<p>和 JDBC 一样，我们在实现增删改时一定要去控制事务的提交</p>
<p>在 mybatis 中可以使用 <code>session.commit();</code> 来实现事务提交</p>
</blockquote>
</li>
</ul>
<h3 id="模糊查询的两种方法"><a href="#模糊查询的两种方法" class="headerlink" title="模糊查询的两种方法"></a>模糊查询的两种方法</h3>  <figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--根据名称模糊查询用户信息--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findByName&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;string&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.conv.domain.User&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 常用  --&gt;</span></span><br><span class="line">    select * from user where username like #&#123;uname&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--  不常用，会造成Sql注入 --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--select * from user where username like &#x27;%$&#123;value&#125;%&#x27;;--&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>结论</p>
<p>这两种方式的实现效果是一样的，但执行的语句是不一样的。 </p>
</li>
</ul>
<ol>
<li><p>select * from user where username like #{uname};`</p>
<p>对应的查询方法需要加上<code>%</code>：</p>
<p><code>List&lt;User&gt; users = userDao.findByName(&quot;%小%&quot;);</code></p>
<p>在控制台输出的执行 SQL 语句如下：</p>
<blockquote>
<p>Preparing: select * from user where username like ?<br>Parameters: %小%(String)</p>
</blockquote>
<p>使用的是 <code>Preparedstatement</code>，不会造成 SQL 注入问题</p>
</li>
<li><p><code>select * from user where username like &#39;%$&#123;value&#125;%&#39;;</code></p>
<p>对应的方法无需加<code>%</code>：</p>
<p><code>List&lt;User&gt; users = userDao.findByName(&quot;小&quot;); </code></p>
<p>在控制台输出的执行 SQL 语句如下：</p>
<blockquote>
<p>Preparing: select * from user where username like ‘%小%’; </p>
<p>Parameters: </p>
</blockquote>
<p>即直接拼接 SQL，容易造成 SQL 注入问题</p>
</li>
<li><p>如图：</p>
<p><img data-src="02.png" alt="两种方法的比较"></p>
</li>
</ol>
<h4 id="与-的区别"><a href="#与-的区别" class="headerlink" title="#{} 与 ${} 的区别"></a><code>#&#123;&#125;</code> 与 <code>$&#123;&#125;</code> 的区别</h4><ul>
<li><code>#&#123;&#125;</code> 表示一个占位符号  </li>
</ul>
<p>通过 <code>#&#123;&#125;</code> 可以实现 <code>preparedStatement</code> 向占位符中设置值，自动进行 java 类型和 jdbc 类型转换， <code>#&#123;&#125;</code>可以有效防止 sql 注入。 <code>#&#123;&#125;</code> 可以接收简单类型值或 pojo 属性值。 如果 <code>parameterType</code> 传输单个简单类 型值，<code>#&#123;&#125;</code> 括号中可以是 value 或其它名称。</p>
<ul>
<li><code>$&#123;&#125;</code> 表示拼接 sql 串 </li>
</ul>
<p>通过 <code>$&#123;&#125;</code> 可以将 <code>parameterType</code> 传入的内容拼接在 sql中且不进行 jdbc 类型转换， <code>$&#123;&#125;</code>可以接收简单类型值或 pojo 属性值，如果 <code>parameterType</code> 传输单个简单类型值，**<code>$&#123;&#125;</code> 括号中只能是 value**（源码中指定了读取的 key 的名字就是 <code>value</code>，所以我们在绑定参数时就只能叫 value 的名字 ）</p>
<h3 id="Mybatis-与-JDBC-编程的比较"><a href="#Mybatis-与-JDBC-编程的比较" class="headerlink" title="Mybatis 与 JDBC 编程的比较"></a>Mybatis 与 JDBC 编程的比较</h3><ol>
<li><p>数据库链接创建、释放频繁造成系统资源浪费从而影响系统性能，如果使用数据库链接池可解决此问题。 解决：  </p>
<blockquote>
<p>在 SqlMapConfig.xml 中配置数据链接池，使用连接池管理数据库链接。 </p>
</blockquote>
</li>
<li><p>Sql 语句写在代码中造成代码不易维护，实际应用 sql 变化的可能较大，sql 变动需要改变 java 代码。</p>
<p>解决：  </p>
<blockquote>
<p>将 Sql 语句配置在 XXXXmapper.xml 文件中与 java 代码分离。 </p>
</blockquote>
</li>
<li><p>向 Sql 语句传参数麻烦，因为 sql 语句的 where 条件不一定，可能多也可能少，占位符需要和参数对应。 解决：  </p>
<blockquote>
<p>Mybatis 自动将 java 对象映射至 sql 语句，通过 statement 中的 parameterType 定义输入参数的 类型。</p>
</blockquote>
</li>
<li><p>对结果集解析麻烦，sql 变化导致解析代码变化，且解析前需要遍历，如果能将数据库记录封装成 pojo 对 象解析比较方便。 </p>
<p>解决：  </p>
<blockquote>
<p>Mybatis自动将 sql执行结果映射至 java 对象，通过statement中的resultType 定义输出结果的 类型。</p>
</blockquote>
</li>
</ol>
<h2 id="Mybatis-的参数深入"><a href="#Mybatis-的参数深入" class="headerlink" title="Mybatis 的参数深入"></a>Mybatis 的参数深入</h2><h3 id="使用说明"><a href="#使用说明" class="headerlink" title="使用说明"></a>使用说明</h3><blockquote>
<p>SQL 语句传参，使用标签的 parameterType 属性来设定。</p>
<p>该属性的取值可以 是基本类型，引用类型（例如:String 类型），还可以是实体类类型（POJO 类）；</p>
<p>同时也可以使用实体类的包装类，本章节将介绍如何使用实体类的包装类作为参数传递。 </p>
</blockquote>
<h3 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h3><p>基本类型和 String 我们可以直接写类型名称 ，也可以使用包名 . 类名的方式 ，例如 ：java.lang.String</p>
<p>实体类类型，目前我们只能使用全限定类名。  </p>
<p>究其原因，是 mybaits 在加载时已经把常用的数据类型注册了别名，从而我们在使用时可以不写包名， 而我们的是实体类并没有注册别名，<strong>所以必须写全限定类名</strong></p>
<h3 id="传递-pojo-包装对象"><a href="#传递-pojo-包装对象" class="headerlink" title="传递 pojo 包装对象"></a>传递 pojo 包装对象</h3><blockquote>
<p>开发中通过 pojo 传递查询条件 ，查询条件是综合的查询条件，不仅包括用户查询条件还包括其它的查询条件（比如将用户购买商品信息也作为查询条件），这时可以使用包装对象传递输入参数。 </p>
<p> 需求：根据用户名查询用户信息，查询条件放到 QueryVo 的 user 属性中。</p>
</blockquote>
<p><code>QueryVo.java</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.conv.domain;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">QueryVo</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> User user;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> User <span class="title">getUser</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> user;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUser</span><span class="params">(User user)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.user = user;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>持久层接口 <code>IUserDao.java</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 根据 queryVo 中的条件查询用户</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> vo</span></span><br><span class="line"><span class="comment">* <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function">List&lt;User&gt; <span class="title">findUserByVo</span><span class="params">(QueryVo vo)</span></span>;</span><br></pre></td></tr></table></figure>

<p>持久层接口的映射文件 <code>com\conv\dao\IUserDao.xml</code></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--根据 queryVo 中的条件查询用户--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findUserByVo&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;com.conv.domain.QueryVo&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.conv.domain.User&quot;</span>&gt;</span></span><br><span class="line">    select * from user where username like #&#123;user.username&#125;;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>测试包装类作为参数 </p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 测试使用QureyVo作为查询条件</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testFindByVo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//执行方法</span></span><br><span class="line">    QueryVo vo = <span class="keyword">new</span> QueryVo();</span><br><span class="line">    User user = <span class="keyword">new</span> User();</span><br><span class="line">    user.setUsername(<span class="string">&quot;%王%&quot;</span>);</span><br><span class="line">    vo.setUser(user);</span><br><span class="line"></span><br><span class="line">    List&lt;User&gt; users = userDao.findUserByVo(vo);</span><br><span class="line"></span><br><span class="line">    users.forEach(System.out::println);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="数据库列名和-pojo-中的属性名不一致的情况"><a href="#数据库列名和-pojo-中的属性名不一致的情况" class="headerlink" title="数据库列名和 pojo 中的属性名不一致的情况"></a>数据库列名和 pojo 中的属性名不一致的情况</h2><blockquote>
<p>假设数据库中的列名为：</p>
<p>id, username, birthday, sex, address</p>
<p>pojo 中的属性名为：</p>
<p>userId, userName, userBirthday, userSex, userAddress</p>
</blockquote>
<h3 id="1-使用别名查询"><a href="#1-使用别名查询" class="headerlink" title="1. 使用别名查询"></a>1. 使用别名查询</h3><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 配置查询所有操作 --&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findAll&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.itheima.domain.User&quot;</span>&gt;</span></span><br><span class="line">    select id as userId, username as userName, birthday as userBirthday, sex as userSex, address as userAddress from user</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="2-使用-resultMap"><a href="#2-使用-resultMap" class="headerlink" title="2. 使用 resultMap"></a>2. 使用 resultMap</h3><blockquote>
<p>resultMap 标签可以建立查询的列名和实体类的属性名称不一致时建立对应关系。从而实现封装。 </p>
<p>在 select 标签中使用 resultMap 属性指定引用即可。</p>
<p>同时 resultMap 可以实现将查询结果映射为复杂类型的 pojo，比如在查询结果映射对象中包括 pojo 和 list 实现一对一查询和一对多查询。 </p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 建立 User 实体和数据库表的对应关系</span></span><br><span class="line"><span class="comment">type 属性：指定实体类的全限定类名  </span></span><br><span class="line"><span class="comment">id 属性：给定一个唯一标识，是给查询 select 标签引用用的。</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">&quot;com.itheima.domain.User&quot;</span> <span class="attr">id</span>=<span class="string">&quot;userMap&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">&quot;id&quot;</span> <span class="attr">property</span>=<span class="string">&quot;userId&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;username&quot;</span> <span class="attr">property</span>=<span class="string">&quot;userName&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;sex&quot;</span> <span class="attr">property</span>=<span class="string">&quot;userSex&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;address&quot;</span> <span class="attr">property</span>=<span class="string">&quot;userAddress&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;birthday&quot;</span> <span class="attr">property</span>=<span class="string">&quot;userBirthday&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span> </span><br><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">id 标签：用于指定主键字段 </span></span><br><span class="line"><span class="comment">result 标签：用于指定非主键字段 </span></span><br><span class="line"><span class="comment">column 属性：用于指定数据库列名 </span></span><br><span class="line"><span class="comment">property 属性：用于指定实体类属性名称</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br></pre></td></tr></table></figure>

<p>映射配置</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 配置查询所有操作 --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- resultyMap 属性是上面的 id 属性的值 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findAll&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;userMap&quot;</span>&gt;</span></span><br><span class="line">    select * from user</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>测试结果 </p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 测试查询所有</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IOException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testFinfAll</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    List&lt;User&gt; users = userDao.findAll();</span><br><span class="line">    <span class="keyword">for</span> (User user : users) &#123;</span><br><span class="line">        System.out.println(user);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="SqlMapConfig-xml-配置文件"><a href="#SqlMapConfig-xml-配置文件" class="headerlink" title="SqlMapConfig.xml 配置文件"></a>SqlMapConfig.xml 配置文件</h2><h3 id="properties（属性）"><a href="#properties（属性）" class="headerlink" title="properties（属性）"></a>properties（属性）</h3><p>在使用 properties 标签配置时，我们可以采用两种方式指定属性配置。 </p>
<ol>
<li>在标签内部配置连接数据库的信息</li>
</ol>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driver&quot;</span> <span class="attr">value</span>=<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;jdbc:mysql://localhost:3306/learn?serverTimezone=GMT%2B8<span class="symbol">&amp;amp;</span>characterEncoding=utf-8&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;root&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;4869&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--配置环境--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">&quot;mysql&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--配置myslq的环境--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">&quot;mysql&quot;</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--配置事务的类型--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">&quot;JDBC&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">transactionManager</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--配置数据源（连接池）--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">&quot;POOLED&quot;</span>&gt;</span></span><br><span class="line">                <span class="comment">&lt;!--配置连接数据库的基本信息--&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driver&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;driver&#125;&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;url&#125;&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;username&#125;&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;password&#125;&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ol start="2">
<li>通过属性引用外部配置文件信息</li>
</ol>
<ul>
<li>在 <code>resources</code>下定义 <code>jdbcConfig.properties</code> 文件</li>
</ul>
<figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="attr">driver</span>=<span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line"><span class="attr">url</span>=<span class="string">jdbc:mysql://localhost:3306/learn?serverTimezone=GMT%2B8</span></span><br><span class="line"><span class="attr">username</span>=<span class="string">root</span></span><br><span class="line"><span class="attr">password</span>=<span class="string">4869</span></span><br></pre></td></tr></table></figure>

<ul>
<li> properties 标签配置</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--配置连接数据库的信息</span></span><br><span class="line"><span class="comment">    resource 属性：用于指定 properties 配置文件的位置，要求配置文件必须在类路径下</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">properties</span> <span class="attr">resource</span>=<span class="string">&quot;jdbcConfig.properties&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>或：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--配置连接数据库的信息</span></span><br><span class="line"><span class="comment">    url 属性：</span></span><br><span class="line"><span class="comment">        URL：Uniform Resource Locator 统一资源定位符</span></span><br><span class="line"><span class="comment">            是按照 URL 的写法来写地址（协议 主机 端口 URI）</span></span><br><span class="line"><span class="comment">        URI：Uniform Resource Identifier 统一资源标识符</span></span><br><span class="line"><span class="comment">            它是在应用中可以唯一定位一个资源的位置</span></span><br><span class="line"><span class="comment">        它是可以在 web 应用中唯一定位一个资源的路径</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">properties</span> <span class="attr">url</span>=<span class="string">&quot;file:///E:/MySpace/IntelliJ IDEA/Mybatis_02/src/main/resources/jdbcConfig.properties&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="typeAliases（类型别名）"><a href="#typeAliases（类型别名）" class="headerlink" title="typeAliases（类型别名）"></a>typeAliases（类型别名）</h3><ol>
<li>typeAlias 单个别名自定义</li>
</ol>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--  使用 typeAliases 配置别名，它只能配置 domain 中类的别名 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- typeAlias 用于配置别名，type 属性指定的是实体类全限定类名，alias 属性指定别名，当指定了别名就不再区分大小写 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">typeAlias</span> <span class="attr">type</span>=<span class="string">&quot;com.conv.domain.User&quot;</span> <span class="attr">alias</span>=<span class="string">&quot;user&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ol start="2">
<li>package 批量别名自定义</li>
</ol>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--  用于指定要配置别名的包，当指定后，该包下的实体类都会注册别名，并且类名就是别名，不再区分大小写 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">&quot;com.conv.domain&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="mappers（映射器）"><a href="#mappers（映射器）" class="headerlink" title="mappers（映射器）"></a>mappers（映射器）</h3><ol>
<li> <code>&lt;mapper resource=&quot; &quot; /&gt;</code></li>
</ol>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--使用相对于类路径的资源--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">&quot;com/conv/dao/IUserDao.xml&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<ol start="2">
<li> <code>&lt;mapper class=&quot; &quot; /&gt; </code></li>
</ol>
<p><strong>注意：此种方法要求 mapper 接口名称和 mapper 映射文件名称相同，且放在同一个目录中</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--使用 mapper 接口类路径--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">class</span>=<span class="string">&quot;com.conv.dao.IUserDao&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<ol start="3">
<li> <code>&lt;package name=&quot;&quot;/&gt; </code></li>
</ol>
<p><strong>注意：此种方法要求 mapper 接口名称和 mapper 映射文件名称相同，且放在同一个目录中</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 注册指定包下的所有 mapper 接口 --&gt;</span></span><br><span class="line"><span class="comment">&lt;!--package 标签用于指定dao接口所在的包，</span></span><br><span class="line"><span class="comment">    当指定了之后就不需要再写 mapper 以及 class 或 resource 了--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">&quot;com.conv.dao&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<ol start="4">
<li>示例</li>
</ol>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--指定映射配置文件的位置，映射配置文件指的是每个DAO独立的配置文件</span></span><br><span class="line"><span class="comment">        如果是用注解来配置的话，此处应该使用class属性指定被注解的dao全限定类名</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--xml配置，路径是resource下的路径--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--&lt;mapper resource=&quot;com/conv/dao/IUserDao.xml&quot;/&gt;--&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--使用注解的配置--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--&lt;mapper class=&quot;com.conv.dao.IUserDao&quot;/&gt;--&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--package 标签用于指定dao接口所在的包，</span></span><br><span class="line"><span class="comment">        当指定了之后就不需要再写 mapper 以及 class 或 resource 了--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">&quot;com.conv.dao&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="PreparedStatement-对象的执行方法"><a href="#PreparedStatement-对象的执行方法" class="headerlink" title="PreparedStatement 对象的执行方法"></a>PreparedStatement 对象的执行方法</h2><ul>
<li>execute：它能执行 CRUD 的任意一种语句。<ul>
<li>返回值是一个 boolean 类型，表示是否有结果集，有结果集是 true，没有结果集是 false</li>
</ul>
</li>
<li>executeUpdate：它只能执行 CUD 语句，查询语句无法执行。<ul>
<li>返回值是影响数据库记录的行数</li>
</ul>
</li>
<li>executeQuery：它只能执行 SELECT 语句，无法执行增删改<ul>
<li>执行结果封装到结果集 ResultSet 对象</li>
</ul>
</li>
</ul>
<blockquote>
<p>CRUD：</p>
<p>增加(Create)、读取(Retrieve)、更新(Update)和删除(Delete)</p>
</blockquote>
]]></content>
      <categories>
        <category>Mybatis</category>
      </categories>
      <tags>
        <tag>Mybatis</tag>
        <tag>JDBC</tag>
      </tags>
  </entry>
  <entry>
    <title>Spring学习笔记01</title>
    <url>/posts/spring-xue-xi-bi-ji-01/</url>
    <content><![CDATA[<h2 id="Spring-概述"><a href="#Spring-概述" class="headerlink" title="Spring 概述"></a>Spring 概述</h2><blockquote>
<p>Spring是分层的 Java SE/EE应用 full-stack 轻量级开源框架，以 IoC（Inverse Of Control： 反转控制）和 AOP（Aspect Oriented Programming：面向切面编程）为内核，提供了展现层 Spring MVC 和持久层 Spring JDBC 以及业务层事务管理等众多的企业级应用技术，还能整合开源世界众多 著名的第三方框架和类库，逐渐成为使用最多的Java EE 企业应用开源框架</p>
</blockquote>
<h2 id="程序的耦合以及解耦"><a href="#程序的耦合以及解耦" class="headerlink" title="程序的耦合以及解耦"></a>程序的耦合以及解耦</h2><p>我们在开发中，有些依赖关系是必须的，有些依赖关系可以通过优化代码来解除的。 </p>
<p>示例代码：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 账户的业务层实现类</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AccountServiceImpl</span> <span class="keyword">implements</span> <span class="title">IAccountService</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> IAccountDao accountDao = <span class="keyword">new</span> AccountDaoImpl(); </span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<blockquote>
<p>上面的代码表示：  </p>
<p>业务层调用持久层，并且此时业务层在依赖持久层的接口和实现类。如果此时没有持久层实现类，编译将不能通过。这种编译期依赖关系，应该在我们开发中杜绝。我们需要优化代码解决。</p>
</blockquote>
<p>再比如：</p>
<p>早期我们的 JDBC 操作，注册驱动时，我们为什么不使用 <code>DriverManager</code> 的 <code>register</code> 方法，而是采 用 <code>Class.forName</code> 的方式？ </p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.conv.jdbc;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JdbcDemo1</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">//1. 注册驱动</span></span><br><span class="line"><span class="comment">//        DriverManager.registerDriver(new com.mysql.cj.jdbc.Driver());</span></span><br><span class="line">        Class.forName(<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>);</span><br><span class="line">        <span class="comment">//2. 获取连接</span></span><br><span class="line">        Connection connection = DriverManager.getConnection(<span class="string">&quot;jdbc:mysql://localhost:3306/spring?serverTimezone=GMT%2B8&quot;</span>,</span><br><span class="line">                <span class="string">&quot;root&quot;</span>, <span class="string">&quot;4869&quot;</span>);</span><br><span class="line">        <span class="comment">//3. 获取操作数据库的预处理对象</span></span><br><span class="line">        PreparedStatement pstm = connection.prepareStatement(<span class="string">&quot;select * from account&quot;</span>);</span><br><span class="line">        <span class="comment">//4. 执行sql，得到结果集</span></span><br><span class="line">        ResultSet rs = pstm.executeQuery();</span><br><span class="line">        <span class="keyword">while</span> (rs.next())&#123;</span><br><span class="line">            System.out.println(rs.getString(<span class="string">&quot;name&quot;</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        rs.close();</span><br><span class="line">        pstm.close();</span><br><span class="line">        connection.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>原因就是： </p>
<p>我们的类依赖了数据库的具体驱动类（MySQL），如果这时候更换了数据库品牌（比如 Oracle），需要修改源码来重新数据库驱动。这显然不是我们想要的。 </p>
<p>若没有 mysql 的驱动包，registerDriver 方法会在编译器报错，Class.forName 方式在编译期不依赖，运行时才依赖</p>
</blockquote>
<h3 id="解耦的思路"><a href="#解耦的思路" class="headerlink" title="解耦的思路"></a>解耦的思路</h3><ol>
<li><p>通过反射来创建对象，而避免使用 new 关键字</p>
<p><code>Class.forName(&quot;com.mysql.jdbc.Driver&quot;);</code> </p>
<p>这里的 <code>&quot;com.mysql.jdbc.Driver&quot;</code> 只是一个字符串，此时的好处是，我们的类中不再依赖具体的驱动类，此时就算删除 mysql 的驱动 jar 包，依然可以编译（运行就不要想了，没有驱动不可能运行成功的）。</p>
</li>
<li><p>但是这个字符串也是写死的，改动数据库时依然需要改源码，这样不好。通过读取配置文件来获取要创建的对象全限定类名</p>
<p>通过读取配置文件来获取要创建的对象的全限定类名</p>
</li>
</ol>
<h3 id="工厂模式解耦"><a href="#工厂模式解耦" class="headerlink" title="工厂模式解耦"></a>工厂模式解耦</h3><p>在实际开发中我们可以把三层的对象都使用配置文件配置起来，当启动服务器应用加载的时候，让一个类中的方法通过读取配置文件，把这些对象创建出来并存起来。在接下来的使用的时候，直接拿过来用就好了。 </p>
<p>那么，这个读取配置文件，创建和获取三层对象的类就是工厂。 </p>
<h2 id="IOC-的概念"><a href="#IOC-的概念" class="headerlink" title="IOC 的概念"></a>IOC 的概念</h2><p>上面的思路还有两个问题：</p>
<ol>
<li><p>存哪去？</p>
<p>分析：由于我们是很多对象，肯定要找个集合来存。这时候有 Map 和 List 供选择。到底选 Map 还是 List 就看我们有没有查找需求。有查找需求，选 Map。</p>
<p>所以我们的答案就是：在应用加载时，创建一个 Map，用于存放三层对象。我们把这个 Map 称之为容器。 </p>
</li>
<li><p>什么是工厂？</p>
<p>工厂就是负责给我们从容器中获取指定对象的类。这时候我们获取对象的方式发生了改变。   </p>
<ul>
<li>之前：我们在获取对象时，都是采用 new 的方式。是主动的。</li>
<li>现在：我们获取对象时，同时跟工厂要，由工厂为我们查找或者创建对象。是被动的。 </li>
</ul>
<p>这种被动接收的方式获取对象的思想就是控制反转，它是 spring 框架的核心之一。 </p>
</li>
</ol>
<h3 id="控制反转（IOC）"><a href="#控制反转（IOC）" class="headerlink" title="控制反转（IOC）"></a>控制反转（IOC）</h3><p>控制反转（Inversion of Control，缩写为 IoC ），把创建对象的权力交给框架，是框架的重要特征。是面向对象编程中的一种设计原则，可以用来降低计算机代码之间的耦合度。其中最常见的方式叫做依赖注入（Dependency Injection，简称DI），还有一种方式叫“依赖查找”（Dependency Lookup）。</p>
<p>明确 ioc的作用： </p>
<ul>
<li>削减计算机程序的耦合（解除我们代码中的依赖关系）</li>
</ul>
<h2 id="Spring-中的-IOC（案例）"><a href="#Spring-中的-IOC（案例）" class="headerlink" title="Spring 中的 IOC（案例）"></a>Spring 中的 IOC（案例）</h2><p>由于我们是使用 spring 解决依赖关系，并不是真正的要做增删改查操作，所以此时我们没必要写实体类。并且我们在此处使用的是 java 工程，不是 java web 工程。 </p>
<h3 id="创建业务层接口和实现类"><a href="#创建业务层接口和实现类" class="headerlink" title="创建业务层接口和实现类"></a>创建业务层接口和实现类</h3><p>IAccountService.java</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.conv.service;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 操作账户的业务层接口</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IAccountService</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 模拟保存账户</span></span><br><span class="line"><span class="comment">     * 为了简单，不保存到数据库中（没有参数 Account）</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">saveAccount</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>AccountServiceImpl.java</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.conv.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.conv.dao.IAccountDao;</span><br><span class="line"><span class="keyword">import</span> com.conv.dao.impl.AccountDaoImpl;</span><br><span class="line"><span class="keyword">import</span> com.conv.factory.BeanFactory;</span><br><span class="line"><span class="keyword">import</span> com.conv.service.IAccountService;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 账户的业务层实现类</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AccountServiceImpl</span> <span class="keyword">implements</span> <span class="title">IAccountService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> IAccountDao accountDao = <span class="keyword">new</span> AccountDaoImpl();</span><br><span class="line"><span class="comment">//    private IAccountDao accountDao = (IAccountDao) BeanFactory.getBean(&quot;accountDao&quot;);</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">saveAccount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        accountDao.saveAccount();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="创建持久层接口和实现类"><a href="#创建持久层接口和实现类" class="headerlink" title="创建持久层接口和实现类"></a>创建持久层接口和实现类</h3><p>IAccountDao.java</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.conv.dao;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 账户的持久层接口</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IAccountDao</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 模拟保存账户</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">saveAccount</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>AccountDaoImpl.java</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.conv.dao.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.conv.dao.IAccountDao;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 账户的持久层实现类</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AccountDaoImpl</span> <span class="keyword">implements</span> <span class="title">IAccountDao</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">saveAccount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;保存了账户&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="模拟表现层调用业务层"><a href="#模拟表现层调用业务层" class="headerlink" title="模拟表现层调用业务层"></a>模拟表现层调用业务层</h3><p>Client.java</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.conv.ui;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.conv.factory.BeanFactory;</span><br><span class="line"><span class="keyword">import</span> com.conv.service.IAccountService;</span><br><span class="line"><span class="keyword">import</span> com.conv.service.impl.AccountServiceImpl;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 模拟一个表现层，用来调用业务层</span></span><br><span class="line"><span class="comment"> * 实际开发中是一个 Servlet</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        IAccountService accountService = <span class="keyword">new</span> AccountServiceImpl();</span><br><span class="line"><span class="comment">//        IAccountService accountService = (IAccountService) BeanFactory.getBean(&quot;accountService&quot;);</span></span><br><span class="line"></span><br><span class="line">        accountService.saveAccount();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>这样可以实现基本功能没有问题。但是我们在表现层调用业务层以及业务层调用实体层时，用到了两个 new，用来创建 Service 和 Dao 对象，这样造成了程序间的耦合，应该避免。</p>
<h3 id="工厂模式解耦-1"><a href="#工厂模式解耦-1" class="headerlink" title="工厂模式解耦"></a>工厂模式解耦</h3><ul>
<li><p>首先，需要一个配置文件来配置我们的 Service 和 Dao</p>
<blockquote>
<p>配置的内容：唯一标识 = 全限定类名（key = value）</p>
</blockquote>
</li>
<li><p>接下来，通过读取配置文件中配置的内容，反射创建对象</p>
<blockquote>
<p>配置文件可以是 xml 也可以是 properties</p>
</blockquote>
</li>
</ul>
<p><code>src\main\resources\bean.properties</code></p>
<figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="attr">accountService</span>=<span class="string">com.conv.service.impl.AccountServiceImapl</span></span><br><span class="line"><span class="attr">accountDao</span>=<span class="string">com.conv.dao.impl.AccountDaoImpl</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>新建一个用来创建 Bean 对象的工厂</p>
<ul>
<li><p>Bean: 即可重用组件（比如 Service 可以被很多 Servlet 使用，Dao 可以被很多 Service 使用）</p>
</li>
<li><p>JavaBean: 用 Java 语言编写的可重用组件</p>
<blockquote>
<p>JavaBean 大于 实体类（实体类可重用组件的一部分）</p>
</blockquote>
</li>
</ul>
</li>
</ul>
<p><code>src\main\java\com\conv\factory\BeanFactory.java</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.conv.factory;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.Properties;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 一个创建 Bean 对象的工厂</span></span><br><span class="line"><span class="comment"> * 用来创建 Service 和 Dao 对象的</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BeanFactory</span> </span>&#123;</span><br><span class="line">    <span class="comment">//定义一个 Properties 对象</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Properties props;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//使用静态代码块为 Properties 对象赋值</span></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//实例化对象</span></span><br><span class="line">            props = <span class="keyword">new</span> Properties();</span><br><span class="line">            <span class="comment">//获取properties文件的流对象</span></span><br><span class="line">            <span class="comment">//FileInputStream 的路径不固定，不推荐</span></span><br><span class="line">            <span class="comment">//InputStream in = new FileInputStream(&quot;&quot;)</span></span><br><span class="line">            <span class="comment">// 创建在 resources 目录下的文件最后会成为类根路径下的文件，可以不用写任何包名</span></span><br><span class="line">            InputStream in = BeanFactory.class.getClassLoader().getResourceAsStream(<span class="string">&quot;bean.properties&quot;</span>);</span><br><span class="line">            props.load(in);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="comment">// 如果配置文件无法读取，那么什么都做不了，直接报错</span></span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> ExceptionInInitializerError(<span class="string">&quot;初始化 properties 失败&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 根据 Bean 的名称获取 bean 对象</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> beanName</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title">getBean</span><span class="params">(String beanName)</span> </span>&#123;</span><br><span class="line">        Object bean = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            String beanPath = props.getProperty(beanName);</span><br><span class="line">            bean = Class.forName(beanPath).getDeclaredConstructor().newInstance();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> bean;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>修改 Client.java 和 AccountServiceImpl.java</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">IAccountService accountService = (IAccountService) BeanFactory.getBean(<span class="string">&quot;accountService&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> IAccountDao accountDao = (IAccountDao) BeanFactory.getBean(<span class="string">&quot;accountDao&quot;</span>);</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="分析工厂模式的问题并改造"><a href="#分析工厂模式的问题并改造" class="headerlink" title="分析工厂模式的问题并改造"></a>分析工厂模式的问题并改造</h3><p><code>bean = Class.forName(beanPath).getDeclaredConstructor().newInstance();</code></p>
<p>这句话意味着每次都会调用默认构造函数创建对象，每次调用都会重新创建一个新的对象出来，效率较低</p>
<blockquote>
<p>单例：只被创建一次，从而类中的成员也就只会初始化一次，但是若有类的成员变量，会有线程问题（所以说 Service 和 Dao 最好不要有可以修改的类成员）</p>
<p>多例：对象被创建多次，执行效率没有单例对象高</p>
</blockquote>
<p>所以 <code>newInstance()</code> 只执行一次，创建出来后用 map 存起来，修改过后的工厂类如下：</p>
<p><code>com\conv\factory\BeanFactory.java</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.conv.factory;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.Enumeration;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"><span class="keyword">import</span> java.util.Properties;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 一个创建 Bean 对象的工厂</span></span><br><span class="line"><span class="comment"> * 用来创建 Service 和 Dao 对象的</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BeanFactory</span> </span>&#123;</span><br><span class="line">    <span class="comment">//定义一个 Properties 对象</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Properties props;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//定义一个 Map，用来存放我们要创建的对象。我们称之为容器</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Map&lt;String, Object&gt; beans;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//使用静态代码块为 Properties 对象赋值</span></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//实例化对象</span></span><br><span class="line">            props = <span class="keyword">new</span> Properties();</span><br><span class="line">            <span class="comment">//获取properties文件的流对象</span></span><br><span class="line">            <span class="comment">//FileInputStream 的路径不固定，不推荐</span></span><br><span class="line">            <span class="comment">//InputStream in = new FileInputStream(&quot;&quot;)</span></span><br><span class="line">            <span class="comment">// 创建在 resources 目录下的文件最后会成为类根路径下的文件，可以不用写任何包名</span></span><br><span class="line">            InputStream in = BeanFactory.class.getClassLoader().getResourceAsStream(<span class="string">&quot;bean.properties&quot;</span>);</span><br><span class="line">            props.load(in);</span><br><span class="line"></span><br><span class="line">            <span class="comment">//实例化容器</span></span><br><span class="line">            beans = <span class="keyword">new</span> HashMap&lt;String, Object&gt;();</span><br><span class="line">            <span class="comment">//取出配置文件中所有的 key</span></span><br><span class="line">            Enumeration keys = props.keys();</span><br><span class="line">            <span class="comment">// 遍历枚举</span></span><br><span class="line">            <span class="keyword">while</span> (keys.hasMoreElements()) &#123;</span><br><span class="line">                <span class="comment">//取出每个key</span></span><br><span class="line">                String key = keys.nextElement().toString();</span><br><span class="line">                <span class="comment">//根据key获取value</span></span><br><span class="line">                String beanPath = props.getProperty(key);</span><br><span class="line">                <span class="comment">//反射创建对象</span></span><br><span class="line">                Object value = Class.forName(beanPath).getDeclaredConstructor().newInstance();</span><br><span class="line">                <span class="comment">//把 key 和 value 存入容器中</span></span><br><span class="line">                beans.put(key, value);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="comment">// 如果配置文件无法读取，那么什么都做不了，直接报错</span></span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> ExceptionInInitializerError(<span class="string">&quot;初始化 properties 失败&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 根据 Bean 的名称获取 bean 对象</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> beanName</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title">getBean</span><span class="params">(String beanName)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> beans.get(beanName);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>由于静态代码块只在最开始执行一次，所以满足了要求</p>
<h2 id="使用-spring-的-IOC-解决程序耦合"><a href="#使用-spring-的-IOC-解决程序耦合" class="headerlink" title="使用 spring 的 IOC 解决程序耦合"></a>使用 spring 的 IOC 解决程序耦合</h2><h3 id="Spring-中基于-XML-的-IOC-环境搭建"><a href="#Spring-中基于-XML-的-IOC-环境搭建" class="headerlink" title="Spring 中基于 XML 的 IOC 环境搭建"></a>Spring 中基于 XML 的 IOC 环境搭建</h3><p><code>src\main\resources\bean.xml</code></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!--把对象的创建交给spring来管理--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--配置 service--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;accountService&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.conv.service.impl.AccountServiceImpl&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--配置 dao--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;accountDao&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.conv.dao.impl.AccountDaoImpl&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="获取spring的IOC核心容器，并根据id获取对象"><a href="#获取spring的IOC核心容器，并根据id获取对象" class="headerlink" title="获取spring的IOC核心容器，并根据id获取对象"></a>获取spring的IOC核心容器，并根据id获取对象</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//-----------ApplicationContext--------------</span></span><br><span class="line">    <span class="comment">//1. 获取核心容器对象</span></span><br><span class="line">    ApplicationContext ac = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">&quot;bean.xml&quot;</span>);</span><br><span class="line">    <span class="comment">//ApplicationContext ac = new FileSystemXmlApplicationContext(&quot;E:\\MySpace\\IntelliJ IDEA\\Spring\\day01_spring\\src\\main\\resources\\bean.xml&quot;);</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//2. 根据id获取Bean对象（以下两种写法均可）</span></span><br><span class="line">    IAccountService as = (IAccountService) ac.getBean(<span class="string">&quot;accountService&quot;</span>);</span><br><span class="line">    IAccountDao ad = ac.getBean(<span class="string">&quot;accountDao&quot;</span>, IAccountDao.class);</span><br><span class="line"></span><br><span class="line">    <span class="comment">////--------BeanFactory----------</span></span><br><span class="line">    <span class="comment">//1. 获取核心容器对象</span></span><br><span class="line">    <span class="comment">//Resource resource = new ClassPathResource(&quot;bean.xml&quot;);</span></span><br><span class="line">    <span class="comment">//BeanFactory factory = new XmlBeanFactory(resource);</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">//2. 根据id获取Bean对象</span></span><br><span class="line">    <span class="comment">//IAccountService as = (IAccountService)factory.getBean(&quot;accountService&quot;);</span></span><br><span class="line"></span><br><span class="line">    System.out.println(as);</span><br><span class="line">    System.out.println(ad);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//as.saveAccount();</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><p><code>ApplicationContext</code> 的三个常用实现类：</p>
<ul>
<li><code>ClassPathXmlApplicationContext</code>：可以加载类路径下的配置文件，要求配置文件必须在类路径下</li>
<li><code>FileSystemXmlApplicationContext</code>：可以加载磁盘任意路径下的配置文件（必须有访问权限）（不常用）</li>
<li><code>AnnotationConfigApplicationContext</code>：用于读取注解创建容器（见下节内容）</li>
</ul>
</li>
<li><p>核心容器的两个接口引发出的问题</p>
<ul>
<li><p>ApplicationContext:  单例模式适用（实际开发中常用）</p>
<blockquote>
<p>它在构建核心容器时，创建对象采用的策略是采用立即加载的方式。也就是说，只要一读取完配置文件马上就创建配置文件的对象</p>
</blockquote>
</li>
<li><p>BeanFactory:    多例对象适用</p>
<blockquote>
<p>它在构建核心容器时，创建对象采取的策略是延迟加载的方式。也就是说，什么时候根据id获取对象了，什么时候才真正的创建对象</p>
<p>BeanFactory 是 Spring 容器中的顶层接口，ApplicationContext 是它的子接口。 </p>
</blockquote>
</li>
</ul>
</li>
</ul>
<h3 id="IOC-中-bean-标签和管理对象细节"><a href="#IOC-中-bean-标签和管理对象细节" class="headerlink" title="IOC 中 bean 标签和管理对象细节"></a>IOC 中 bean 标签和管理对象细节</h3><p>spring 对 bean 的管理细节：</p>
<ol>
<li><p>创建 bean 的三种方式</p>
<ol>
<li><p>使用默认构造函数创建</p>
<blockquote>
<p>在spring的配置文件中使用 bean 标签，配以 id 和 class 属性之后，且没有其他属性和标签时，采用的就是默认构造函数创建 bean 对象。此时如果类中没有默认构造函数，则对象无法创建。</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--1.使用默认构造函数创建--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;accountService&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.conv.service.impl.AccountServiceImpl&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>使用普通工厂中的方法创建对象（使用某个类中的方法创建对象，并存入spring容器）</p>
<ul>
<li><p>首先，模拟一个工厂类（可能位于jar包中）</p>
<p><code>com\conv\factory\InstanceFactory.java</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.conv.factory;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.conv.service.IAccountService;</span><br><span class="line"><span class="keyword">import</span> com.conv.service.impl.AccountServiceImpl;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 模拟一个工厂类（该类可能存在于jar包中，无法通过修改源码的方式提供默认构造函数）</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">InstanceFactory</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> IAccountService <span class="title">getAccountService</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> AccountServiceImpl();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建对象</p>
<p><code>bean.xml</code></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--2.使用普通工厂中的方法创建对象（使用某个类中的方法创建对象，并存入spring容器）--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;instanceFactory&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.conv.factory.InstanceFactory&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;accountService&quot;</span> <span class="attr">factory-bean</span>=<span class="string">&quot;instanceFactory&quot;</span> <span class="attr">factory-method</span>=<span class="string">&quot;getAccountService&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>使用工厂中的静态方法创建对象（使用某个类中的静态方法创建对象，并存入spring容器）</p>
<ul>
<li><p>模拟一个静态工厂类（可能位于jar包中）</p>
<p><code>com\conv\factory\StaticFactory.java</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.conv.factory;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.conv.service.IAccountService;</span><br><span class="line"><span class="keyword">import</span> com.conv.service.impl.AccountServiceImpl;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 模拟一个静态工厂类（该类可能存在于jar包中，无法通过修改源码的方式提供默认构造函数）</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StaticFactory</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> IAccountService <span class="title">getAccountService</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> AccountServiceImpl();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建对象</p>
<p><code>bean.xml</code></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--3.使用工厂中的静态方法创建对象（使用某个类中的静态方法创建对象，并存入spring容器）--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;accountService&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.conv.factory.StaticFactory&quot;</span> <span class="attr">factory-method</span>=<span class="string">&quot;getAccountService&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ol>
</li>
<li><p>bean 对象的作用范围</p>
<ul>
<li>bean 标签的 scope 属性：<ul>
<li>作用：用于指定 bean 的作用范围</li>
<li>取值：(常用的是前两个)<ol>
<li>singleton：单例的（默认值）</li>
<li>prototype：多例的</li>
<li>request：作用于web应用的请求范围</li>
<li>session：作用于web应用的会话范围</li>
<li>global-session：作用于集群环境的会话范围（全局会话范围），当不是集群环境时，它就是session</li>
</ol>
</li>
</ul>
</li>
</ul>
</li>
<li><p>bean 对象的生命周期</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//1. 获取核心容器对象</span></span><br><span class="line">    ClassPathXmlApplicationContext ac = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">&quot;bean.xml&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//2. 根据id获取Bean对象（以下两种写法均可）</span></span><br><span class="line">    IAccountService as = (IAccountService) ac.getBean(<span class="string">&quot;accountService&quot;</span>);</span><br><span class="line"></span><br><span class="line">    as.saveAccount();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//父类对象无法调用子类对象的方法，所以 ac 的类型改为子类对象：ClassPathXmlApplicationContext</span></span><br><span class="line">    ac.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--bean 对象的生命周期--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;accountService&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.conv.service.impl.AccountServiceImpl&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">scope</span>=<span class="string">&quot;singleton&quot;</span> <span class="attr">init-method</span>=<span class="string">&quot;init&quot;</span> <span class="attr">destroy-method</span>=<span class="string">&quot;destroy&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--&lt;bean id=&quot;accountService&quot; class=&quot;com.conv.service.impl.AccountServiceImpl&quot;</span></span><br><span class="line"><span class="comment">      scope=&quot;prototype&quot; init-method=&quot;init&quot; destroy-method=&quot;destroy&quot;&gt;&lt;/bean&gt;--&gt;</span></span><br></pre></td></tr></table></figure>

<ol>
<li>单例对象<ul>
<li>出生：当容器创建时对象出生</li>
<li>活着：只要容器还在，对象就一直活着</li>
<li>死亡：容器销毁，对象消亡</li>
<li>总结：单例对象的生命周期和容器相同</li>
</ul>
</li>
<li>多例对象<ul>
<li>出生：当我们使用对象时spring框架为我们创建</li>
<li>活着：对象只要在使用过程中就一直活着</li>
<li>死亡：当对象长时间不用，且没有别的对象引用时，由 Java 的垃圾回收器回收</li>
</ul>
</li>
</ol>
</li>
</ol>
<h2 id="依赖注入（Dependency-Injection）"><a href="#依赖注入（Dependency-Injection）" class="headerlink" title="依赖注入（Dependency Injection）"></a>依赖注入（Dependency Injection）</h2><h3 id="能注入的数据有三类："><a href="#能注入的数据有三类：" class="headerlink" title="能注入的数据有三类："></a>能注入的数据有三类：</h3><ol>
<li>基本类型和String</li>
<li>其他 bean 类型（在配置文件中或者注解配置过的 bean）</li>
<li>复杂类型/集合类型</li>
</ol>
<h3 id="注入的方式有三种："><a href="#注入的方式有三种：" class="headerlink" title="注入的方式有三种："></a>注入的方式有三种：</h3><ol>
<li><p>使用构造函数提供（不常用）</p>
<ul>
<li><p>使用的标签：<code>constructor-arg</code></p>
</li>
<li><p>标签出现的位置：<code>bean</code> 标签的内部</p>
</li>
<li><p>标签中的属性：</p>
<ul>
<li><code>type</code> 用于指定要注入的数据类型，该数据类型也是构造函数中某个或某些参数的类型</li>
<li><code>index</code> 用于指定要注入的数据给构造函数中指定索引位置的参数赋值。索引的位置是从0开始的</li>
<li><code>name</code> 用于指定给构造函数中指定名称的参数赋值（常用）</li>
<li><code>value</code> 用于提供基本类型和 String 类型的数据</li>
<li><code>ref</code> 用于指定其他的 bean 类型的数据。它指的就是在 spring 的 IOC 核心容器中出现过的 bean 对象</li>
</ul>
<blockquote>
<p>其中，<code>type,index,name</code> 用于指定给构造函数的哪个参数赋值，<code>value,ref</code> 用来赋值</p>
</blockquote>
</li>
<li><p>例：</p>
<p><code>com\conv\service\impl\AccountServiceImpl.java</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.conv.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.conv.service.IAccountService;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 账户的业务层实现类</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AccountServiceImpl</span> <span class="keyword">implements</span> <span class="title">IAccountService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//如果是经常变化的数据，并不适用于注入的方式</span></span><br><span class="line">    <span class="comment">//比如注册时用户名等每个人都不一样的，就不适合注入</span></span><br><span class="line">    <span class="comment">//这里的三个变量只是为了举例</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">    <span class="keyword">private</span> Date birthday;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">AccountServiceImpl</span><span class="params">(String name, Integer age, Date birthday)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">        <span class="keyword">this</span>.birthday = birthday;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;AccountServiceImpl&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;name=&#x27;&quot;</span> + name + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, age=&quot;</span> + age +</span><br><span class="line">                <span class="string">&quot;, birthday=&quot;</span> + birthday +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">saveAccount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;service中的saveAccount方法执行了\n&quot;</span> + toString());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>bean.xml</code></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;accountService&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.conv.service.impl.AccountServiceImpl&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;test&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;age&quot;</span> <span class="attr">value</span>=<span class="string">&quot;17&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;birthday&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;now&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--配置一个日期对象，上面的 ref=“now” 调取这个对象--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;now&quot;</span> <span class="attr">class</span>=<span class="string">&quot;java.util.Date&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;year&quot;</span> <span class="attr">value</span>=<span class="string">&quot;120&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;month&quot;</span> <span class="attr">value</span>=<span class="string">&quot;6&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;date&quot;</span> <span class="attr">value</span>=<span class="string">&quot;7&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>优势：</p>
<blockquote>
<p>在获取 bean 对象时，注入数据是必须的操作，否则对象无法创建成功</p>
</blockquote>
</li>
<li><p>弊端</p>
<blockquote>
<p>改变了 bean  对象的实例化方式，使我们在创建对象时，如果用不到这些数据，也必须提供。</p>
</blockquote>
</li>
</ul>
</li>
<li><p>使用 set 方法提供（更常用）</p>
<ul>
<li><p>使用的标签：<code>property</code></p>
</li>
<li><p>标签出现的位置：<code>bean</code> 标签的内部</p>
</li>
<li><p>标签中的属性：</p>
<ul>
<li><code>name</code> 用于指定注入时所调用的set方法的名称</li>
<li><code>value</code> 用于提供基本类型和 String 类型的数据</li>
<li><code>ref</code> 用于指定其他的 bean 类型的数据。它指的就是在 spring 的 IOC 核心容器中出现过的 bean 对象</li>
</ul>
</li>
<li><p>例：</p>
<p><code>com\conv\service\impl\AccountServiceImpl.java</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.conv.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.conv.service.IAccountService;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 账户的业务层实现类</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AccountServiceImpl</span> <span class="keyword">implements</span> <span class="title">IAccountService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//如果是经常变化的数据，并不适用于注入的方式</span></span><br><span class="line">    <span class="comment">//比如注册时用户名等每个人都不一样的，就不适合注入</span></span><br><span class="line">    <span class="comment">//这里的三个变量只是为了举例</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">    <span class="keyword">private</span> Date birthday;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAge</span><span class="params">(Integer age)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setBirthday</span><span class="params">(Date birthday)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.birthday = birthday;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;AccountServiceImpl&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;name=&#x27;&quot;</span> + name + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, age=&quot;</span> + age +</span><br><span class="line">                <span class="string">&quot;, birthday=&quot;</span> + birthday +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">saveAccount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;service中的saveAccount方法执行了\n&quot;</span> + toString());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>bean.xml</code></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;accountService&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.conv.service.impl.AccountServiceImpl&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;age&quot;</span> <span class="attr">value</span>=<span class="string">&quot;21&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;TEST&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;birthday&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;now&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;now&quot;</span> <span class="attr">class</span>=<span class="string">&quot;java.util.Date&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;year&quot;</span> <span class="attr">value</span>=<span class="string">&quot;120&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;month&quot;</span> <span class="attr">value</span>=<span class="string">&quot;6&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;date&quot;</span> <span class="attr">value</span>=<span class="string">&quot;7&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>优势：</p>
<blockquote>
<p>创建对象时没有明确的限制，可以直接使用默认构造函数</p>
</blockquote>
</li>
<li><p>弊端</p>
<blockquote>
<p>如果某个对象必须有值，则获取对象时 set 方法有可能没有执行</p>
</blockquote>
</li>
</ul>
</li>
<li><p>使用注解提供（见下节内容）</p>
</li>
</ol>
<h3 id="复杂类型的注入-集合类型的注入"><a href="#复杂类型的注入-集合类型的注入" class="headerlink" title="复杂类型的注入/集合类型的注入"></a>复杂类型的注入/集合类型的注入</h3><p>就是给类中的集合成员传值，它用的也是 set 方法注入的方式，只不过变量的数据类型都是集合</p>
<ul>
<li>用于给 List 结构集合注入的标签有：<code>list</code>,<code>array</code>,<code>set</code></li>
<li>用于给 Map 结构集合注入的标签有：<code>map</code>,<code>props</code></li>
</ul>
<p><strong>结构相同，标签可以互换</strong></p>
<p>例：</p>
<p><code>com\conv\service\impl\AccountServiceImpl.java</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.conv.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.conv.service.IAccountService;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 账户的业务层实现类</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AccountServiceImpl</span> <span class="keyword">implements</span> <span class="title">IAccountService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String[] myStrs;</span><br><span class="line">    <span class="keyword">private</span> List&lt;String&gt; myList;</span><br><span class="line">    <span class="keyword">private</span> Set&lt;String&gt; mySet;</span><br><span class="line">    <span class="keyword">private</span> Map&lt;String, String&gt; myMap;</span><br><span class="line">    <span class="keyword">private</span> Properties myProps;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMyStrs</span><span class="params">(String[] myStrs)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.myStrs = myStrs;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMyList</span><span class="params">(List&lt;String&gt; myList)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.myList = myList;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMySet</span><span class="params">(Set&lt;String&gt; mySet)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.mySet = mySet;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMyMap</span><span class="params">(Map&lt;String, String&gt; myMap)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.myMap = myMap;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMyProps</span><span class="params">(Properties myProps)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.myProps = myProps;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;AccountServiceImpl&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;\nmyStrs=&quot;</span> + Arrays.toString(myStrs) +</span><br><span class="line">                <span class="string">&quot;\nmyList=&quot;</span> + myList +</span><br><span class="line">                <span class="string">&quot;\nmySet=&quot;</span> + mySet +</span><br><span class="line">                <span class="string">&quot;\nmyMap=&quot;</span> + myMap +</span><br><span class="line">                <span class="string">&quot;\nmyProps=&quot;</span> + myProps +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">saveAccount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;service中的saveAccount方法执行了\n&quot;</span> + toString());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>bean.xml</code></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;accountService&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.conv.service.impl.AccountServiceImpl&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;myStrs&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">array</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>aaa<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>bbb<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>ccc<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">array</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;myList&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>aaa<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>bbb<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>ccc<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;mySet&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">set</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>aaa<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>bbb<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>ccc<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!--下面是map标签和props标签互换，不影响注入--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;myMap&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">props</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;propC&quot;</span>&gt;</span>CCC<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;propD&quot;</span>&gt;</span>DDD<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">props</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;myProps&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">map</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">&quot;mapA&quot;</span> <span class="attr">value</span>=<span class="string">&quot;AAA&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">entry</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">&quot;mapB&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">value</span>&gt;</span>BBB<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">entry</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">map</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>



]]></content>
      <categories>
        <category>Spring</category>
      </categories>
      <tags>
        <tag>Spring</tag>
      </tags>
  </entry>
  <entry>
    <title>Mybatis学习笔记03</title>
    <url>/posts/mybatis-xue-xi-bi-ji-03/</url>
    <content><![CDATA[<h2 id="Mybatis-中的连接池以及事务控制"><a href="#Mybatis-中的连接池以及事务控制" class="headerlink" title="Mybatis 中的连接池以及事务控制"></a>Mybatis 中的连接池以及事务控制</h2><ul>
<li>连接池就是用于存储连接的一个容器</li>
<li>容器其实就是一个集合对象，该集合必须是线程安全的，不能两个线程拿到同一个连接</li>
<li>该集合还必须实现队列的特性：先进先出</li>
</ul>
<h3 id="连接池配置的位置"><a href="#连接池配置的位置" class="headerlink" title="连接池配置的位置"></a>连接池配置的位置</h3><blockquote>
<p>主配置文件 <code>SqlMapConfig.xml</code> 中的 <code>dataSource</code> 标签，<strong>type 属性</strong>就是表示采用何种连接池方式。</p>
</blockquote>
<h3 id="配置的方式（type-属性的取值）"><a href="#配置的方式（type-属性的取值）" class="headerlink" title="配置的方式（type 属性的取值）"></a>配置的方式（type 属性的取值）</h3><ol>
<li><p><code>POOLED</code></p>
<p>采用传统的 <code>javax.sql.DataSource</code> 规范中的连接池，<code>mybatis</code> 中有针对规范的实现</p>
</li>
<li><p><code>UNPOOLED</code></p>
<p>采用传统的获取连接的方式，虽然也实现 <code>Javax.sql.DataSource</code> 接口，但是并没有使用池的思想。</p>
</li>
<li><p><code>JNDI</code></p>
<p>采用服务器提供的 JNDI 技术实现，来获取 <code>DataSource</code> 对象，不同的服务器所能拿到 <code>DataSource</code> 是不一样的。</p>
<blockquote>
<p>注意：</p>
<p>此配置如果不是 web 或者 maven 的 <code>war </code>工程，是不能使用的</p>
<p>下文中使用的是 <code>tomcat</code> 服务器，采用连接池就是 <code>dbcp</code> 连接池</p>
</blockquote>
</li>
</ol>
<p>在这三种数据源中，我们一般采用的是 POOLED 数据源（很多时候我们所说的数据源就是为了更好的管理数据 库连接，也就是我们所说的连接池技术）。 </p>
<h4 id="JNDI-数据源的具体使用"><a href="#JNDI-数据源的具体使用" class="headerlink" title="JNDI 数据源的具体使用"></a>JNDI 数据源的具体使用</h4><blockquote>
<p>JNDI：</p>
<p><code>Java Naming and Directory Interface</code>，是SUN公司推出的一套规范，属于 <code>JavaEE</code> 的技术之一。目的是模仿 <code>windows</code> 系统中的注册表，在服务器中注册数据源</p>
</blockquote>
<ol>
<li><p>创建 Maven 的 web 工程并导入坐标：</p>
<p><img data-src="01.png"></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.5.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>8.0.19<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.17<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.13<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>javax.servlet-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.0.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet.jsp<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>javax.servlet.jsp-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.3.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>在 <code>webapp</code> 文件下创建 <code>META-INF</code> 目录，并在 <code>META-INF</code> 目录中建立一个名为 <code>context.xml</code> 的配置文件</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Context</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">    &lt;Resource</span></span><br><span class="line"><span class="comment">    name=&quot;jdbc/eesy_mybatis&quot;						数据源的名称，可以自己指定</span></span><br><span class="line"><span class="comment">    type=&quot;javax.sql.DataSource&quot;						数据源类型，我们要存什么样的对象</span></span><br><span class="line"><span class="comment">    auth=&quot;Container&quot;								数据源提供者，这里的容器指的是Tomcat</span></span><br><span class="line"><span class="comment">    maxActive=&quot;20&quot;									最大活动数</span></span><br><span class="line"><span class="comment">    maxWait=&quot;10000&quot;									最大等待时间</span></span><br><span class="line"><span class="comment">    maxIdle=&quot;5&quot;										最大空闲数</span></span><br><span class="line"><span class="comment">    username=&quot;root&quot;									用户名</span></span><br><span class="line"><span class="comment">    password=&quot;1234&quot;									密码</span></span><br><span class="line"><span class="comment">    driverClassName=&quot;com.mysql.jdbc.Driver&quot;			驱动类</span></span><br><span class="line"><span class="comment">    url=&quot;jdbc:mysql://localhost:3306/eesy_mybatis&quot;	连接url字符串</span></span><br><span class="line"><span class="comment">    /&gt;</span></span><br><span class="line"><span class="comment">     --&gt;</span></span><br><span class="line">    &lt;Resource</span><br><span class="line">            name=&quot;jdbc/learn&quot;</span><br><span class="line">            type=&quot;javax.sql.DataSource&quot;</span><br><span class="line">            auth=&quot;Container&quot;</span><br><span class="line">            maxActive=&quot;20&quot;</span><br><span class="line">            maxWait=&quot;10000&quot;</span><br><span class="line">            maxIdle=&quot;5&quot;</span><br><span class="line">            username=&quot;root&quot;</span><br><span class="line">            password=&quot;4869&quot;</span><br><span class="line">            driverClassName=&quot;com.mysql.cj.jdbc.Driver&quot;</span><br><span class="line">            url=&quot;jdbc:mysql://localhost:3306/learn?serverTimezone=GMT%2B8&quot;</span><br><span class="line">    /&gt;</span><br><span class="line"><span class="tag">&lt;/<span class="name">Context</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>修改 <code>SqlMapConfig.xml</code> 中的配置</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--  配置连接数据库的信息 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span> <span class="attr">resource</span>=<span class="string">&quot;jdbcConfig.properties&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--  使用 typeAliases 配置别名，它只能配置 com.conv.domain 中类的别名 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">&quot;com.conv.domain&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--配置环境--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">&quot;mysql&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--配置myslq的环境--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">&quot;mysql&quot;</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--配置事务的类型--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">&quot;JDBC&quot;</span>/&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--配置数据源（连接池）--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">&quot;JNDI&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;data_source&quot;</span> <span class="attr">value</span>=<span class="string">&quot;java:comp/env/jdbc/learn&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--指定映射配置文件的位置，映射配置文件指的是每个DAO独立的配置文件</span></span><br><span class="line"><span class="comment">        如果是用注解来配置的话，此处应该使用class属性指定被注解的dao全限定类名</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--xml配置，路径是resource下的路径--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--&lt;mapper resource=&quot;com.conv.dao/IUserDao.xml&quot;/&gt;--&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!--使用注解的配置--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--&lt;mapper class=&quot;com.conv.dao.IUserDao&quot;/&gt;--&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!--package 标签用于指定dao接口所在的包，</span></span><br><span class="line"><span class="comment">        当指定了之后就不需要再写 mapper 以及 class 或 resource 了--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">&quot;com.conv.dao&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>修改 <code>index.jsp</code></p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;java.io.InputStream&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;org.apache.ibatis.io.Resources&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;org.apache.ibatis.session.SqlSessionFactoryBuilder&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;org.apache.ibatis.session.SqlSessionFactory&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;org.apache.ibatis.session.SqlSession&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;com.conv.dao.IUserDao&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;com.conv.domain.User&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;java.util.List&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page language=<span class="string">&quot;java&quot;</span> contentType=<span class="string">&quot;text/html; charset=UTF-8&quot;</span> pageEncoding=<span class="string">&quot;UTF-8&quot;</span>%&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;h2&gt;Hello World!&lt;/h2&gt;</span><br><span class="line">&lt;%</span><br><span class="line">    <span class="comment">//1.读取配置文件</span></span><br><span class="line">    InputStream in = Resources.getResourceAsStream(<span class="string">&quot;SqlMapConfig.xml&quot;</span>);</span><br><span class="line">    <span class="comment">//2.根据配置文件构建SqlSessionFactory</span></span><br><span class="line">    SqlSessionFactoryBuilder builder = <span class="keyword">new</span> SqlSessionFactoryBuilder();</span><br><span class="line">    SqlSessionFactory factory = builder.build(in);</span><br><span class="line">    <span class="comment">//3.使用SqlSessionFactory创建SqlSession对象</span></span><br><span class="line">    SqlSession sqlSession = factory.openSession();</span><br><span class="line">    <span class="comment">//4.使用SqlSession构建Dao的代理对象</span></span><br><span class="line">    IUserDao userDao = sqlSession.getMapper(IUserDao.class);</span><br><span class="line">    <span class="comment">//5.执行dao中的findAll方法</span></span><br><span class="line">    List&lt;User&gt; users = userDao.findAll();</span><br><span class="line">    <span class="keyword">for</span>(User user : users)&#123;</span><br><span class="line">        System.out.println(user);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//6.释放资源</span></span><br><span class="line">    sqlSession.close();</span><br><span class="line">    in.close();</span><br><span class="line">    System.out.println(<span class="string">&quot;Hello&quot;</span>);</span><br><span class="line">%&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>启动 Tomcat 运行</p>
</li>
</ol>
<h3 id="Mybatis-的事务"><a href="#Mybatis-的事务" class="headerlink" title="Mybatis 的事务"></a>Mybatis 的事务</h3><p><strong>事务</strong></p>
<blockquote>
<p>访问并可能更新数据库中各种数据项的一个程序执行单元(unit)</p>
<p>例如：在关系数据库中，一个事务可以是一条SQL语句，一组SQL语句或整个程序</p>
</blockquote>
<p><strong>事务的四大特性ACID</strong></p>
<blockquote>
<p>原子性（atomicity）：一个事务（transaction）中的所有操作，要么全部完成，要么全部不完成，不会结束在中间某个环节。事务在执行过程中发生错误，会被回滚（Rollback）到事务开始前的状态，就像这个事务从来没有执行过一样。</p>
<p>一致性（consistency）：在事务开始之前和事务结束以后，数据库的完整性没有被破坏。这表示写入的资料必须完全符合所有的预设规则，这包含资料的精确度、串联性以及后续数据库可以自发性地完成预定的工作。</p>
<p>隔离性（isolation）：数据库允许多个并发事务同时对其数据进行读写和修改的能力，隔离性可以防止多个事务并发执行时由于交叉执行而导致数据的不一致。事务隔离分为不同级别，包括读未提交（Read uncommitted）、读提交（read committed）、可重复读（repeatable read）和串行化（Serializable）。</p>
<p>持久性（durability）：持久性也称永久性（permanence），指事务处理结束后，对数据的修改就是永久的，即便系统故障也不会丢失。</p>
</blockquote>
<p><strong>不考虑隔离性会产生的3个问题</strong></p>
<blockquote>
<ol>
<li><p>脏读：在一个事务处理过程里读取了另一个未提交的事务中的数据。</p>
</li>
<li><p>不可重复读：在一个事务里面读取了两次某个数据，读出来的数据不一致。这是由于在查询间隔，被另一个事务修改并提交了。</p>
<p>例如事务T1在读取某一数据，而事务T2立马修改了这个数据并且提交事务给数据库，事务T1再次读取该数据就得到了不同的结果，发送了不可重复读。</p>
</li>
<li><p>幻读（虚读）：在一个事务里面的操作中发现了未被操作的数据。</p>
<p>幻读是事务非独立执行时发生的一种现象。例如事务T1对一个表中所有的行的某个数据项做了从“1”修改为“2”的操作，这时事务T2又对这个表中插入了一行数据项，而这个数据项的数值还是为“1”并且提交给数据库。而操作事务T1的用户如果再查看刚刚修改的数据，会发现还有一行没有修改，其实这行是从事务T2中添加的，就好像产生幻觉一样，这就是发生了幻读。</p>
<p>　　幻读和不可重复读都是读取了另一条已经提交的事务（这点就脏读不同），所不同的是不可重复读查询的都是同一个数据项，而幻读针对的是一批数据整体（比如数据的个数）。</p>
</li>
</ol>
</blockquote>
<p><strong>解决办法：四种隔离级别</strong></p>
<blockquote>
<p>读未提交：一个事务可以读取另一个未提交事务的数据。什么问题都解决不了</p>
<p>读已提交：就是一个事务要等另一个事务提交后才能读取数据。可以防脏读，不能防不可重复读和幻读。</p>
<p>可重复读：在开始读取数据（事务开启）时，不再允许修改操作。可以解决不可重复读问题。</p>
<p>串行化：直到一个事务的所有子事务全部结束才可以执行下一个事务。是最高的事务隔离级别，在该级别下，事务串行化顺序执行，可以避免脏读、不可重复读与幻读。但是这种事务隔离级别效率低下，比较耗数据库性能，一般不使用。</p>
</blockquote>
<h4 id="JDBC中事务的回顾"><a href="#JDBC中事务的回顾" class="headerlink" title="JDBC中事务的回顾"></a>JDBC中事务的回顾</h4><p>在 JDBC 中我们可以通过手动方式将事务的提交改为手动方式，通过 <code>setAutoCommit()</code> 方法就可以调整。 通过 JDK 文档，我们知道该方法的作用如下：</p>
<blockquote>
<p>将此连接的自动提交模式设置为给定状态。 </p>
<p>如果连接处于自动提交模式，则其所有SQL语句将作为单个事务执行并提交。 </p>
<p>否则，它的SQL语句被分组成通过调用方法<code>commit</code>或方法<code>rollback</code> 。 默认情况下，新连接处于自动提交模式。</p>
</blockquote>
<p>那么我们的 Mybatis 框架因为是对 JDBC 的封装，所以 Mybatis 框架的事务控制方式，本身也是用 JDBC的 setAutoCommit()方法来设置事务提交方式的。 </p>
<h4 id="Mybatis-中事务提交方式"><a href="#Mybatis-中事务提交方式" class="headerlink" title="Mybatis 中事务提交方式"></a>Mybatis 中事务提交方式</h4><ul>
<li><p>默认为手动提交：</p>
<p>之前的 CUD 操作过程中，我们都要手动进 行事务的提交，原因是 setAutoCommit()方法在执行时它的值被设置为 false 了，所以我们在 CUD 操作中， 必须通过 sqlSession.commit()方法来执行提交操作。 </p>
</li>
<li><p>自动提交事务的设置</p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Before</span><span class="comment">//在测试方法执行之前执行 </span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span><span class="keyword">throws</span> Exception </span>&#123; </span><br><span class="line">    <span class="comment">//1.读取配置文件  </span></span><br><span class="line">    in = Resources.getResourceAsStream(<span class="string">&quot;SqlMapConfig.xml&quot;</span>);  </span><br><span class="line">    <span class="comment">//2.创建构建者对象  </span></span><br><span class="line">    SqlSessionFactoryBuilder builder = <span class="keyword">new</span> SqlSessionFactoryBuilder();  </span><br><span class="line">    <span class="comment">//3.创建 SqlSession 工厂对象  </span></span><br><span class="line">    factory = builder.build(in); </span><br><span class="line">    <span class="comment">//4.创建 SqlSession 对象  </span></span><br><span class="line">    session = factory.openSession(<span class="keyword">true</span>);	<span class="comment">//这里设置为true即可</span></span><br><span class="line">    <span class="comment">//5.创建 Dao 的代理对象  </span></span><br><span class="line">    userDao = session.getMapper(IUserDao.class);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>此时事务就设置为自动提交了，同样可以实现CUD操作时记录的保存。</p>
<blockquote>
<p>虽然这也是一种方式，但就编程而言，设置为自动提交方式为 false再根据情况决定是否进行提交，这种方式更常用。因为我们可以根据业务情况来决定提交是否进行提交。 </p>
</blockquote>
<h2 id="Mybatis-基于XML配置的动态-SQL-语句使用"><a href="#Mybatis-基于XML配置的动态-SQL-语句使用" class="headerlink" title="Mybatis 基于XML配置的动态 SQL 语句使用"></a>Mybatis 基于XML配置的动态 SQL 语句使用</h2><p>Mybatis 的映射文件中，前面我们的 SQL 都是比较简单的，有些时候业务逻辑复杂时，我们的 SQL 是动态变 化的，此时在前面的学习中我们的 SQL 就不能满足要求了。 </p>
<h3 id="动态-SQL-之-lt-if-gt-标签"><a href="#动态-SQL-之-lt-if-gt-标签" class="headerlink" title="动态 SQL 之&lt;if&gt;标签"></a>动态 SQL 之<code>&lt;if&gt;</code>标签</h3><blockquote>
<p>需求：</p>
<p>根据实体类的不同取值，使用不同的 SQL 语句来进行查询</p>
<p>比如：在 id 如果不为空时可以根据 id 查询， 如果 username 不同空时还要加入用户名作为条件。这种情况在我们的多条件组合查询中经常会碰到。 </p>
</blockquote>
<ol>
<li>持久层 Dao 接口</li>
</ol>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  * 根据传入的查询条件查询</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@param</span> user 查询条件，用户名、性别、地址等信息可能有也可能没有</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"><span class="function">List&lt;User&gt; <span class="title">findByCondition</span><span class="params">(User user)</span></span>;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>持久层 Dao 映射配置</li>
</ol>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--  根据条件查询 --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- &lt;if&gt;标签的 test 属性中写的是对象的属性名，如果是包装类的对象要使用 OGNL 表达式的写法 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findByCondition&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;com.conv.domain.User&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.conv.domain.User&quot;</span>&gt;</span></span><br><span class="line">    select * from user</span><br><span class="line">    <span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;username != null&quot;</span>&gt;</span></span><br><span class="line">            and username = #&#123;username&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;sex != null&quot;</span>&gt;</span></span><br><span class="line">            and sex = #&#123;sex&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ol start="3">
<li>测试</li>
</ol>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  * 测试根据条件查询</span></span><br><span class="line"><span class="comment">  *</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@throws</span> IOException</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testFindByCondition</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">    User u = <span class="keyword">new</span> User();</span><br><span class="line">    u.setUsername(<span class="string">&quot;老王&quot;</span>);</span><br><span class="line">    u.setSex(<span class="string">&quot;女&quot;</span>);</span><br><span class="line"></span><br><span class="line">    List&lt;User&gt; users = userDao.findByCondition(u);</span><br><span class="line">    <span class="keyword">for</span> (User user : users) &#123;</span><br><span class="line">        System.out.println(user);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="动态-SQL-之-lt-foreach-gt-标签"><a href="#动态-SQL-之-lt-foreach-gt-标签" class="headerlink" title="动态 SQL 之&lt;foreach&gt;标签"></a>动态 SQL 之<code>&lt;foreach&gt;</code>标签</h4><blockquote>
<p>需求：</p>
<p>传入多个 id 查询用户信息，用下边两个 sql 实现： </p>
<p><code>SELECT * FROM USERS WHERE username LIKE &#39;%张%&#39; AND (id=10 OR id=89 OR id=16) </code></p>
<p><code>SELECT * FROM USERS WHERE username LIKE &#39;%张%&#39; AND id IN (10,89,16) </code></p>
<p>这样我们在进行范围查询时，就要将一个集合中的值，作为参数动态添加进来。将如何进行参数的传递？</p>
</blockquote>
<ol>
<li>在 QueryVo 中加入一个 List 集合用于封装参数 </li>
</ol>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.conv.domain;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">QueryVo</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> User user;</span><br><span class="line">    <span class="keyword">private</span> List&lt;Integer&gt; ids;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> User <span class="title">getUser</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> user;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUser</span><span class="params">(User user)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.user = user;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Integer&gt; <span class="title">getIds</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ids;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setIds</span><span class="params">(List&lt;Integer&gt; ids)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.ids = ids;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>持久层 Dao 接口</li>
</ol>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  * 根据QueryVo中提供的id集合，查询用户信息</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@param</span> vo</span></span><br><span class="line"><span class="comment">  *<span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"><span class="function">List&lt;User&gt; <span class="title">findUserInIds</span><span class="params">(QueryVo vo)</span></span>;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>持久层 Dao 映射配置</li>
</ol>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--  根据QueryVo中提供的id集合，查询用户信息 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findUserInIds&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;com.conv.domain.QueryVo&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.conv.domain.User&quot;</span>&gt;</span></span><br><span class="line">    select * from user</span><br><span class="line">    <span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;ids != null and ids.size() &gt; 0&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">foreach</span> <span class="attr">collection</span>=<span class="string">&quot;ids&quot;</span> <span class="attr">open</span>=<span class="string">&quot;and id in (&quot;</span> <span class="attr">close</span>=<span class="string">&quot;)&quot;</span> <span class="attr">item</span>=<span class="string">&quot;uid&quot;</span> <span class="attr">separator</span>=<span class="string">&quot;,&quot;</span>&gt;</span></span><br><span class="line">                #&#123;uid&#125;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>SQL 语句：</p>
<p>select 字段 from user where id in (?) </p>
<p><code>&lt;foreach&gt;</code>标签用于遍历集合，它的属性：  </p>
<ul>
<li>collection：代表要遍历的集合元素，注意编写时不要写 <code>#&#123;&#125;  </code></li>
<li>open：代表语句的开始部分  </li>
<li>close：代表结束部分 </li>
<li>item：代表遍历集合的每个元素，生成的变量名  </li>
<li>sperator：代表分隔符 </li>
</ul>
<ol start="3">
<li>测试</li>
</ol>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  * 测试foreach标签的使用</span></span><br><span class="line"><span class="comment">  *</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@throws</span> IOException</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testFindInIds</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">    QueryVo vo = <span class="keyword">new</span> QueryVo();</span><br><span class="line">    List&lt;Integer&gt; list = <span class="keyword">new</span> ArrayList&lt;Integer&gt;();</span><br><span class="line">    list.add(<span class="number">41</span>);</span><br><span class="line">    list.add(<span class="number">42</span>);</span><br><span class="line">    list.add(<span class="number">43</span>);</span><br><span class="line">    list.add(<span class="number">100</span>);</span><br><span class="line">    vo.setIds(list);</span><br><span class="line"></span><br><span class="line">    List&lt;User&gt; users = userDao.findUserInIds(vo);</span><br><span class="line">    users.forEach(System.out::println);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Mybatis-中简化编写的-SQL-片段"><a href="#Mybatis-中简化编写的-SQL-片段" class="headerlink" title="Mybatis 中简化编写的 SQL 片段"></a>Mybatis 中简化编写的 SQL 片段</h2><p>Sql 中可将重复的 sql 提取出来，使用时用 include 引用即可，最终达到 sql 重用的目的。 </p>
<ol>
<li>定义代码片段</li>
</ol>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--  抽取重复的sql语句 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">sql</span> <span class="attr">id</span>=<span class="string">&quot;defaultUser&quot;</span>&gt;</span></span><br><span class="line">    select * from user</span><br><span class="line"><span class="tag">&lt;/<span class="name">sql</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ol start="2">
<li>引用代码片段 </li>
</ol>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--配置查询所有--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--id是dao的方法名称，不能随便写--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findAll&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.conv.domain.User&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">include</span> <span class="attr">refid</span>=<span class="string">&quot;defaultUser&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--  根据QueryVo中提供的id集合，查询用户信息 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findUserInIds&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;com.conv.domain.QueryVo&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.conv.domain.User&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">include</span> <span class="attr">refid</span>=<span class="string">&quot;defaultUser&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;ids != null and ids.size() &gt; 0&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">foreach</span> <span class="attr">collection</span>=<span class="string">&quot;ids&quot;</span> <span class="attr">open</span>=<span class="string">&quot;and id in (&quot;</span> <span class="attr">close</span>=<span class="string">&quot;)&quot;</span> <span class="attr">item</span>=<span class="string">&quot;uid&quot;</span> <span class="attr">separator</span>=<span class="string">&quot;,&quot;</span>&gt;</span></span><br><span class="line">                #&#123;uid&#125;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>注意：</p>
<p>sql 语句后面的分号可加可不加，但是提取的 sql 语句一定不能加分号，因为提取出来的语句可能需要与其他 sql 语句进行拼接，加分号会导致错误，所以建议都不加分号</p>
</blockquote>
<h2 id="Mybatis-中的多表操作"><a href="#Mybatis-中的多表操作" class="headerlink" title="Mybatis 中的多表操作"></a>Mybatis 中的多表操作</h2><p>表之间的关系：一对多、多对一、一对一、多对多</p>
<p>特例：一个用户对应多个订单，如果拿出每一个订单，它只能属于一个用户，所以 Mybatis 就把多对一看成了一对一</p>
<h3 id="一对一、一对多"><a href="#一对一、一对多" class="headerlink" title="一对一、一对多"></a>一对一、一对多</h3><p>示例：用户和账户</p>
<p>一个用户可以有多个账户，一个账户只能属于一个用户（多个账户也可以属于同一个用户）</p>
<h4 id="步骤："><a href="#步骤：" class="headerlink" title="步骤："></a>步骤：</h4><ol>
<li>建立两张表：用户表，账户表，让用户表和账户表之间具备一对多的关系：需要使用外键在账户表中添加</li>
</ol>
<p><code>sql</code></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> <span class="keyword">IF</span> <span class="keyword">EXISTS</span> <span class="string">`user`</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`user`</span> (</span><br><span class="line">  <span class="string">`id`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> auto_increment,</span><br><span class="line">  <span class="string">`username`</span> <span class="built_in">varchar</span>(<span class="number">32</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">&#x27;用户名称&#x27;</span>,</span><br><span class="line">  <span class="string">`birthday`</span> datetime <span class="keyword">default</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">&#x27;生日&#x27;</span>,</span><br><span class="line">  <span class="string">`sex`</span> <span class="built_in">char</span>(<span class="number">1</span>) <span class="keyword">default</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">&#x27;性别&#x27;</span>,</span><br><span class="line">  <span class="string">`address`</span> <span class="built_in">varchar</span>(<span class="number">256</span>) <span class="keyword">default</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">&#x27;地址&#x27;</span>,</span><br><span class="line">  PRIMARY <span class="keyword">KEY</span>  (<span class="string">`id`</span>)</span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8;</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span>  <span class="keyword">into</span> <span class="string">`user`</span>(<span class="string">`id`</span>,<span class="string">`username`</span>,<span class="string">`birthday`</span>,<span class="string">`sex`</span>,<span class="string">`address`</span>) <span class="keyword">values</span> (<span class="number">41</span>,<span class="string">&#x27;老王&#x27;</span>,<span class="string">&#x27;2018-02-27 17:47:08&#x27;</span>,<span class="string">&#x27;男&#x27;</span>,<span class="string">&#x27;北京&#x27;</span>),(<span class="number">42</span>,<span class="string">&#x27;小二王&#x27;</span>,<span class="string">&#x27;2018-03-02 15:09:37&#x27;</span>,<span class="string">&#x27;女&#x27;</span>,<span class="string">&#x27;北京金燕龙&#x27;</span>),(<span class="number">43</span>,<span class="string">&#x27;小二王&#x27;</span>,<span class="string">&#x27;2018-03-04 11:34:34&#x27;</span>,<span class="string">&#x27;女&#x27;</span>,<span class="string">&#x27;北京金燕龙&#x27;</span>),(<span class="number">45</span>,<span class="string">&#x27;传智播客&#x27;</span>,<span class="string">&#x27;2018-03-04 12:04:06&#x27;</span>,<span class="string">&#x27;男&#x27;</span>,<span class="string">&#x27;北京金燕龙&#x27;</span>),(<span class="number">46</span>,<span class="string">&#x27;老王&#x27;</span>,<span class="string">&#x27;2018-03-07 17:37:26&#x27;</span>,<span class="string">&#x27;男&#x27;</span>,<span class="string">&#x27;北京&#x27;</span>),(<span class="number">48</span>,<span class="string">&#x27;小马宝莉&#x27;</span>,<span class="string">&#x27;2018-03-08 11:44:00&#x27;</span>,<span class="string">&#x27;女&#x27;</span>,<span class="string">&#x27;北京修正&#x27;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> <span class="keyword">IF</span> <span class="keyword">EXISTS</span> <span class="string">`account`</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`account`</span> (</span><br><span class="line">  <span class="string">`ID`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">&#x27;编号&#x27;</span>,</span><br><span class="line">  <span class="string">`UID`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">default</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">&#x27;用户编号&#x27;</span>,</span><br><span class="line">  <span class="string">`MONEY`</span> <span class="keyword">double</span> <span class="keyword">default</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">&#x27;金额&#x27;</span>,</span><br><span class="line">  PRIMARY <span class="keyword">KEY</span>  (<span class="string">`ID`</span>),</span><br><span class="line">  <span class="keyword">KEY</span> <span class="string">`FK_Reference_8`</span> (<span class="string">`UID`</span>),</span><br><span class="line">  <span class="keyword">CONSTRAINT</span> <span class="string">`FK_Reference_8`</span> <span class="keyword">FOREIGN</span> <span class="keyword">KEY</span> (<span class="string">`UID`</span>) <span class="keyword">REFERENCES</span> <span class="string">`user`</span> (<span class="string">`id`</span>)</span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8;</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span>  <span class="keyword">into</span> <span class="string">`account`</span>(<span class="string">`ID`</span>,<span class="string">`UID`</span>,<span class="string">`MONEY`</span>) <span class="keyword">values</span> (<span class="number">1</span>,<span class="number">46</span>,<span class="number">1000</span>),(<span class="number">2</span>,<span class="number">45</span>,<span class="number">1000</span>),(<span class="number">3</span>,<span class="number">46</span>,<span class="number">2000</span>);</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>建立两个实体类：用户实体类和账户实体类，让用户和账户的实体类能体现出来一对多的关系 </li>
</ol>
<blockquote>
<p>通过面向对象的(has a)关系可以得知，我们可以在 Account 类中加入一个 User 类的对象来代表这个账户 是哪个用户的。 </p>
</blockquote>
<p><code>User.java</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.conv.domain;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    <span class="keyword">private</span> Date birthday;</span><br><span class="line">    <span class="keyword">private</span> String sex;</span><br><span class="line">    <span class="keyword">private</span> String address;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 一对多关系映射：主表实体应该包含从表实体的集合引用</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;Account&gt; accounts;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Account&gt; <span class="title">getAccounts</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> accounts;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAccounts</span><span class="params">(List&lt;Account&gt; accounts)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.accounts = accounts;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Integer <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getUsername</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> username;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUsername</span><span class="params">(String username)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.username = username;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Date <span class="title">getBirthday</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> birthday;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setBirthday</span><span class="params">(Date birthday)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.birthday = birthday;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getSex</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> sex;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSex</span><span class="params">(String sex)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.sex = sex;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getAddress</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> address;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAddress</span><span class="params">(String address)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.address = address;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;User&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;id=&quot;</span> + id +</span><br><span class="line">                <span class="string">&quot;, username=&#x27;&quot;</span> + username + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, birthday=&quot;</span> + birthday +</span><br><span class="line">                <span class="string">&quot;, sex=&#x27;&quot;</span> + sex + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, address=&#x27;&quot;</span> + address + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>account.java</code></p>
<p>因为 Account 类中包含了一个 User 类的对象，它可以封装账户所对应的用户信息</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.conv.domain;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Account</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> Integer uid;</span><br><span class="line">    <span class="keyword">private</span> Double money;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 一对一关系映射：从表实体应该包含一个主表实体的对象引用</span></span><br><span class="line">    <span class="keyword">private</span> User user;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Integer <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Integer <span class="title">getUid</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> uid;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUid</span><span class="params">(Integer uid)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.uid = uid;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Double <span class="title">getMoney</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> money;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMoney</span><span class="params">(Double money)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.money = money;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> User <span class="title">getUser</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> user;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUser</span><span class="params">(User user)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.user = user;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Account&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;id=&quot;</span> + id +</span><br><span class="line">                <span class="string">&quot;, uid=&quot;</span> + uid +</span><br><span class="line">                <span class="string">&quot;, money=&quot;</span> + money +</span><br><span class="line">                <span class="string">&quot;, user=&quot;</span> + user +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>DAO：</p>
<p><code>src\main\java\com\conv\dao\IAccountDao.java</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.conv.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IAccountDao</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 查询所有账户，同时还要获取到当前账户的所属用户信息</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function">List&lt;Account&gt; <span class="title">findAll</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="3">
<li><p>建立两个配置文件：用户的配置文件、账户的配置文件。并实现配置：</p>
<p><strong>1. 一对一查询（多对一）：当我们查询账户时，可以同时得到账户的所属用户信息</strong></p>
<p><strong>2. 一对多查询：当我们查询用户时，可以同时得到用户下所包含的账户信息</strong></p>
</li>
</ol>
<blockquote>
<p>注意：</p>
<p>因为一个账户信息只能供某个用户使用</p>
<p>所以从查询账户信息出发关联查询用户信息为一对一查询</p>
<p>如果从用户信息出发查询用户下的账户信息则为一对多查询，因为一个用户可以有多个账户</p>
</blockquote>
<h4 id="一对一查询"><a href="#一对一查询" class="headerlink" title="一对一查询"></a>一对一查询</h4><blockquote>
<p>分析：</p>
<p>当我们查询账户时，可以同时得到账户的所属用户信息。</p>
</blockquote>
<ol>
<li>要实现查询所有账户，同时还要获取到当前账户的所属用户信息，先写出其 SQL 语句：</li>
</ol>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">SELECT a.*, u.username, u.address FROM account a, &#96;user&#96; u WHERE u.id &#x3D; a.uid</span><br></pre></td></tr></table></figure>

<p>我们可以使用 <code>resultMap</code>，定义专门的 <code>resultMap</code> 用于映射一对一查询结果。</p>
<ol start="2">
<li>定义 AccountDao.xml 文件：</li>
</ol>
<p><code>src\main\resources\com\conv\dao\IAccountDao.xml</code></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--namespace是Dao的全限定类名--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.conv.dao.IAccountDao&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--定义封装account和user的resultMap--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;accountUserMap&quot;</span> <span class="attr">type</span>=<span class="string">&quot;account&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;aid&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;uid&quot;</span> <span class="attr">column</span>=<span class="string">&quot;uid&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;money&quot;</span> <span class="attr">column</span>=<span class="string">&quot;money&quot;</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--  一对一的关系映射，配置封装user的内容 --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--  javaType用于提示封装到那个对象（好像删了也没事） --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">&quot;user&quot;</span> <span class="attr">column</span>=<span class="string">&quot;uid&quot;</span> <span class="attr">javaType</span>=<span class="string">&quot;user&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;id&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;username&quot;</span> <span class="attr">column</span>=<span class="string">&quot;username&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;address&quot;</span> <span class="attr">column</span>=<span class="string">&quot;address&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;sex&quot;</span> <span class="attr">column</span>=<span class="string">&quot;sex&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;birthday&quot;</span> <span class="attr">column</span>=<span class="string">&quot;birthday&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">association</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--配置查询所有--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--id是dao的方法名称，resultMap是resultMap的id--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findAll&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;accountUserMap&quot;</span>&gt;</span></span><br><span class="line">        SELECT a.*, u.username, u.address FROM account a, `user` u WHERE u.id = a.uid</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ol start="3">
<li>测试</li>
</ol>
<p><code>src\test\java\com\conv\test\AccountTest.java</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.conv.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AccountTest</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> InputStream in;</span><br><span class="line">    <span class="keyword">private</span> SqlSession session;</span><br><span class="line">    IAccountDao accountDao;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Before</span> <span class="comment">//用于在测试方法执行之前执行</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="comment">//1. 读取配置文件，生成字节输入流</span></span><br><span class="line">        in = Resources.getResourceAsStream(<span class="string">&quot;SqlMapConfig.xml&quot;</span>);</span><br><span class="line">        <span class="comment">//2. 获取SqlSessionFactory</span></span><br><span class="line">        SqlSessionFactory factory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(in);</span><br><span class="line">        <span class="comment">//3. 获取SqlSession对象</span></span><br><span class="line">        session = factory.openSession();</span><br><span class="line">        <span class="comment">//4. 获取dao的代理对象</span></span><br><span class="line">        accountDao = session.getMapper(IAccountDao.class);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@After</span>  <span class="comment">//用于在测试方法执行之后执行</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="comment">//提交事务</span></span><br><span class="line">        session.commit();</span><br><span class="line">        <span class="comment">// 关闭资源</span></span><br><span class="line">        session.close();</span><br><span class="line">        in.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 测试查询所有</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IOException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testFindAll</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        List&lt;Account&gt; accounts = accountDao.findAll();</span><br><span class="line">        accounts.forEach(System.out::println);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="一对多查询"><a href="#一对多查询" class="headerlink" title="一对多查询"></a>一对多查询</h4><blockquote>
<p>分析：</p>
<p>当我们查询用户时，可以同时得到用户下所包含的账户信息</p>
</blockquote>
<ol>
<li>先写出其 SQL 语句：</li>
</ol>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> <span class="string">`user`</span> u <span class="keyword">LEFT</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> <span class="keyword">account</span> a <span class="keyword">on</span> u.id = a.UID</span><br></pre></td></tr></table></figure>

<p>左外连接会返回左表的所有数据</p>
<ol start="2">
<li>定义 UserDao.xml 文件：</li>
</ol>
<p><code>src\main\resources\com\conv\dao\IUserDao.xml</code></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--namespace是Dao的全限定类名--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.conv.dao.IUserDao&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--  定义User的resultMap --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;userAccountMap&quot;</span> <span class="attr">type</span>=<span class="string">&quot;user&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;id&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;username&quot;</span> <span class="attr">column</span>=<span class="string">&quot;username&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;address&quot;</span> <span class="attr">column</span>=<span class="string">&quot;address&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;sex&quot;</span> <span class="attr">column</span>=<span class="string">&quot;sex&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;birthday&quot;</span> <span class="attr">column</span>=<span class="string">&quot;birthday&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!--  配置user对象中 accounts 集合的映射 --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--  ofType是集合中元素的类型 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">&quot;accounts&quot;</span> <span class="attr">ofType</span>=<span class="string">&quot;account&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;aid&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;uid&quot;</span> <span class="attr">column</span>=<span class="string">&quot;uid&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;money&quot;</span> <span class="attr">column</span>=<span class="string">&quot;money&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">collection</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--配置查询所有--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--id是dao的方法名称，不能随便写--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findAll&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;userAccountMap&quot;</span>&gt;</span></span><br><span class="line">        SELECT * FROM `user` u LEFT OUTER JOIN account a on u.id = a.UID</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ol start="3">
<li>测试</li>
</ol>
<p><code>src\test\java\com\conv\test\UserTest.java</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.conv.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserTest</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> InputStream in;</span><br><span class="line">    <span class="keyword">private</span> SqlSession session;</span><br><span class="line">    IUserDao userDao;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Before</span> <span class="comment">//用于在测试方法执行之前执行</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="comment">//1. 读取配置文件，生成字节输入流</span></span><br><span class="line">        in = Resources.getResourceAsStream(<span class="string">&quot;SqlMapConfig.xml&quot;</span>);</span><br><span class="line">        <span class="comment">//2. 获取SqlSessionFactory</span></span><br><span class="line">        SqlSessionFactory factory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(in);</span><br><span class="line">        <span class="comment">//3. 获取SqlSession对象</span></span><br><span class="line">        session = factory.openSession();</span><br><span class="line">        <span class="comment">//4. 获取dao的代理对象</span></span><br><span class="line">        userDao = session.getMapper(IUserDao.class);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@After</span>  <span class="comment">//用于在测试方法执行之后执行</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="comment">//提交事务</span></span><br><span class="line">        session.commit();</span><br><span class="line">        <span class="comment">// 关闭资源</span></span><br><span class="line">        session.close();</span><br><span class="line">        in.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 测试查询所有</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IOException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testFindAll</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        List&lt;User&gt; users = userDao.findAll();</span><br><span class="line">        users.forEach(user -&gt; &#123;</span><br><span class="line">            System.out.println(user);</span><br><span class="line">            System.out.println(user.getAccounts());</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="多对多"><a href="#多对多" class="headerlink" title="多对多"></a>多对多</h3><p>示例：用户和角色</p>
<p>一个用户可以有多个角色，一个角色可以赋予多个用户</p>
<h4 id="步骤：-1"><a href="#步骤：-1" class="headerlink" title="步骤："></a>步骤：</h4><ol>
<li>建立两张表：用户表，角色表，让用户表和角色表具有多对多的关系。需要使用中间表，中间表中包含各自的主键，在中间表中是外键。</li>
</ol>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> <span class="keyword">IF</span> <span class="keyword">EXISTS</span> <span class="string">`role`</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`role`</span> (</span><br><span class="line">  <span class="string">`ID`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">&#x27;编号&#x27;</span>,</span><br><span class="line">  <span class="string">`ROLE_NAME`</span> <span class="built_in">varchar</span>(<span class="number">30</span>) <span class="keyword">default</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">&#x27;角色名称&#x27;</span>,</span><br><span class="line">  <span class="string">`ROLE_DESC`</span> <span class="built_in">varchar</span>(<span class="number">60</span>) <span class="keyword">default</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">&#x27;角色描述&#x27;</span>,</span><br><span class="line">  PRIMARY <span class="keyword">KEY</span>  (<span class="string">`ID`</span>)</span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8;</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span>  <span class="keyword">into</span> <span class="string">`role`</span>(<span class="string">`ID`</span>,<span class="string">`ROLE_NAME`</span>,<span class="string">`ROLE_DESC`</span>) <span class="keyword">values</span> (<span class="number">1</span>,<span class="string">&#x27;院长&#x27;</span>,<span class="string">&#x27;管理整个学院&#x27;</span>),(<span class="number">2</span>,<span class="string">&#x27;总裁&#x27;</span>,<span class="string">&#x27;管理整个公司&#x27;</span>),(<span class="number">3</span>,<span class="string">&#x27;校长&#x27;</span>,<span class="string">&#x27;管理整个学校&#x27;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> <span class="keyword">IF</span> <span class="keyword">EXISTS</span> <span class="string">`user_role`</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`user_role`</span> (</span><br><span class="line">  <span class="string">`UID`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">&#x27;用户编号&#x27;</span>,</span><br><span class="line">  <span class="string">`RID`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">&#x27;角色编号&#x27;</span>,</span><br><span class="line">  PRIMARY <span class="keyword">KEY</span>  (<span class="string">`UID`</span>,<span class="string">`RID`</span>),</span><br><span class="line">  <span class="keyword">KEY</span> <span class="string">`FK_Reference_10`</span> (<span class="string">`RID`</span>),</span><br><span class="line">  <span class="keyword">CONSTRAINT</span> <span class="string">`FK_Reference_10`</span> <span class="keyword">FOREIGN</span> <span class="keyword">KEY</span> (<span class="string">`RID`</span>) <span class="keyword">REFERENCES</span> <span class="string">`role`</span> (<span class="string">`ID`</span>),</span><br><span class="line">  <span class="keyword">CONSTRAINT</span> <span class="string">`FK_Reference_9`</span> <span class="keyword">FOREIGN</span> <span class="keyword">KEY</span> (<span class="string">`UID`</span>) <span class="keyword">REFERENCES</span> <span class="string">`user`</span> (<span class="string">`id`</span>)</span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8;</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span>  <span class="keyword">into</span> <span class="string">`user_role`</span>(<span class="string">`UID`</span>,<span class="string">`RID`</span>) <span class="keyword">values</span> (<span class="number">41</span>,<span class="number">1</span>),(<span class="number">45</span>,<span class="number">1</span>),(<span class="number">41</span>,<span class="number">2</span>);</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>建立两个实体类：用户实体类和角色实体类，让用户和角色的实体类能体现出来多对多的关系，各自包含对方一个集合引用</li>
</ol>
<p><code>src\main\java\com\conv\domain\User.java</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.conv.domain;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    <span class="keyword">private</span> Date birthday;</span><br><span class="line">    <span class="keyword">private</span> String sex;</span><br><span class="line">    <span class="keyword">private</span> String address;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//多对多的关系映射：一个用户可以具备多个角色</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;Role&gt; roles;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Role&gt; <span class="title">getRoles</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> roles;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setRoles</span><span class="params">(List&lt;Role&gt; roles)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.roles = roles;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Integer <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getUsername</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> username;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUsername</span><span class="params">(String username)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.username = username;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Date <span class="title">getBirthday</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> birthday;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setBirthday</span><span class="params">(Date birthday)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.birthday = birthday;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getSex</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> sex;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSex</span><span class="params">(String sex)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.sex = sex;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getAddress</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> address;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAddress</span><span class="params">(String address)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.address = address;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;User&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;id=&quot;</span> + id +</span><br><span class="line">                <span class="string">&quot;, username=&#x27;&quot;</span> + username + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, birthday=&quot;</span> + birthday +</span><br><span class="line">                <span class="string">&quot;, sex=&#x27;&quot;</span> + sex + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, address=&#x27;&quot;</span> + address + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>src\main\java\com\conv\domain\Role.java</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.conv.domain;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Role</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Integer roleId;</span><br><span class="line">    <span class="keyword">private</span> String roleName;</span><br><span class="line">    <span class="keyword">private</span> String roleDesc;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//多对多的关系映射，一个角色可以赋予多个用户</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;User&gt; users;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;User&gt; <span class="title">getUsers</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> users;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUsers</span><span class="params">(List&lt;User&gt; users)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.users = users;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Integer <span class="title">getRoleId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> roleId;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setRoleId</span><span class="params">(Integer roleId)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.roleId = roleId;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getRoleName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> roleName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setRoleName</span><span class="params">(String roleName)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.roleName = roleName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getRoleDesc</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> roleDesc;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setRoleDesc</span><span class="params">(String roleDesc)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.roleDesc = roleDesc;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Role&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;roleId=&quot;</span> + roleId +</span><br><span class="line">                <span class="string">&quot;, roleName=&#x27;&quot;</span> + roleName + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, roleDesc=&#x27;&quot;</span> + roleDesc + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>持久层接口 <code>src\main\java\com\conv\dao\IRoleDao.java</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.conv.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IRoleDao</span> </span>&#123;</span><br><span class="line">    <span class="function">List&lt;Role&gt; <span class="title">findAll</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="3">
<li><p>建立两个配置文件：用户的配置文件，角色的配置文件</p>
<p>实现配置：</p>
<ul>
<li>当我们查询用户时，可以同时得到用户所包含的角色信息；</li>
<li>当我们查询角色时，可以同时得到角色的所赋予的用户信息</li>
</ul>
</li>
</ol>
<p>分析：</p>
<p><strong>查询用户：</strong></p>
<blockquote>
<p>我们需要用到Role表，但角色分配的用户的信息我们并不能直接找到用户信息，而是要通过中间表(USER_ROLE 表)才能关联到用户信息。 </p>
</blockquote>
<p>写出其SQL语句</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> u.*,r.id <span class="keyword">as</span> rid,r.role_name,r.role_desc <span class="keyword">FROM</span> <span class="string">`user`</span> u</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> user_role ur <span class="keyword">on</span> u.id = ur.UID</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> <span class="keyword">role</span> r <span class="keyword">on</span> r.ID = ur.RID</span><br></pre></td></tr></table></figure>

<p><strong>查询角色：</strong></p>
<blockquote>
<p>我们需要用到Role表，但角色分配的用户的信息我们并不能直接找到用户信息，而是要通过中间表(USER_ROLE 表)才能关联到用户信息。 </p>
</blockquote>
<p>写出其SQL语句</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> u.*,r.id <span class="keyword">as</span> rid,r.role_name,r.role_desc <span class="keyword">FROM</span> <span class="keyword">role</span> r</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> user_role ur <span class="keyword">on</span> r.ID = ur.RID</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> <span class="string">`user`</span> u <span class="keyword">on</span> u.id = ur.UID</span><br></pre></td></tr></table></figure>

<p><strong>建立两个配置文件</strong></p>
<p><code>src\main\resources\com\conv\dao\IUserDao.xml</code></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--namespace是Dao的全限定类名--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.conv.dao.IUserDao&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--  定义User的resultMap --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;userMap&quot;</span> <span class="attr">type</span>=<span class="string">&quot;user&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;id&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;username&quot;</span> <span class="attr">column</span>=<span class="string">&quot;username&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;address&quot;</span> <span class="attr">column</span>=<span class="string">&quot;address&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;sex&quot;</span> <span class="attr">column</span>=<span class="string">&quot;sex&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;birthday&quot;</span> <span class="attr">column</span>=<span class="string">&quot;birthday&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- 配置角色集合的映射 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">&quot;roles&quot;</span> <span class="attr">ofType</span>=<span class="string">&quot;role&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;roleId&quot;</span> <span class="attr">column</span>=<span class="string">&quot;rid&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;roleName&quot;</span> <span class="attr">column</span>=<span class="string">&quot;role_name&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;roleDesc&quot;</span> <span class="attr">column</span>=<span class="string">&quot;role_desc&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">collection</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--配置查询所有--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--id是dao的方法名称，不能随便写--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findAll&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;userMap&quot;</span>&gt;</span></span><br><span class="line">        SELECT u.*,r.id as rid,r.role_name,r.role_desc FROM `user` u</span><br><span class="line">        LEFT OUTER JOIN user_role ur on u.id = ur.UID</span><br><span class="line">        LEFT OUTER JOIN role r on r.ID = ur.RID</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><code>src\main\resources\com\conv\dao\IRoleDao.xml</code></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--namespace是Dao的全限定类名--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.conv.dao.IRoleDao&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--  定义Role的resultMap --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;roleMap&quot;</span> <span class="attr">type</span>=<span class="string">&quot;role&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;roleId&quot;</span> <span class="attr">column</span>=<span class="string">&quot;rid&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;roleName&quot;</span> <span class="attr">column</span>=<span class="string">&quot;role_name&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;roleDesc&quot;</span> <span class="attr">column</span>=<span class="string">&quot;role_desc&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">&quot;users&quot;</span> <span class="attr">ofType</span>=<span class="string">&quot;user&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;id&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;username&quot;</span> <span class="attr">column</span>=<span class="string">&quot;username&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;address&quot;</span> <span class="attr">column</span>=<span class="string">&quot;address&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;sex&quot;</span> <span class="attr">column</span>=<span class="string">&quot;sex&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;birthday&quot;</span> <span class="attr">column</span>=<span class="string">&quot;birthday&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">collection</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--配置查询所有--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--id是dao的方法名称，不能随便写--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findAll&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;roleMap&quot;</span>&gt;</span></span><br><span class="line">        SELECT u.*,r.id as rid,r.role_name,r.role_desc FROM role r</span><br><span class="line">        LEFT OUTER JOIN user_role ur on r.ID = ur.RID</span><br><span class="line">        LEFT OUTER JOIN `user` u on u.id = ur.UID</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ol start="4">
<li>测试</li>
</ol>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src\test\java\com\conv\test\UserTest.java</span></span><br><span class="line"><span class="comment">/** </span></span><br><span class="line"><span class="comment">  * 测试查询所有</span></span><br><span class="line"><span class="comment">  *</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@throws</span> IOException</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testFindAll</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    List&lt;User&gt; users = userDao.findAll();</span><br><span class="line">    users.forEach(user -&gt; &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;-----每个用户的信息-----&quot;</span>);</span><br><span class="line">        System.out.println(user);</span><br><span class="line">        System.out.println(user.getRoles());</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// src\test\java\com\conv\test\RoleTest.java</span></span><br><span class="line"><span class="comment">/** </span></span><br><span class="line"><span class="comment">  * 测试查询所有</span></span><br><span class="line"><span class="comment">  *</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@throws</span> IOException</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testFindAll</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    List&lt;Role&gt; roles = roleDao.findAll();</span><br><span class="line">    roles.forEach(role-&gt;&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;----每个角色的信息-----&quot;</span>);</span><br><span class="line">        System.out.println(role);</span><br><span class="line">        System.out.println(role.getUsers());</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>Mybatis</category>
      </categories>
      <tags>
        <tag>Mybatis</tag>
        <tag>JDBC</tag>
      </tags>
  </entry>
  <entry>
    <title>Mybatis学习笔记04</title>
    <url>/posts/mybatis-xue-xi-bi-ji-04/</url>
    <content><![CDATA[<h2 id="Mybatis-中的延迟加载"><a href="#Mybatis-中的延迟加载" class="headerlink" title="Mybatis 中的延迟加载"></a>Mybatis 中的延迟加载</h2><p>问题：</p>
<blockquote>
<p>在一对多中，当我们有一个用户，它有100个账户。在查询用户的时候，要不要把关联的账户查出来？在查询账户的时候，要不要把关联的用户查出来？</p>
<p>在查询用户时，用户下的账户信息应该是，什么时候使用，什么时候查询</p>
<p>在查询账户时，账户的所属用户信息应该是随着账户查询时一起查询出来的</p>
</blockquote>
<ul>
<li><p>延迟加载</p>
<p>在真正使用数据时才发起查询，不用的时候不查询。按需加载（懒加载）</p>
</li>
<li><p>立即加载</p>
<p>不管用不用，只要一调用方法，马上发起查询</p>
</li>
</ul>
<p>在对应的四种表关系中：一对多，多对一，一对一，多对多</p>
<ul>
<li>一对多，多对多（关联的对象是多）：通常情况下我们都是采用延迟加载。</li>
<li>多对一，一对一（关联的对象是一）：通常情况下我们都是采用立即加载</li>
</ul>
<p>association、collection 具备延迟加载功能</p>
<h3 id="使用-assocation-实现延迟加载"><a href="#使用-assocation-实现延迟加载" class="headerlink" title="使用 assocation 实现延迟加载"></a>使用 assocation 实现延迟加载</h3><blockquote>
<p>需求：</p>
<p>查询账户信息的同时查询用户信息（一对一）</p>
</blockquote>
<h4 id="账户的持久层-DAO-接口"><a href="#账户的持久层-DAO-接口" class="headerlink" title="账户的持久层 DAO 接口"></a>账户的持久层 DAO 接口</h4><p><code>src\main\java\com\conv\dao\IAccountDao.java</code></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">package com.conv.dao;</span><br><span class="line"></span><br><span class="line">public interface IAccountDao &#123;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 查询所有账户，同时还要获取到当前账户的所属用户信息</span><br><span class="line">     * @return</span><br><span class="line">     */</span><br><span class="line">    List<span class="tag">&lt;<span class="name">Account</span>&gt;</span> findAll();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="账户的持久层映射文件"><a href="#账户的持久层映射文件" class="headerlink" title="账户的持久层映射文件"></a>账户的持久层映射文件</h4><p><code>src\main\resources\com\conv\dao\IAccountDao.xml</code></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--namespace是Dao的全限定类名--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.conv.dao.IAccountDao&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--定义封装account和user的resultMap--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;accountUserMap&quot;</span> <span class="attr">type</span>=<span class="string">&quot;account&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;id&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;uid&quot;</span> <span class="attr">column</span>=<span class="string">&quot;uid&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;money&quot;</span> <span class="attr">column</span>=<span class="string">&quot;money&quot;</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--  一对一的关系映射，配置封装user的内容 --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--  javaType用于提示封装到那个对象（好像删了也没事） --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--  select属性指定的内容，查询用户的唯一标识 --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- column属性指定的内容，用户根据id查询时，所需要的参数的值，可自行命名 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">&quot;user&quot;</span> <span class="attr">column</span>=<span class="string">&quot;uid&quot;</span> <span class="attr">javaType</span>=<span class="string">&quot;user&quot;</span> <span class="attr">select</span>=<span class="string">&quot;com.conv.dao.IUserDao.findById&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--配置查询所有--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--id是dao的方法名称，resultMap是resultMap的id--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findAll&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;accountUserMap&quot;</span>&gt;</span></span><br><span class="line">        select * from account</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="用户的持久层接口"><a href="#用户的持久层接口" class="headerlink" title="用户的持久层接口"></a>用户的持久层接口</h4><p><code>src\main\java\com\conv\dao\IUserDao.java</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.conv.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IUserDao</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 查询所有用户</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function">List&lt;User&gt; <span class="title">findAll</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 根据id查询用户信息</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> userId</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function">User <span class="title">findById</span><span class="params">(Integer userId)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="用户的持久层映射文件"><a href="#用户的持久层映射文件" class="headerlink" title="用户的持久层映射文件"></a>用户的持久层映射文件</h4><p><code>src\main\resources\com\conv\dao\IUserDao.xml</code></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--namespace是Dao的全限定类名--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.conv.dao.IUserDao&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--配置查询所有--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--id是dao的方法名称，不能随便写--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findAll&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.conv.domain.User&quot;</span>&gt;</span></span><br><span class="line">       select * from user u left outer join account a on u.id = a.uid</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--根据id查询用户--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findById&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;Int&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.conv.domain.User&quot;</span>&gt;</span></span><br><span class="line">        select * from user where id = #&#123;uid&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="编写测试只查帐户信息不查用户信息"><a href="#编写测试只查帐户信息不查用户信息" class="headerlink" title="编写测试只查帐户信息不查用户信息"></a>编写测试只查帐户信息不查用户信息</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.conv.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AccountTest</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> InputStream in;</span><br><span class="line">    <span class="keyword">private</span> SqlSession session;</span><br><span class="line">    IAccountDao accountDao;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Before</span> <span class="comment">//用于在测试方法执行之前执行</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="comment">//1. 读取配置文件，生成字节输入流</span></span><br><span class="line">        in = Resources.getResourceAsStream(<span class="string">&quot;SqlMapConfig.xml&quot;</span>);</span><br><span class="line">        <span class="comment">//2. 获取SqlSessionFactory</span></span><br><span class="line">        SqlSessionFactory factory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(in);</span><br><span class="line">        <span class="comment">//3. 获取SqlSession对象</span></span><br><span class="line">        session = factory.openSession();</span><br><span class="line">        <span class="comment">//4. 获取dao的代理对象</span></span><br><span class="line">        accountDao = session.getMapper(IAccountDao.class);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@After</span>  <span class="comment">//用于在测试方法执行之后执行</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="comment">//提交事务</span></span><br><span class="line">        session.commit();</span><br><span class="line">        <span class="comment">// 关闭资源</span></span><br><span class="line">        session.close();</span><br><span class="line">        in.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 因为本次只是将Account对象查询出来放入List集合中，并没有涉及到User对象，</span></span><br><span class="line"><span class="comment">     * 所以就没有 发出 SQL 语句查询账户所关联的 User 对象的查询</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IOException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testFindAll</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        List&lt;Account&gt; accounts = accountDao.findAll();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="使用-Collection-实现延迟加载"><a href="#使用-Collection-实现延迟加载" class="headerlink" title="使用 Collection 实现延迟加载"></a>使用 Collection 实现延迟加载</h3><blockquote>
<p>同样我们也可以在一对多关系配置的 <code>&lt;collection&gt;</code> 结点中配置延迟加载策略。</p>
<p><code>&lt;collection&gt;</code> 结点中也有 select 属性，column 属性。 </p>
<p>需求： </p>
<p>完成加载用户对象时，查询该用户所拥有的账户信息。（一对多）</p>
</blockquote>
<h3 id="在-User-实体类中加入-List-lt-Account-gt-属性"><a href="#在-User-实体类中加入-List-lt-Account-gt-属性" class="headerlink" title="在 User 实体类中加入 List&lt;Account&gt;属性"></a>在 User 实体类中加入 <code>List&lt;Account&gt;</code>属性</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.conv.domain;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    <span class="keyword">private</span> Date birthday;</span><br><span class="line">    <span class="keyword">private</span> String sex;</span><br><span class="line">    <span class="keyword">private</span> String address;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 一对多关系映射：主表实体应该包含从表实体的集合引用</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;Account&gt; accounts;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Account&gt; <span class="title">getAccounts</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> accounts;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAccounts</span><span class="params">(List&lt;Account&gt; accounts)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.accounts = accounts;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Integer <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getUsername</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> username;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUsername</span><span class="params">(String username)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.username = username;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Date <span class="title">getBirthday</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> birthday;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setBirthday</span><span class="params">(Date birthday)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.birthday = birthday;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getSex</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> sex;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSex</span><span class="params">(String sex)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.sex = sex;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getAddress</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> address;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAddress</span><span class="params">(String address)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.address = address;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;User&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;id=&quot;</span> + id +</span><br><span class="line">                <span class="string">&quot;, username=&#x27;&quot;</span> + username + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, birthday=&quot;</span> + birthday +</span><br><span class="line">                <span class="string">&quot;, sex=&#x27;&quot;</span> + sex + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, address=&#x27;&quot;</span> + address + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="账户的持久层-DAO-接口-1"><a href="#账户的持久层-DAO-接口-1" class="headerlink" title="账户的持久层 DAO 接口"></a>账户的持久层 DAO 接口</h4><p><code>src\main\java\com\conv\dao\IAccountDao.java</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.conv.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IAccountDao</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 查询所有账户，同时还要获取到当前账户的所属用户信息</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function">List&lt;Account&gt; <span class="title">findAll</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 根据用户 id 查询账户信息</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> uid</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function">List&lt;Account&gt; <span class="title">findByUid</span><span class="params">(Integer uid)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="编写用户持久层映射配置"><a href="#编写用户持久层映射配置" class="headerlink" title="编写用户持久层映射配置"></a>编写用户持久层映射配置</h4><p><code>src\main\resources\com\conv\dao\IUserDao.xml</code></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--namespace是Dao的全限定类名--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.conv.dao.IUserDao&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;userMap&quot;</span> <span class="attr">type</span>=<span class="string">&quot;user&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">&quot;id&quot;</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;username&quot;</span> <span class="attr">property</span>=<span class="string">&quot;username&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;address&quot;</span> <span class="attr">property</span>=<span class="string">&quot;address&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;sex&quot;</span> <span class="attr">property</span>=<span class="string">&quot;sex&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;birthday&quot;</span> <span class="attr">property</span>=<span class="string">&quot;birthday&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- collection是用于建立一对多集合属性的对应关系</span></span><br><span class="line"><span class="comment">             ofType用于指定集合元素的数据类型</span></span><br><span class="line"><span class="comment">             select用于指定查询账户的唯一标识（账户的 dao 全限定类名加上方法名）</span></span><br><span class="line"><span class="comment">             column用于指定哪个字段的值作为条件查询</span></span><br><span class="line"><span class="comment">         --&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- collection标签主要用于加载关联的集合对象 --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- select属性用于指定查询account列表的sql语句，所以填写的是该sql映射的id --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- column属性用于指定select属性的参数来源，上面的参数来源于user的id列，所以就写id这个字段名 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">&quot;accounts&quot;</span> <span class="attr">ofType</span>=<span class="string">&quot;account&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">select</span>=<span class="string">&quot;com.conv.dao.IAccountDao.findByUid&quot;</span> <span class="attr">column</span>=<span class="string">&quot;id&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--配置查询所有--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--id是dao的方法名称，不能随便写--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findAll&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;userMap&quot;</span>&gt;</span></span><br><span class="line">       select * from user</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="编写账户持久层映射配置"><a href="#编写账户持久层映射配置" class="headerlink" title="编写账户持久层映射配置"></a>编写账户持久层映射配置</h4><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 根据用户的 id 查询账户信息 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findByUid&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;account&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;int&quot;</span>&gt;</span></span><br><span class="line">    select * from account where uid = #&#123;uid&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="测试只加载用户信息"><a href="#测试只加载用户信息" class="headerlink" title="测试只加载用户信息"></a>测试只加载用户信息</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.conv.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserTest</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> InputStream in;</span><br><span class="line">    <span class="keyword">private</span> SqlSession session;</span><br><span class="line">    IUserDao userDao;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Before</span> <span class="comment">//用于在测试方法执行之前执行</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="comment">//1. 读取配置文件，生成字节输入流</span></span><br><span class="line">        in = Resources.getResourceAsStream(<span class="string">&quot;SqlMapConfig.xml&quot;</span>);</span><br><span class="line">        <span class="comment">//2. 获取SqlSessionFactory</span></span><br><span class="line">        SqlSessionFactory factory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(in);</span><br><span class="line">        <span class="comment">//3. 获取SqlSession对象</span></span><br><span class="line">        session = factory.openSession();</span><br><span class="line">        <span class="comment">//4. 获取dao的代理对象</span></span><br><span class="line">        userDao = session.getMapper(IUserDao.class);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@After</span>  <span class="comment">//用于在测试方法执行之后执行</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="comment">//提交事务</span></span><br><span class="line">        session.commit();</span><br><span class="line">        <span class="comment">// 关闭资源</span></span><br><span class="line">        session.close();</span><br><span class="line">        in.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 测试查询所有</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IOException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testFindAll</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        List&lt;User&gt; users = userDao.findAll();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Mybatis-中的缓存"><a href="#Mybatis-中的缓存" class="headerlink" title="Mybatis 中的缓存"></a>Mybatis 中的缓存</h2><p>使用缓存可以减少和数据库的交互次数，提高执行效率。</p>
<ul>
<li>适用于缓存的：<ul>
<li>经常查询并且不经常改变的数据</li>
<li>数据的正确与否对最终结果影响不大的数据</li>
</ul>
</li>
</ul>
<p>Mybatis 中缓存分为一级缓存，二级缓存。</p>
<h3 id="一级缓存"><a href="#一级缓存" class="headerlink" title="一级缓存"></a>一级缓存</h3><p>它指的是 Mybatis 中 <code>SqlSession</code> 对象的缓存。</p>
<blockquote>
<p>当我们执行查询之后，查询的结果会同时存入到 <code>SqlSession</code> 为我们提供一块区域中。</p>
<p>该区域的结构是一个Map。当我们再次查询同样的数据，Mybatis 会先去 <code>Sqlsession</code> 中查询是否有，有的话直接拿出来用。</p>
<p>一级缓存是 <code>SqlSession</code> 级别的缓存，只要 <code>SqlSession</code> 没有 <code>flush</code> 或 <code>close</code>，它就存在。</p>
</blockquote>
<p>分析：</p>
<p>一级缓存是 <code>SqlSession</code> 范围的缓存，当调用 <code>SqlSession</code> 的修改，添加，删除，<code>commit()</code>，<code>close()</code> 等方法时，就会清空一级缓存。 </p>
<p>测试代码：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testFirstCache</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        User user1 = userDao.findById(<span class="number">41</span>);</span><br><span class="line">        System.out.println(user1);</span><br><span class="line"></span><br><span class="line">        <span class="comment">/* 1. 使用 close 实现清空缓存 */</span></span><br><span class="line"><span class="comment">//        session.close();</span></span><br><span class="line"><span class="comment">//        //再次获取 Session 对象</span></span><br><span class="line"><span class="comment">//        session = factory.openSession();</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">/* 2. 使用 clearCache 实现清空缓存 */</span></span><br><span class="line">        session.clearCache();</span><br><span class="line"></span><br><span class="line">        userDao = session.getMapper(IUserDao.class);</span><br><span class="line"></span><br><span class="line">        User user2 = userDao.findById(<span class="number">41</span>);</span><br><span class="line">        System.out.println(user2);</span><br><span class="line"></span><br><span class="line">        System.out.println(user1 == user2);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h3 id="二级缓存"><a href="#二级缓存" class="headerlink" title="二级缓存"></a>二级缓存</h3><p>它指的是 Mybatis 中 <code>SqlSessionFactory</code> 对象的缓存。由同一个 <code>SqlSessionFactory</code> 对象创建的 <code>SqlSession</code> 共享其缓存。</p>
<p>二级缓存的使用步骤：</p>
<ol>
<li>让 Mybatis 框架支持二级缓存（在 <code>SqlMapConfig.xml</code> 中配置）</li>
</ol>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- cacheEnabled 的默认值就是 true，所以不配置也行 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;cacheEnabled&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ol start="2">
<li>让当前的映射文件支持二级缓存（在 <code>IUserDao.xml</code> 中配置）</li>
</ol>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--namespace是Dao的全限定类名--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.conv.dao.IUserDao&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 开启user支持二级缓存 --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--&lt;cache&gt;标签表示当前这个 mapper 映射将使用二级缓存，区分的标准就看 mapper 的 namespace 值 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">cache</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--配置查询所有--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findAll&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;user&quot;</span>&gt;</span></span><br><span class="line">       select * from user</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--根据id查询用户--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findById&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;Int&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.conv.domain.User&quot;</span> <span class="attr">useCache</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">        select * from user where id = #&#123;uid&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 更新用户信息 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">&quot;updateUser&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;user&quot;</span>&gt;</span></span><br><span class="line">        update user set username = #&#123;username&#125;,address = #&#123;address&#125; where id = #&#123;id&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ol start="3">
<li><p>让当前的操作支持二级缓存（在 <code>select</code> 标签中配置）</p>
<p>将 <code>UserDao.xml</code> 映射文件中的 <code>&lt;select&gt;</code> 标签中设置 <code>useCache=”true”</code> 代表当前这个 <code>statement</code> 要使用 二级缓存，如果不使用二级缓存可以设置为 false。 </p>
<p>注意：针对每次查询都需要最新的数据 sql，要设置成 <code>useCache=false</code>，禁用二级缓存。 </p>
</li>
<li><p>二级缓存测试：</p>
</li>
</ol>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.conv.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SecondLevelCacheTest</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> InputStream in;</span><br><span class="line">    SqlSessionFactory factory;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Before</span> <span class="comment">//用于在测试方法执行之前执行</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="comment">//1. 读取配置文件，生成字节输入流</span></span><br><span class="line">        in = Resources.getResourceAsStream(<span class="string">&quot;SqlMapConfig.xml&quot;</span>);</span><br><span class="line">        <span class="comment">//2. 获取SqlSessionFactory</span></span><br><span class="line">        factory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(in);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@After</span>  <span class="comment">//用于在测试方法执行之后执行</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        in.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSecondCache</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        SqlSession sqlSession1 = factory.openSession();</span><br><span class="line">        IUserDao dao1 = sqlSession1.getMapper(IUserDao.class);</span><br><span class="line">        User user1 = dao1.findById(<span class="number">41</span>);</span><br><span class="line">        System.out.println(user1);</span><br><span class="line">        sqlSession1.close();    <span class="comment">//一级缓存消失</span></span><br><span class="line"></span><br><span class="line">        SqlSession sqlSession2 = factory.openSession();</span><br><span class="line">        IUserDao dao2 = sqlSession2.getMapper(IUserDao.class);</span><br><span class="line">        User user2 = dao2.findById(<span class="number">41</span>);</span><br><span class="line">        System.out.println(user2);</span><br><span class="line">        sqlSession2.close();</span><br><span class="line"></span><br><span class="line">        System.out.println(user1 == user2);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>经过上面的测试，我们发现执行了两次查询，并且在执行第一次查询后，我们关闭了一级缓存，再去执行第二 次查询时，我们发现并没有对数据库发出 sql 语句，所以此时的数据就只能是来自于我们所说的二级缓存。 </p>
<p>值得注意的是，最终输出的结果是 <code>false</code>，这是因为在二级缓存中寸的并不是对象，而是一些散装数据，每次查询就用这些数据封装一个对象返回，所以两个对象是不同的。</p>
<h2 id="Mybatis-中的注解开发"><a href="#Mybatis-中的注解开发" class="headerlink" title="Mybatis 中的注解开发"></a>Mybatis 中的注解开发</h2><p>Mybatis 使用注解开发的方式可以减少编写 Mapper 映射文件。</p>
<h3 id="mybatis-的常用注解说明"><a href="#mybatis-的常用注解说明" class="headerlink" title="mybatis 的常用注解说明"></a>mybatis 的常用注解说明</h3><blockquote>
<p>@Insert：实现新增 </p>
<p>@Update：实现更新 </p>
<p>@Delete：实现删除 </p>
<p>@Select：实现查询 </p>
<p>@Result：实现结果集封装 </p>
<p>@Results：可以与 @Result 一起使用，封装多个结果集 </p>
<p>@ResultMap：实现引用 @Results 定义的封装 </p>
<p>@One：实现一对一结果集封装 </p>
<p>@Many：实现一对多结果集封装 </p>
<p>@SelectProvider：实现动态 SQL 映射 </p>
<p>@CacheNamespace：实现注解二级缓存的使用</p>
</blockquote>
<h3 id="使用-Mybatis-注解实现单表-CRUD"><a href="#使用-Mybatis-注解实现单表-CRUD" class="headerlink" title="使用 Mybatis 注解实现单表 CRUD"></a>使用 Mybatis 注解实现单表 CRUD</h3><p>单表的 CRUD 操作是最基本的操作，前面我们的学习都是基于 Mybaits 的映射文件来实现的</p>
<h4 id="编写实体类"><a href="#编写实体类" class="headerlink" title="编写实体类"></a>编写实体类</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.conv.domain;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    <span class="keyword">private</span> Date birthday;</span><br><span class="line">    <span class="keyword">private</span> String sex;</span><br><span class="line">    <span class="keyword">private</span> String address;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Integer <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getUsername</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> username;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUsername</span><span class="params">(String username)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.username = username;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Date <span class="title">getBirthday</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> birthday;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setBirthday</span><span class="params">(Date birthday)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.birthday = birthday;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getSex</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> sex;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSex</span><span class="params">(String sex)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.sex = sex;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getAddress</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> address;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAddress</span><span class="params">(String address)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.address = address;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;User&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;id=&quot;</span> + id +</span><br><span class="line">                <span class="string">&quot;, username=&#x27;&quot;</span> + username + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, birthday=&quot;</span> + birthday +</span><br><span class="line">                <span class="string">&quot;, sex=&#x27;&quot;</span> + sex + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, address=&#x27;&quot;</span> + address + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="使用注解方式开发持久层接口"><a href="#使用注解方式开发持久层接口" class="headerlink" title="使用注解方式开发持久层接口"></a>使用注解方式开发持久层接口</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.conv.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IUserDao</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 查询所有用户</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Select(&quot;select * from user&quot;)</span></span><br><span class="line">    <span class="function">List&lt;User&gt; <span class="title">findAll</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 保存用户</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> user</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Insert(&quot;insert into user(username, address, sex, birthday)&quot; +</span></span><br><span class="line"><span class="meta">            &quot; values(#&#123;username&#125;, #&#123;address&#125;, #&#123;sex&#125;, #&#123;birthday&#125;)&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">saveUser</span><span class="params">(User user)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 更新用户</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> user</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Update(&quot;update user set username=#&#123;username&#125;,sex=#&#123;sex&#125;,address=#&#123;address&#125;,birthday=#&#123;birthday&#125; &quot; +</span></span><br><span class="line"><span class="meta">            &quot;where id = #&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">updateUser</span><span class="params">(User user)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 删除用户</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> userId</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Delete(&quot;delete from user where id = #&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">deleteUser</span><span class="params">(Integer userId)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 根据ID查询用户</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> userId</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Select(&quot;select * from user where id = #&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="function">User <span class="title">findById</span><span class="params">(Integer userId)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 根据用户名模糊查询</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> userName</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Select(&quot;select * from user where username like #&#123;username&#125;&quot;)</span></span><br><span class="line"><span class="comment">//    @Select(&quot;select * from user where username like &#x27;%$&#123;value&#125;%&#x27;&quot;)</span></span><br><span class="line">    <span class="function">List&lt;User&gt; <span class="title">findUserByName</span><span class="params">(String userName)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 查询用户数量</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Select(&quot;select count(id) from user&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">findTotal</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>通过注解方式，我们就不需要再去编写 UserDao.xml 映射文件了。</p>
<h4 id="编写-SqlMapConfig-配置文件"><a href="#编写-SqlMapConfig-配置文件" class="headerlink" title="编写 SqlMapConfig 配置文件"></a>编写 SqlMapConfig 配置文件</h4><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">configuration</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">&quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--  引入外部配置文件 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span> <span class="attr">resource</span>=<span class="string">&quot;jdbcConfig.properties&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--  使用 typeAliases 配置别名，它只能配置 domain 中类的别名 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">&quot;com.conv.domain&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--配置环境--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">&quot;mysql&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--配置mysql的环境--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">&quot;mysql&quot;</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--配置事务的类型--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">&quot;JDBC&quot;</span>/&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--配置数据源（连接池）--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">&quot;POOLED&quot;</span>&gt;</span></span><br><span class="line">                <span class="comment">&lt;!--配置连接数据库的基本信息--&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driver&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;driver&#125;&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;url&#125;&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;username&#125;&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;password&#125;&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 指定带有注解的dao接口所在的位置 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">&quot;com.conv.dao&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="编写测试方法"><a href="#编写测试方法" class="headerlink" title="编写测试方法"></a>编写测试方法</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.conv.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MybatisAnnoTest</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> InputStream in;</span><br><span class="line">    <span class="keyword">private</span> SqlSession session;</span><br><span class="line">    SqlSessionFactory factory;</span><br><span class="line">    IUserDao userDao;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Before</span> <span class="comment">//用于在测试方法执行之前执行</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="comment">//1. 读取配置文件，生成字节输入流</span></span><br><span class="line">        in = Resources.getResourceAsStream(<span class="string">&quot;SqlMapConfig.xml&quot;</span>);</span><br><span class="line">        <span class="comment">//2. 获取SqlSessionFactory</span></span><br><span class="line">        factory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(in);</span><br><span class="line">        <span class="comment">//3. 获取SqlSession对象</span></span><br><span class="line">        session = factory.openSession();</span><br><span class="line">        <span class="comment">//4. 获取dao的代理对象</span></span><br><span class="line">        userDao = session.getMapper(IUserDao.class);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@After</span>  <span class="comment">//用于在测试方法执行之后执行</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="comment">//提交事务</span></span><br><span class="line">        session.commit();</span><br><span class="line">        <span class="comment">// 关闭资源</span></span><br><span class="line">        session.close();</span><br><span class="line">        in.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="meta">@Ignore</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testFindAll</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        List&lt;User&gt; users = userDao.findAll();</span><br><span class="line">        users.forEach(System.out::println);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="meta">@Ignore</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSaveUser</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        User user = <span class="keyword">new</span> User();</span><br><span class="line">        user.setUsername(<span class="string">&quot;mybatis annotation&quot;</span>);</span><br><span class="line">        user.setAddress(<span class="string">&quot;北京市昌平区&quot;</span>);</span><br><span class="line"></span><br><span class="line">        userDao.saveUser(user);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="meta">@Ignore</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testUpdateUser</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        User user = <span class="keyword">new</span> User();</span><br><span class="line">        user.setUsername(<span class="string">&quot;mybatis annotation&quot;</span>);</span><br><span class="line">        user.setAddress(<span class="string">&quot;北京市昌平区&quot;</span>);</span><br><span class="line">        user.setId(<span class="number">86</span>);</span><br><span class="line">        user.setSex(<span class="string">&quot;女&quot;</span>);</span><br><span class="line">        user.setBirthday(<span class="keyword">new</span> Date());</span><br><span class="line"></span><br><span class="line">        userDao.updateUser(user);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="meta">@Ignore</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testDeleteUser</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        userDao.deleteUser(<span class="number">87</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="meta">@Ignore</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testFindOneUser</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        User user = userDao.findById(<span class="number">41</span>);</span><br><span class="line">        System.out.println(user);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="meta">@Ignore</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testFindByName</span><span class="params">()</span></span>&#123;</span><br><span class="line">        List&lt;User&gt; users = userDao.findUserByName(<span class="string">&quot;%王%&quot;</span>);</span><br><span class="line">        users.forEach(System.out::println);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testFindTotal</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(userDao.findTotal());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="使用注解实现复杂关系映射（多表）开发及延迟加载"><a href="#使用注解实现复杂关系映射（多表）开发及延迟加载" class="headerlink" title="使用注解实现复杂关系映射（多表）开发及延迟加载"></a>使用注解实现复杂关系映射（多表）开发及延迟加载</h3><p>实现复杂关系映射之前我们可以在映射文件中通过配置 <code>&lt;resultMap&gt;</code> 来实现，在使用注解开发时我们需要借助@Results 注解，@Result 注解，@One 注解，@Many 注解。</p>
<h4 id="复杂关系映射的注解说明"><a href="#复杂关系映射的注解说明" class="headerlink" title="复杂关系映射的注解说明"></a>复杂关系映射的注解说明</h4><p>@Results 注解</p>
<blockquote>
<ul>
<li>代替的是标签 <code>&lt;resultMap&gt;</code></li>
<li>该注解中可以使用单个 <code>@Result</code> 注解，也可以使用 <code>@Result</code> 集合 <code>@Results(&#123;@Result()，@Result()&#125;)</code>或 <code>@Results(@Result())</code> </li>
</ul>
</blockquote>
<p>@Result 注解 </p>
<blockquote>
<ul>
<li>代替了 <code>&lt;id&gt;</code> 标签和 <code>&lt;result&gt;</code> 标签  </li>
<li>@Result 中 属性介绍：   <ul>
<li>id：是否是主键字段  </li>
<li>column：数据库的列名</li>
</ul>
</li>
<li>property：需要装配的属性名  </li>
<li>one：需要使用的 <code>@One</code> 注解<code>(@Result(one = @One)()))</code>  </li>
<li>many：需要使用的 <code>@Many</code> 注解<code>(@Result(many = @many)()))</code></li>
</ul>
</blockquote>
<p>@One 注解（一对一）</p>
<blockquote>
<ul>
<li><p>代替了 <code>&lt;assocation&gt;</code> 标签，是多表查询的关键，在注解中用来指定子查询返回单一对象。</p>
</li>
<li><p>@One 注解属性介绍： </p>
</li>
<li><p><code>select</code>  指定用来多表查询的 <code>sqlmapper</code>  （全限定方法名）</p>
</li>
<li><p><code>fetchType</code> 会覆盖全局的配置参数 <code>lazyLoadingEnabled</code>（配置延迟加载或立即加载）</p>
</li>
<li><p>使用格式：  </p>
<p><code>@Result(column = &quot; &quot;, property = &quot;&quot;, one = @One(select=&quot;&quot;))</code> </p>
</li>
</ul>
</blockquote>
<p>@Many 注解（多对一）</p>
<blockquote>
<ul>
<li><p>代替了 <code>&lt;Collection&gt;</code> 标签,是是多表查询的关键，在注解中用来指定子查询返回对象集合。  </p>
</li>
<li><p>注意：聚集元素用来处理 ”一对多” 的关系。需要指定映射的 Java 实体类的属性，属性的 <code>javaType</code> （一般为 <code>ArrayList</code>）但是注解中可以不定义；</p>
</li>
<li><p>使用格式：</p>
<p><code>@Result(property = &quot;&quot;, column = &quot;&quot;, many = @Many(select=&quot;&quot;))</code> </p>
</li>
</ul>
</blockquote>
<h4 id="需求："><a href="#需求：" class="headerlink" title="需求："></a>需求：</h4><p>一个用户具有多个账户信息，所以形成了用户(User)与账户(Account)之间的一对多关系。 </p>
<p>一对一关系映射：</p>
<blockquote>
<p>加载账户信息时并且加载该账户的用户信息，根据情况可实现延迟加载。（注解方式实现） </p>
</blockquote>
<p>一对多关系映射：</p>
<blockquote>
<p>查询用户信息时，也要查询他的账户列表。使用注解方式实现</p>
</blockquote>
<h4 id="Account-实体类加入-User"><a href="#Account-实体类加入-User" class="headerlink" title="Account 实体类加入 User"></a>Account 实体类加入 User</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.conv.domain;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Account</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> Integer uid;</span><br><span class="line">    <span class="keyword">private</span> Double money;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 多对一（mybatis中称为一对一），一个账户只能属于一个用户</span></span><br><span class="line">    <span class="keyword">private</span> User user;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> User <span class="title">getUser</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> user;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUser</span><span class="params">(User user)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.user = user;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Integer <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Integer <span class="title">getUid</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> uid;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUid</span><span class="params">(Integer uid)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.uid = uid;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Double <span class="title">getMoney</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> money;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMoney</span><span class="params">(Double money)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.money = money;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Account&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;id=&quot;</span> + id +</span><br><span class="line">                <span class="string">&quot;, uid=&quot;</span> + uid +</span><br><span class="line">                <span class="string">&quot;, money=&quot;</span> + money +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="User-实体类加入-List-lt-Account-gt"><a href="#User-实体类加入-List-lt-Account-gt" class="headerlink" title="User 实体类加入 List&lt;Account&gt;"></a>User 实体类加入 <code>List&lt;Account&gt;</code></h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.conv.domain;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Integer userId;</span><br><span class="line">    <span class="keyword">private</span> String userName;</span><br><span class="line">    <span class="keyword">private</span> Date userBirthday;</span><br><span class="line">    <span class="keyword">private</span> String userSex;</span><br><span class="line">    <span class="keyword">private</span> String userAddress;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//一对多关系映射，一个用户对应多个账户</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;Account&gt; accounts;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Account&gt; <span class="title">getAccounts</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> accounts;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAccounts</span><span class="params">(List&lt;Account&gt; accounts)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.accounts = accounts;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Integer <span class="title">getUserId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> userId;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUserId</span><span class="params">(Integer userId)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.userId = userId;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getUserName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> userName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUserName</span><span class="params">(String userName)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.userName = userName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Date <span class="title">getUserBirthday</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> userBirthday;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUserBirthday</span><span class="params">(Date userBirthday)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.userBirthday = userBirthday;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getUserSex</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> userSex;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUserSex</span><span class="params">(String userSex)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.userSex = userSex;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getUserAddress</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> userAddress;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUserAddress</span><span class="params">(String userAddress)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.userAddress = userAddress;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;User&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;userId=&quot;</span> + userId +</span><br><span class="line">                <span class="string">&quot;, userName=&#x27;&quot;</span> + userName + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, userBirthday=&quot;</span> + userBirthday +</span><br><span class="line">                <span class="string">&quot;, userSex=&#x27;&quot;</span> + userSex + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, userAddress=&#x27;&quot;</span> + userAddress + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="编写用户的持久层接口并使用注解配置"><a href="#编写用户的持久层接口并使用注解配置" class="headerlink" title="编写用户的持久层接口并使用注解配置"></a>编写用户的持久层接口并使用注解配置</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.conv.dao;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 开启二级缓存</span></span><br><span class="line"><span class="comment">// 加 @CacheNamespace 注解</span></span><br><span class="line"><span class="meta">@CacheNamespace(blocking = true)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IUserDao</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 故意让数据库的列名和类中的属性名不对应</span></span><br><span class="line">    <span class="comment">// 使用@Results注解可以使其一一对应</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 对一的时候用立即加载</span></span><br><span class="line"><span class="comment">     * 对多的时候用懒加载</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;</span></span><br><span class="line"><span class="comment">     * 查询所有用户</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Results</span> 注解中的id属性可以自行指定，这样其他只用引入<span class="doctag">@ResultMap</span>注解即可</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Select(&quot;select * from user&quot;)</span></span><br><span class="line">    <span class="meta">@Results(id = &quot;userMap&quot;, value = &#123;</span></span><br><span class="line"><span class="meta">            @Result(id = true, column = &quot;id&quot;, property = &quot;userId&quot;),</span></span><br><span class="line"><span class="meta">            @Result(column = &quot;username&quot;, property = &quot;userName&quot;),</span></span><br><span class="line"><span class="meta">            @Result(column = &quot;sex&quot;, property = &quot;userSex&quot;),</span></span><br><span class="line"><span class="meta">            @Result(column = &quot;address&quot;, property = &quot;userAddress&quot;),</span></span><br><span class="line"><span class="meta">            @Result(column = &quot;birthday&quot;, property = &quot;userBirthday&quot;),</span></span><br><span class="line"><span class="meta">            @Result(column = &quot;id&quot;, property = &quot;accounts&quot;,</span></span><br><span class="line"><span class="meta">                    many = @Many(select = &quot;com.conv.dao.IAccountDao.findAccountByUid&quot;,</span></span><br><span class="line"><span class="meta">                            fetchType = FetchType.LAZY))</span></span><br><span class="line"><span class="meta">    &#125;)</span></span><br><span class="line">    <span class="function">List&lt;User&gt; <span class="title">findAll</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 根据ID查询用户</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> userId</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Select(&quot;select * from user where id = #&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="meta">@ResultMap(value = &#123;&quot;userMap&quot;&#125;)</span></span><br><span class="line">    <span class="function">User <span class="title">findById</span><span class="params">(Integer userId)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 根据用户名模糊查询</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> userName</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Select(&quot;select * from user where username like #&#123;username&#125;&quot;)</span></span><br><span class="line">    <span class="meta">@ResultMap(value = &#123;&quot;userMap&quot;&#125;)</span></span><br><span class="line">    <span class="function">List&lt;User&gt; <span class="title">findUserByName</span><span class="params">(String userName)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="添加账户的持久层接口并使用注解配置"><a href="#添加账户的持久层接口并使用注解配置" class="headerlink" title="添加账户的持久层接口并使用注解配置"></a>添加账户的持久层接口并使用注解配置</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.conv.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IAccountDao</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 查询所有账户，并且获取每个账户所属的用户信息</span></span><br><span class="line"><span class="comment">     * 对一的时候用立即加载</span></span><br><span class="line"><span class="comment">     * 对多的时候用懒加载</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Select(&quot;select * from account&quot;)</span></span><br><span class="line">    <span class="meta">@Results(id = &quot;accountMap&quot;, value = &#123;</span></span><br><span class="line"><span class="meta">            @Result(id = true, column = &quot;id&quot;, property = &quot;id&quot;),</span></span><br><span class="line"><span class="meta">            @Result(column = &quot;uid&quot;, property = &quot;uid&quot;),</span></span><br><span class="line"><span class="meta">            @Result(column = &quot;money&quot;, property = &quot;money&quot;),</span></span><br><span class="line"><span class="meta">            @Result(property = &quot;user&quot;, column = &quot;uid&quot;, one = @One(select = &quot;com.conv.dao.IUserDao.findById&quot;, fetchType = FetchType.EAGER))</span></span><br><span class="line"><span class="meta">    &#125;)</span></span><br><span class="line">    <span class="function">List&lt;Account&gt; <span class="title">findAll</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 根据用户id查询账户信息</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> userId</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Select(&quot;select * from account where uid = #&#123;uid&#125;&quot;)</span></span><br><span class="line">    <span class="function">List&lt;Account&gt; <span class="title">findAccountByUid</span><span class="params">(Integer userId)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="测试一对一关联及延迟加载"><a href="#测试一对一关联及延迟加载" class="headerlink" title="测试一对一关联及延迟加载"></a>测试一对一关联及延迟加载</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.conv.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AccountTest</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> InputStream in;</span><br><span class="line">    <span class="keyword">private</span> SqlSession session;</span><br><span class="line">    SqlSessionFactory factory;</span><br><span class="line">    IAccountDao accountDao;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Before</span> <span class="comment">//用于在测试方法执行之前执行</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="comment">//1. 读取配置文件，生成字节输入流</span></span><br><span class="line">        in = Resources.getResourceAsStream(<span class="string">&quot;SqlMapConfig.xml&quot;</span>);</span><br><span class="line">        <span class="comment">//2. 获取SqlSessionFactory</span></span><br><span class="line">        factory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(in);</span><br><span class="line">        <span class="comment">//3. 获取SqlSession对象</span></span><br><span class="line">        session = factory.openSession();</span><br><span class="line">        <span class="comment">//4. 获取dao的代理对象</span></span><br><span class="line">        accountDao = session.getMapper(IAccountDao.class);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@After</span>  <span class="comment">//用于在测试方法执行之后执行</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="comment">//提交事务</span></span><br><span class="line">        session.commit();</span><br><span class="line">        <span class="comment">// 关闭资源</span></span><br><span class="line">        session.close();</span><br><span class="line">        in.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testFindAll</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        List&lt;Account&gt; accounts = accountDao.findAll();</span><br><span class="line"><span class="comment">//        accounts.forEach(account -&gt; &#123;</span></span><br><span class="line"><span class="comment">//            System.out.println(&quot;-----------每个账户的信息-------------&quot;);</span></span><br><span class="line"><span class="comment">//            System.out.println(account);</span></span><br><span class="line"><span class="comment">//            System.out.println(account.getUser());</span></span><br><span class="line"><span class="comment">//        &#125;);</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="测试一对多关联"><a href="#测试一对多关联" class="headerlink" title="测试一对多关联"></a>测试一对多关联</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.conv.test;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Ignore</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserTest</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> InputStream in;</span><br><span class="line">    <span class="keyword">private</span> SqlSession session;</span><br><span class="line">    SqlSessionFactory factory;</span><br><span class="line">    IUserDao userDao;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Before</span> <span class="comment">//用于在测试方法执行之前执行</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="comment">//1. 读取配置文件，生成字节输入流</span></span><br><span class="line">        in = Resources.getResourceAsStream(<span class="string">&quot;SqlMapConfig.xml&quot;</span>);</span><br><span class="line">        <span class="comment">//2. 获取SqlSessionFactory</span></span><br><span class="line">        factory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(in);</span><br><span class="line">        <span class="comment">//3. 获取SqlSession对象</span></span><br><span class="line">        session = factory.openSession();</span><br><span class="line">        <span class="comment">//4. 获取dao的代理对象</span></span><br><span class="line">        userDao = session.getMapper(IUserDao.class);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@After</span>  <span class="comment">//用于在测试方法执行之后执行</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="comment">//提交事务</span></span><br><span class="line">        session.commit();</span><br><span class="line">        <span class="comment">// 关闭资源</span></span><br><span class="line">        session.close();</span><br><span class="line">        in.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testFindAll</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        List&lt;User&gt; users = userDao.findAll();</span><br><span class="line">        users.forEach(user -&gt; &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;----------每个用户的信息-------------&quot;</span>);</span><br><span class="line">            System.out.println(user);</span><br><span class="line">            System.out.println(<span class="string">&quot;账户信息：&quot;</span>);</span><br><span class="line">            System.out.println(user.getAccounts());</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testFindOneUser</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        User user = userDao.findById(<span class="number">41</span>);</span><br><span class="line">        System.out.println(user);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testFindByName</span><span class="params">()</span></span>&#123;</span><br><span class="line">        List&lt;User&gt; users = userDao.findUserByName(<span class="string">&quot;%王%&quot;</span>);</span><br><span class="line">        users.forEach(System.out::println);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="mybatis-基于注解的二级缓存"><a href="#mybatis-基于注解的二级缓存" class="headerlink" title="mybatis 基于注解的二级缓存"></a>mybatis 基于注解的二级缓存</h3><h4 id="在-SqlMapConfig-中开启二级缓存支持"><a href="#在-SqlMapConfig-中开启二级缓存支持" class="headerlink" title="在 SqlMapConfig 中开启二级缓存支持"></a>在 SqlMapConfig 中开启二级缓存支持</h4><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">configuration</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">&quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--  引入外部配置文件 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span> <span class="attr">resource</span>=<span class="string">&quot;jdbcConfig.properties&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 配置开启二级缓存 --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 默认就是 true，可不配置 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;cacheEnabled&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--  使用 typeAliases 配置别名，它只能配置 domain 中类的别名 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">&quot;com.conv.domain&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--配置环境--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">&quot;mysql&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--配置mysql的环境--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">&quot;mysql&quot;</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--配置事务的类型--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">&quot;JDBC&quot;</span>/&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--配置数据源（连接池）--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">&quot;POOLED&quot;</span>&gt;</span></span><br><span class="line">                <span class="comment">&lt;!--配置连接数据库的基本信息--&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driver&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;driver&#125;&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;url&#125;&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;username&#125;&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;password&#125;&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 指定带有注解的dao接口所在的位置 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">&quot;com.conv.dao&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="在持久层接口中使用注解配置二级缓存"><a href="#在持久层接口中使用注解配置二级缓存" class="headerlink" title="在持久层接口中使用注解配置二级缓存"></a>在持久层接口中使用注解配置二级缓存</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.conv.dao;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 开启二级缓存</span></span><br><span class="line"><span class="comment">// 加 @CacheNamespace 注解</span></span><br><span class="line"><span class="meta">@CacheNamespace(blocking = true)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IUserDao</span> </span>&#123;</span><br><span class="line"> 	<span class="comment">//...   </span></span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.conv.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SecondLevelCacheTest</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> InputStream in;</span><br><span class="line">    <span class="keyword">private</span> SqlSessionFactory factory;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Before</span> <span class="comment">//用于在测试方法执行之前执行</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="comment">//1. 读取配置文件，生成字节输入流</span></span><br><span class="line">        in = Resources.getResourceAsStream(<span class="string">&quot;SqlMapConfig.xml&quot;</span>);</span><br><span class="line">        <span class="comment">//2. 获取SqlSessionFactory</span></span><br><span class="line">        factory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(in);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@After</span>  <span class="comment">//用于在测试方法执行之后执行</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        in.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testFindOne</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//第一次打开</span></span><br><span class="line">        SqlSession session = factory.openSession();</span><br><span class="line">        IUserDao userDao = session.getMapper(IUserDao.class);</span><br><span class="line">        User user = userDao.findById(<span class="number">41</span>);</span><br><span class="line">        System.out.println(user);</span><br><span class="line"></span><br><span class="line">        session.close();    <span class="comment">//释放一级缓存</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//再次打开</span></span><br><span class="line">        SqlSession session1 = factory.openSession();</span><br><span class="line">        IUserDao userDao1 = session1.getMapper(IUserDao.class);</span><br><span class="line">        User user1 = userDao1.findById(<span class="number">41</span>);</span><br><span class="line">        System.out.println(user1);</span><br><span class="line"></span><br><span class="line">        session1.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>完结撒花~</p>
]]></content>
      <categories>
        <category>Mybatis</category>
      </categories>
      <tags>
        <tag>Mybatis</tag>
        <tag>JDBC</tag>
      </tags>
  </entry>
</search>
